### 

# WebSocket å’Œ http çº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´

2025-09-14 15:55:27

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤:
`go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨ WebSocket æœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤:
`./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :18080`

ðŸ“‹ WebSocket æœåŠ¡å™¨è¿›ç¨‹ PID: 3728

ç­‰å¾… WebSocket æœåŠ¡å™¨å¯åŠ¨... âœ… WebSocket æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨ http æœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤:
`./main.exe  -port 18080 -upstream-type websocket -upstream-address ws://localhost:18080`

ðŸ“‹ http æœåŠ¡å™¨è¿›ç¨‹ PID: 18972

ç­‰å¾… http æœåŠ¡å™¨å¯åŠ¨... âœ… http æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯• 1: HTTP ä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curl æµ‹è¯• 1 è¿›ç¨‹ PID: 23192, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
18080
  0     0    0     0    0     0     18080   0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
>
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 07:55:17 GMT
< Etag: "575e1f71-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:25 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11404394141359252402
<

  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 07:55:17 GMT
Etag: "575e1f71-115"
Last-Modified: Mon, 13 Jun 2016 02:50:25 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11404394141359252402
```

### æµ‹è¯• 2: HTTPS ä»£ç†é€šè¿‡çº§è” 18080

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curl æµ‹è¯• 2 è¿›ç¨‹ PID: 29936, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```18080
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current18080
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
>
< HTTP/1.1 200 Connection established
<
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key 18080? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
>
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 07:55:18 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9853218984006409667
<

  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 07:55:18 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9853218984006409667
```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹ PID è®°å½•

æ‰€æœ‰è¿›ç¨‹ PID: 26084, 17008, 3728, 3728, 18972, 18972, 23192, 23192, 29936, 29936

### 

# WebSocket å’Œ http çº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´

2025-09-14 15:55:27

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤:
`go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨ WebSocket æœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤:
`./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :18080`

ðŸ“‹ WebSocket æœåŠ¡å™¨è¿›ç¨‹ PID: 3728

ç­‰å¾… WebSocket æœåŠ¡å™¨å¯åŠ¨... âœ… WebSocket æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ 18080

## 3. å¯åŠ¨ http æœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤:
`./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:18080`

ðŸ“‹ http æœåŠ¡å™¨è¿›ç¨‹ PID: 18972

ç­‰å¾… http æœåŠ¡å™¨å¯åŠ¨... âœ… http æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½ 18080

### æµ‹è¯• 1: HTTP ä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curl æµ‹è¯• 1 è¿›ç¨‹ PID: 23192, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:18080

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::118080
* IPv4: 127.0.0.118080
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
>
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 07:55:17 GMT
< Etag: "575e1f71-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:25 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11404394141359252402
<

  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 07:55:17 GMT
Etag: "575e1f71-115"
Last-Modified: Mon, 13 Jun 2016 02:50:25 GMT
Pragma: no-cache
Server: bfe/1.0.8.1818080
Tr_id: bfe_11404394141359252402
```

### æµ‹è¯• 2: HTTPS ä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curl æµ‹è¯• 2 è¿›ç¨‹ PID: 29936, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ 18080

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)18080
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
>
< HTTP/1.1 200 Connection established
<
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 202618080
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
>
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 07:55:18 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9853218984006409667
<

  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 07:55:18 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9853218984006409667
```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹ PID è®°å½•

æ‰€æœ‰è¿›ç¨‹ PID: 26084, 17008, 3728, 3728, 18972, 18972, 23192, 23192, 29936, 29936

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ WebSocket æœåŠ¡å™¨è¿›ç¨‹... âœ… WebSocket æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ http æœåŠ¡å™¨è¿›ç¨‹... âœ… http æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹... âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶

### WebSocket æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

````
2025/09/14 15:55:29 main.go:71: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :18080
2025/09/14 15:55:29 server.go:71: [WEBSOCKET-SERVER] Server started successfully, listening on :18080
2025/09/14 15:55:29 server.go:72: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 15:55:29 server.go:74: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 15:55:29 server.go:75: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 15:55:29 main.go:129: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 15:55:31 server.go:90: url /
2025/09/14 15:55:31 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[Co0ObzE7G0P4kSh77cKx5g==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.79.75.174] X-Proxy-Target-Port:[29647]]
2025/09/14 15:55:31 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:19015 at 2025-09-14 15:55:31
2025/09/14 15:55:31 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:19015
2025/09/14 15:55:31 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.79.75.174', targetPort: 29647
2025/09/14 15:55:31 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 15:55:31 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:19015
2025/09/14 15:55:31 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.79.75.174:29647 from [::1]:19015
2025/09/14 15:55:31 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.79.75.174:29647 (timeout: 30s)
2025/09/14 15:55:31 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.79.75.174:29647
2025/09/14 15:55:31 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 15:55:31 server.go:90: url /
2025/09/14 15:55:31 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[a0PhWk9RszkBeeAVjjmJ5g==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 15:55:31 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:19017 at 2025-09-14 15:55:31
2025/09/14 15:55:31 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:19017
2025/09/14 15:55:31 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 15:55:31 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 15:55:31 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:19017
2025/09/14 15:55:31 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:19017
2025/09/14 15:55:31 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 15:55:32 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 15:55:32 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 15:55:34 server.go:90: url /
2025/09/14 15:55:34 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[kaywHqOWXzRpT21Siy99RA==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.79.75.174] X-Proxy-Target-Port:[29647]]
2025/09/14 15:55:34 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:19095 at 2025-09-14 15:55:34
2025/09/14 15:55:34 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:19095
2025/09/14 15:55:34 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.79.75.174', targetPort: 29647
2025/09/14 15:55:34 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 15:55:34 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:19095
2025/09/14 15:55:34 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.79.75.174:29647 from [::1]:19095
2025/09/14 15:55:34 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.79.75.174:29647 (timeout: 30s)
2025/09/14 15:55:34 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.79.75.174:29647
2025/09/14 15:55:34 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 15:55:34 server.go:90: url /
2025/09/14 15:55:34 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[afRYk427FqbQmnXVaGfIrQ==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 15:55:34 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:19100 at 2025-09-14 15:55:34
2025/09/14 15:55:34 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:19100
2025/09/14 15:55:34 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 15:55:34 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 15:55:34 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:19100
2025/09/14 15:55:34 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:19100
2025/09/14 15:55:34 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 15:55:34 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 15:55:34 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
```18080

### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º
````

2025/09/14 15:55:30 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­... 2025/09/14 15:55:30
main.go:562: dohalpn: [] 2025/09/14 15:55:30 main.go:564: hostname: 0.0.0.0
2025/09/14 15:55:30 main.go:566: port: 10810 2025/09/14 15:55:30 main.go:568:
server_cert: 2025/09/14 15:55:30 main.go:570: server_key: 2025/09/14 15:55:30
main.go:572: username: 2025/09/14 15:55:30 main.go:574: password: 2025/09/14
15:55:30 main.go:576: dohurl: [] 2025/09/14 15:55:30 main.go:578: dohip: []
2025/09/14 15:55:30 main.go:579: upstream-type: websocket 2025/09/14 15:55:30
main.go:580: upstream-address: ws://localhost:18080 2025/09/14 15:55:30
main.go:581: upstream-username: 2025/09/14 15:55:30 main.go:582:
upstream-password: 2025/09/14 15:55:30 main.go:639: WebSocket ä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 15:55:30 main.go:927: { "hostname": "", "port": 0, "server_cert": "",
"server_key": "", "username": "", "password": "", "doh": null, "upstreams": {
"websocket_upstream": { "type": "websocket", "http_proxy":
"ws://localhost:18080", "https_proxy": "ws://localhost:18080", "bypass_list":
null, "ws_proxy": "ws://localhost:18080", "ws_username": "", "ws_password": "",
"http_username": "", "http_password": "", "socks5_proxy":
"ws://localhost:18080", "socks5_username": "", "socks5_password": "" } },
"rules": [ { "filter": "websocket_filter", "upstream": "websocket_upstream" } ],
"filters": {18080 "websocket_filter": { "patterns": [ "*" ] } } } 2025/09/14
15:55:30 simple.go:31: Proxy server started on port [::]:10810 2025/09/14
15:55:30 http.go:372: Random IP: 127.79.75.174 2025/09/14 15:55:30 http.go:390:
Random integer: 29647 2025/09/14 15:55:30 http.go:342: Proxy server started on
port 127.79.75.174:29647 2025/09/14 15:55:31 simple.go:57: remote addr:
[::1]:19014 2025/09/14 15:55:31 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 15:55:31 simple.go:305: Domain: www.baidu.com, Port: 80 2025/09/14
15:55:31 simple.go:117: address:www.baidu.com:80 2025/09/14 15:55:31
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.79.75.174:29647
2025/09/14 15:55:31 main.go:828: ProxySelector 127.79.75.174:29647 2025/09/14
15:55:31 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080 2025/09/14 15:55:31
simple.go:179: WebSocket Config Details: 2025/09/14 15:55:31 simple.go:180:
host, portNum 127.79.75.174 29647 2025/09/14 15:55:31 simple.go:181: Username:
2025/09/14 15:55:31 simple.go:182: Password: 2025/09/14 15:55:31 simple.go:183:
ServerAddr: ws://localhost:18080 2025/09/14 15:55:31 simple.go:184: Protocol:
websocket 2025/09/14 15:55:31 simple.go:185: Timeout: 30s 2025/09/14 15:55:31
client.go:98: url: ws://localhost:1808018080 2025/09/14 15:55:31 client.go:99:
headers: map[X-Proxy-Target-Host:[127.79.75.174] X-Proxy-Target-Port:[29647]]
2025/09/14 15:55:31 client.go:110: url: http://localhost:1808018080 2025/09/14
15:55:31 client.go:111: headers: map[Connection:[Upgrade]
Sec-Websocket-Accept:[DMY7zhVbexn6reoTf2NXcCk8sxA=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] 2025/09/14 15:55:31
simple.go:209: WebSocket ä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.79.75.174:29647 2025/09/14 15:55:31
simple.go:248: clienthost: ::1 2025/09/14 15:55:31 simple.go:249: clientport:
19014 2025/09/14 15:55:31 simple.go:278: simple Handle header: 2025/09/14
15:55:31 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 15:55:31
simple.go:283: GET / HTTP/1.1 2025/09/14 15:55:31 simple.go:288: Forwarded:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 15:55:31
simple.go:294: Host: www.baidu.com User-Agent: Go-http-client/1.118080
Accept-Encoding: gzip 2025/09/14 15:55:31 http.go:90: method: GET 2025/09/14
15:55:31 http.go:91: url: /18080 2025/09/14 15:55:31 http.go:92: host:
www.baidu.com18080 2025/09/14 15:55:31 http.go:93: proxyHandler header:
2025/09/14 15:55:31 http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:31
http.go:121: clientport: 19016 2025/09/14 15:55:31 http.go:132: proxyHandler
Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.79.75.174:29647;host=www.baidu.com;proto=http
2025/09/14 15:55:31 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 15:55:31 http.go:132: proxyHandler Accept-Encoding : gzip 2025/09/14
15:55:31 http.go:135: forwardedHeader:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.79.75.174:29647;host=www.baidu.com;proto=http 2025/09/14
15:55:31 http.go:137: forwardedByList: [{[::1]:10810} {127.79.75.174:29647}]
2025/09/14 15:55:31 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
15:55:31 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
2025/09/14 15:55:31 main.go:828: ProxySelector www.baidu.com 2025/09/14 15:55:31
main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080 2025/09/14 15:55:31
http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080 2025/09/14 15:55:31 http.go:259:
å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸º websocket ws://localhost:18080 2025/09/14 15:55:31 http.go:262:
ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080 2025/09/14 15:55:31 http.go:264: network,addr tcp
www.baidu.com:80 2025/09/14 15:55:31 http.go:466: WebSocket Config Details:
2025/09/14 15:55:31 http.go:467: host, portNum www.baidu.com 80 2025/09/14
15:55:31 http.go:468: Username: 2025/09/14 15:55:31 http.go:469: Password:
2025/09/14 15:55:31 http.go:470: ServerAddr: ws://localhost:18080 2025/09/14
15:55:31 http.go:471: Protocol: websocket 2025/09/14 15:55:31 http.go:472:
Timeout: 30s 2025/09/14 15:55:31 http.go:476: host, portNum www.baidu.com 80
2025/09/14 15:55:31 client.go:98: url: ws://localhost:18080 2025/09/14 15:55:31
client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com]
X-Proxy-Target-Port:[80]] 2025/09/14 15:55:31 client.go:110: url:
http://localhost:18080 2025/09/14 15:55:31 client.go:111: headers:
map[Connection:[Upgrade] Sec-Websocket-Accept:[+SJbJSjfr6q/2qVSbmKChBkxC+w=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] [GIN] 2025/09/14 - 15:55:32 |
200 | 806.7502ms | 127.0.0.1 | GET "/" 2025/09/14 15:55:34 simple.go:57: remote
addr: [::1]:19094 2025/09/14 15:55:34 simple.go:79: HEAD http://www.baidu.com/
HTTP/1.1 2025/09/14 15:55:34 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 15:55:34 simple.go:117: address:www.baidu.com:80 2025/09/14 15:55:34
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.79.75.174:29647
2025/09/14 15:55:34 main.go:828: ProxySelector 127.79.75.174:29647 2025/09/14
15:55:34 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080 2025/09/14 15:55:34
simple.go:179: WebSocket Config Details: 2025/09/14 15:55:34 simple.go:180:
host, portNum 127.79.75.174 29647 2025/09/14 15:55:34 simple.go:181: Username:
2025/09/14 15:55:34 simple.go:182: Password: 2025/09/14 15:55:34 simple.go:183:
ServerAddr: ws://localhost:18080 2025/09/14 15:55:34 simple.go:184: Protocol:
websocket 2025/09/14 15:55:34 simple.go:185: Timeout: 30s 2025/09/14 15:55:34
client.go:98: url: ws://localhost:1808018080 2025/09/14 15:55:34 client.go:99:
headers: map[X-Proxy-Target-Host:[127.79.75.174] X-Proxy-Target-Port:[29647]]
2025/09/14 15:55:34 client.go:110: url: http://localhost:1808018080 2025/09/14
15:55:34 client.go:111: headers: map[Connection:[Upgrade]
Sec-Websocket-Accept:[UB5MjCdOVReWXVJqHnNk4xldKxI=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] 2025/09/14 15:55:34
simple.go:209: WebSocket ä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.79.75.174:29647 2025/09/14 15:55:34
simple.go:248: clienthost: ::1 2025/09/14 15:55:34 simple.go:249: clientport:
19094 2025/09/14 15:55:34 simple.go:278: simple Handle header: 2025/09/14
15:55:34 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 15:55:34
simple.go:283: HEAD / HTTP/1.1 2025/09/14 15:55:34 simple.go:288: Forwarded:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 15:55:34
simple.go:294: Host: www.baidu.com User-Agent: curl/8.12.1 Accept: */*18080
Proxy-Connection: Keep-Alive 2025/09/14 15:55:34 http.go:90: method: HEAD
2025/09/14 15:55:34 http.go:91: url: / 2025/09/14 15:55:34 http.go:92: host:
www.baidu.com18080 2025/09/14 15:55:34 http.go:93: proxyHandler header:18080
2025/09/14 15:55:34 http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:34
http.go:121: clientport: 19096 2025/09/14 15:55:34 http.go:132: proxyHandler
Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.79.75.174:29647;host=www.baidu.com;proto=http
2025/09/14 15:55:34 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 15:55:34 http.go:132: proxyHandler Accept : _/_ 2025/09/14 15:55:34
http.go:132: proxyHandler Proxy-Connection : Keep-Alive 2025/09/14 15:55:34
http.go:135: forwardedHeader:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.79.75.174:29647;host=www.baidu.com;proto=http 2025/09/14
15:55:34 http.go:137: forwardedByList: [{[::1]:10810} {127.79.75.174:29647}]
2025/09/14 15:55:34 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
15:55:34 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
2025/09/14 15:55:34 main.go:828: ProxySelector www.baidu.com 2025/09/14 15:55:34
main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080 2025/09/14 15:55:34
http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080 2025/09/14 15:55:34 http.go:259:
å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸º websocket ws://localhost:18080 [GIN] 2025/09/14 - 15:55:34 |
200 | 320.3701ms | 127.0.0.1 | HEAD "/" 2025/09/14 15:55:34 simple.go:57: remote
addr: [::1]:19099 2025/09/14 15:55:34 simple.go:79: CONNECT www.baidu.com:443
HTTP/1.1 2025/09/14 15:55:34 simple.go:117: address:www.baidu.com:443 2025/09/14
15:55:34 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy
www.baidu.com:443 2025/09/14 15:55:34 main.go:828: ProxySelector
www.baidu.com:443 2025/09/14 15:55:34 main.go:834: é€‰æ‹©çš„ä»£ç† URL:
ws://localhost:18080 2025/09/14 15:55:34 simple.go:179: WebSocket Config
Details: 2025/09/14 15:55:34 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 15:55:34 simple.go:181: Username: 2025/09/14 15:55:34 simple.go:182:
Password: 2025/09/14 15:55:34 simple.go:183: ServerAddr: ws://localhost:18080
2025/09/14 15:55:34 simple.go:184: Protocol: websocket 2025/09/14 15:55:34
simple.go:185: Timeout: 30s 2025/09/14 15:55:34 client.go:98: url:
ws://localhost:18080 2025/09/14 15:55:34 client.go:99: headers:
map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]] 2025/09/14
15:55:34 client.go:110: url: http://localhost:18080 2025/09/14
15:55:3418080nt.go:111: headers: map[Connection:[Upgrade]
Sec-Websocket-Accept:[hM2CnRW1CC2B5eF5wD5vYbhRWEs=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] 2025/09/14 15:55:34
simple.go:209: WebSocket ä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443 2025/09/14 15:55:34
simple.go:204: WebSocket ForwardData error: read tcp [::1]:19015->[::1]:18080:
wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 15:55:34 simple.go:204: WebSocket ForwardData error: read tcp
[::1]:19100->[::1]:18080: wsarecv: An existing connection was forcibly closed by
the remote host. 2025/09/14 15:55:34 http.go:493: WebSocket ForwardData error:
read tcp [::1]:19017->[::1]:18080: wsarecv: An existing connection was forcibly
closed by the remote host. 2025/09/14 15:55:34 simple.go:204: WebSocket
ForwardData error: read tcp [::1]:19095->[::1]:18080: wsarecv: An existing
connection was forcibly closed by the remote host.

```
âœ… ç«¯å£18080å·²æˆåŠŸé‡Šæ”¾ âœ… ç«¯å£10810å·²æˆåŠŸé‡Šæ”¾

###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰... æ‰§è¡Œå‘½ä»¤:
`./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 18080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘) âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com) âœ… æµ‹è¯•3æˆåŠŸ

###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰... æ‰§è¡Œå‘½ä»¤:
`./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 18080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘) âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com) âœ… æµ‹è¯•3æˆåŠŸ

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º
```

2025/09/14 15:55:40 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­... 2025/09/14 15:55:40
main.go:562: dohalpn: [h2, h3] 2025/09/14 15:55:40 main.go:564: hostname:
0.0.0.0 2025/09/14 15:55:40 main.go:566: port: 18080 2025/09/14 15:55:40
main.go:568: server_cert: 2025/09/14 15:55:40 main.go:570: server_key:
2025/09/14 15:55:40 main.go:572: username: 2025/09/14 15:55:40 main.go:574:
password: 2025/09/14 15:55:40 main.go:576: dohurl:
[https://dns.alidns.com/dns-query, https://dns.alidns.com/dns-query] 2025/09/14
15:55:40 main.go:578: dohip: [223.5.5.5, 223.6.6.6] 2025/09/14 15:55:40
main.go:579: upstream-type: 2025/09/14 15:55:40 main.go:580: upstream-address:
2025/09/14 15:55:40 main.go:581: upstream-username: 2025/09/14 15:55:40
main.go:582: upstream-password: 2025/09/14 15:55:40 main.go:927: null 2025/09/14
15:55:40 simple.go:31: Proxy server started on port [::]:18080 2025/09/14
15:55:40 http.go:372: Random IP: 127.135.115.102 2025/09/14 15:55:40
http.go:390: Random integer: 28503 2025/09/14 15:55:40 http.go:342: Proxy server
started on port 127.135.115.102:28503 2025/09/14 15:55:42 simple.go:57: remote
addr: [::1]:19208 2025/09/14 15:55:42 simple.go:79: GET http://www.baidu.com/
HTTP/1.1 2025/09/14 15:55:42 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 15:55:42 simple.go:117: address:www.baidu.com:80 2025/09/14 15:55:42
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.135.115.102:28503
2025/09/14 15:55:42 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.135.115.102:28503 2025/09/14
15:55:42 simple.go:248: clienthost: ::1 2025/09/14 15:55:42 simple.go:249:
clientport: 19208 2025/09/14 15:55:42 simple.go:278: simple Handle header:
2025/09/14 15:55:42 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:42
simple.go:283: GET / HTTP/1.1 2025/09/14 15:55:42 simple.go:288: Forwarded:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:42
simple.go:294: Host: www.baidu.com User-Agent: Go-http-client/1.1
Accept-Encoding: gzip 2025/09/14 15:55:42 http.go:90: method: GET 2025/09/14
15:55:42 http.go:91: url: / 2025/09/14 15:55:42 http.go:92: host: www.baidu.com
2025/09/14 15:55:42 http.go:93: proxyHandler header: 2025/09/14 15:55:42
http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:42 http.go:121: clientport:
19209 2025/09/14 15:55:42 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.135.115.102:28503;host=www.baidu.com;proto=http
2025/09/14 15:55:42 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 15:55:42 http.go:132: proxyHandler Accept-Encoding : gzip 2025/09/14
15:55:42 http.go:135: forwardedHeader:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.135.115.102:28503;host=www.baidu.com;proto=http 2025/09/14
15:55:42 http.go:137: forwardedByList: [{[::1]:18080} {127.135.115.102:28503}]
2025/09/14 15:55:42 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
15:55:42 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
2025/09/14 15:55:42 options.go:186: hostname www.baidu.com no ip found
2025/09/14 15:55:42 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 doh.go:28: domain:
www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query 2025/09/14
15:55:42 doh.go:28: domain: www.baidu.com dnstype: A dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ· doh
è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ·
doh è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:42 doh.go:91: dns
resolved www.baidu.com
ips:[180.101.49.44,180.101.51.73,240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69]
2025/09/14 15:55:42 options.go:240: success connect to address=www.baidu.com:80
by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by
serverIP=180.101.51.73 [GIN] 2025/09/14 - 15:55:42 | 200 | 119.8641ms |
127.0.0.1 | GET "/" 2025/09/14 15:55:42 simple.go:57: remote addr: [::1]:19213
2025/09/14 15:55:42 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1 2025/09/14
15:55:42 simple.go:305: Domain: www.baidu.com, Port: 80 2025/09/14 15:55:42
simple.go:117: address:www.baidu.com:80 2025/09/14 15:55:42
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.135.115.102:28503
2025/09/14 15:55:42 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.135.115.102:28503 2025/09/14
15:55:42 simple.go:248: clienthost: ::1 2025/09/14 15:55:42 simple.go:249:
clientport: 19213 2025/09/14 15:55:42 simple.go:278: simple Handle header:
2025/09/14 15:55:42 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:42
simple.go:283: HEAD / HTTP/1.1 2025/09/14 15:55:42 simple.go:288: Forwarded:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:42
simple.go:294: Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
Proxy-Connection: Keep-Alive 2025/09/14 15:55:42 http.go:90: method: HEAD
2025/09/14 15:55:42 http.go:91: url: / 2025/09/14 15:55:42 http.go:92: host:
www.baidu.com 2025/09/14 15:55:42 http.go:93: proxyHandler header: 2025/09/14
15:55:42 http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:42 http.go:121:
clientport: 19214 2025/09/14 15:55:42 http.go:132: proxyHandler Proxy-Connection
: Keep-Alive 2025/09/14 15:55:42 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.135.115.102:28503;host=www.baidu.com;proto=http
2025/09/14 15:55:42 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 15:55:42 http.go:132: proxyHandler Accept : _/_ 2025/09/14 15:55:42
http.go:135: forwardedHeader:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.135.115.102:28503;host=www.baidu.com;proto=http 2025/09/14
15:55:42 http.go:137: forwardedByList: [{[::1]:18080} {127.135.115.102:28503}]
2025/09/14 15:55:42 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
15:55:42 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
2025/09/14 15:55:42 options.go:186: hostname www.baidu.com no ip found
2025/09/14 15:55:42 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 doh.go:28: domain:
www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query 2025/09/14
15:55:42 doh.go:28: domain: www.baidu.com dnstype: A dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ· doh
è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ·
doh è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:42 doh.go:91: dns
resolved www.baidu.com
ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5]
2025/09/14 15:55:42 options.go:240: success connect to address=www.baidu.com:80
by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by
serverIP=240e:e9:6002:1fd:0:ff:b0e1:fe69 [GIN] 2025/09/14 - 15:55:42 | 200 |
99.7ms | 127.0.0.1 | HEAD "/" 2025/09/14 15:55:42 simple.go:57: remote addr:
[::1]:19218 2025/09/14 15:55:42 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 15:55:42 simple.go:305: Domain: www.so.com, Port: 80 2025/09/14
15:55:42 simple.go:117: address:www.so.com:80 2025/09/14 15:55:42
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.135.115.102:28503
2025/09/14 15:55:42 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.135.115.102:28503 2025/09/14
15:55:42 simple.go:248: clienthost: ::1 2025/09/14 15:55:42 simple.go:249:
clientport: 19218 2025/09/14 15:55:42 simple.go:278: simple Handle header:
2025/09/14 15:55:42 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:18080;host=www.so.com:80;proto=http 2025/09/14 15:55:42
simple.go:283: HEAD / HTTP/1.1 2025/09/14 15:55:42 simple.go:288: Forwarded:
for=::1;by=[::1]:18080;host=www.so.com:80;proto=http 2025/09/14 15:55:42
simple.go:294: Host: www.so.com User-Agent: curl/8.12.1 Accept: _/_
Proxy-Connection: Keep-Alive 2025/09/14 15:55:42 http.go:90: method: HEAD
2025/09/14 15:55:42 http.go:91: url: / 2025/09/14 15:55:42 http.go:92: host:
www.so.com 2025/09/14 15:55:42 http.go:93: proxyHandler header: 2025/09/14
15:55:42 http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:42 http.go:121:
clientport: 19219 2025/09/14 15:55:42 http.go:132: proxyHandler User-Agent :
curl/8.12.1 2025/09/14 15:55:42 http.go:132: proxyHandler Accept : _/_
2025/09/14 15:55:42 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 15:55:42 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.135.115.102:28503;host=www.so.com;proto=http
2025/09/14 15:55:42 http.go:135: forwardedHeader:
for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,
for=127.0.0.1;by=127.135.115.102:28503;host=www.so.com;proto=http 2025/09/14
15:55:42 http.go:137: forwardedByList: [{[::1]:18080} {127.135.115.102:28503}]
2025/09/14 15:55:42 http.go:155: targetUrl: http://www.so.com/ 2025/09/14
15:55:42 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.so.com
2025/09/14 15:55:42 options.go:186: hostname www.so.com no ip found 2025/09/14
15:55:42 doh.go:16: domain: www.so.com dnstype: A,AAAA dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 doh.go:28: domain:
www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query 2025/09/14
15:55:42 doh.go:28: domain: www.so.com dnstype: A dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ· doh
è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ·
doh è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:42 doh.go:91: dns
resolved www.so.com ips:[180.163.237.15] 2025/09/14 15:55:42 options.go:240:
success connect to address=www.so.com:80 by network=tcp by
Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by
serverIP=180.163.237.15 [GIN] 2025/09/14 - 15:55:42 | 302 | 96.5675ms |
127.0.0.1 | HEAD "/" 2025/09/14 15:55:42 simple.go:57: remote addr: [::1]:19223
2025/09/14 15:55:42 simple.go:79: CONNECT www.so.com:443 HTTP/1.1 2025/09/14
15:55:42 simple.go:117: address:www.so.com:443 2025/09/14 15:55:42
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.so.com:443
2025/09/14 15:55:42 options.go:98: hostname www.so.com no ip found 2025/09/14
15:55:42 options.go:186: hostname www.so.com no ip found 2025/09/14 15:55:42
doh.go:16: domain: www.so.com dnstype: A,AAAA dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 doh.go:28: domain:
www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query 2025/09/14
15:55:42 doh.go:28: domain: www.so.com dnstype: A dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ· doh
è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:239: å¼€å§‹å‘èµ·
doh è¯·æ±‚ https://dns.alidns.com/dns-query 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:42 dns.go:134:
DialTLSContext dialing tcp to dns.alidns.com:443 2025/09/14 15:55:42 dns.go:164:
DialTLSContext dialing tcp to 223.5.5.5:443 2025/09/14 15:55:43 doh.go:91: dns
resolved www.so.com ips:[180.163.237.15] 2025/09/14 15:55:43 options.go:240:
success connect to address=www.so.com:443 by network=tcp by
Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by
serverIP=180.163.237.15 2025/09/14 15:55:43 simple.go:234:
è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443 2025/09/14 15:55:43 simple.go:57: remote addr:
[::1]:19227 2025/09/14 15:55:43 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 15:55:43 simple.go:117: address:www.baidu.com:443 2025/09/14 15:55:43
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com:443
2025/09/14 15:55:43 options.go:98: hostname www.baidu.com no ip found 2025/09/14
15:55:43 options.go:186: hostname www.baidu.com no ip found 2025/09/14 15:55:43
doh3.go:15: domain: www.baidu.com dnstype: A,AAAA dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:43 doh3.go:27: domain:
www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query 2025/09/14
15:55:43 doh3.go:27: domain: www.baidu.com dnstype: A dohurl:
https://dns.alidns.com/dns-query 2025/09/14 15:55:43 h3.go:60: http3 è¿žæŽ¥æˆåŠŸ
dns.alidns.com 443 [::]:50871 223.6.6.6:443 2025/09/14 15:55:43 h3.go:60: http3
è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:50870 223.6.6.6:443 2025/09/14 15:55:43
doh3.go:80: dns resolved www.baidu.com
ips:[240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5,180.101.49.44,180.101.51.73]
2025/09/14 15:55:43 options.go:240: success connect to address=www.baidu.com:443
by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by
serverIP=240e:e9:6002:1ac:0:ff:b07e:36c5 2025/09/14 15:55:43 simple.go:234:
è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443

```
###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´

2025-09-14 15:55:46

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 33652

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨... âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 30712

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD http://www.baidu.com/ HTTP/1.1 Host: www.baidu.com User-Agent:
  > curl/8.12.1 Accept: _/_ Proxy-Connection: Keep-Alive
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 07:55:33 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_9105971924304972876 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 OK Accept-Ranges:
  bytes Cache-Control: private, no-cache, no-store, proxy-revalidate,
  no-transform Connection: keep-alive Content-Length: 277 Content-Type:
  text/html Date: Sun, 14 Sep 2025 07:55:33 GMT Etag: "575e1f60-115"
  Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
  bfe/1.0.8.18 Tr_id: bfe_9105971924304972876

```
### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:18080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 12104

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD http://www.so.com/ HTTP/1.1 Host: www.so.com User-Agent: curl/8.12.1
  > Accept: _/_ Proxy-Connection: Keep-Alive
- Request completely sent off < HTTP/1.1 302 Found < Connection: keep-alive <
  Content-Type: text/html < Date: Sun, 14 Sep 2025 07:55:33 GMT < Location:
  https://www.so.com/ < Server: openresty < Set-Cookie: QiHooGUID=;
  Max-Age=63072000; Domain=so.com; Path=/
- Ignoring the response-body <

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact
- Clear auth, redirects to port from 80 to 443
- Issue another request to this URL: 'https://www.so.com/'
- Hostname localhost was found in DNS cache
- Trying [::1]:18080...
- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.so.com:443
  > CONNECT www.so.com:443 HTTP/1.1 Host: www.so.com:443 User-Agent: curl/8.12.1
  > Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [305 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [93 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [5077 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server did not agree on a protocol. Uses default.
- Server certificate:
- subject: CN=\*.so.com
- start date: Aug 28 00:00:00 2025 GMT
- expire date: Sep 28 23:59:59 2026 GMT
- subjectAltName: host "www.so.com" matched cert's "\*.so.com"
- issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA [Run by the Issuer]
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha384WithRSAEncryption
- Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using
  sha384WithRSAEncryption
- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.so.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Server: openresty < Date: Sun,
  14 Sep 2025 07:55:33 GMT < Content-Type: text/html; charset=UTF-8 <
  Connection: keep-alive < Vary: Accept-Encoding < Set-Cookie:
  \_S=7f5ktlhncmdgcuh9peidjuqtp0; expires=Sun, 14-Sep-2025 08:05:33 GMT;
  Max-Age=600; path=/ < Expires: Thu, 19 Nov 1981 08:52:00 GMT < Cache-Control:
  no-store, no-cache, must-revalidate < Pragma: no-cache < php-waf-rep: - <
  Set-Cookie: QiHooGUID=9F598D1F6716E9AC145091FBE66D5BD0.1757836533965;
  Max-Age=63072000; Domain=so.com; Path=/ <

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #1 to host localhost left intact HTTP/1.1 302 Found Connection:
  keep-alive Content-Type: text/html Date: Sun, 14 Sep 2025 07:55:33 GMT
  Location: https://www.so.com/ Server: openresty Set-Cookie: QiHooGUID=;
  Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK Server: openresty Date: Sun, 14 Sep 2025 07:55:33 GMT
Content-Type: text/html; charset=UTF-8 Connection: keep-alive Vary:
Accept-Encoding Set-Cookie: \_S=7f5ktlhncmdgcuh9peidjuqtp0; expires=Sun,
14-Sep-2025 08:05:33 GMT; Max-Age=600; path=/ Expires: Thu, 19 Nov 1981 08:52:00
GMT Cache-Control: no-store, no-cache, must-revalidate Pragma: no-cache
php-waf-rep: - Set-Cookie:
QiHooGUID=9F598D1F6716E9AC145091FBE66D5BD0.1757836533965; Max-Age=63072000;
Domain=so.com; Path=/

```
### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 33172

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.baidu.com:443
  > CONNECT www.baidu.com:443 HTTP/1.1 Host: www.baidu.com:443 User-Agent:
  > curl/8.12.1 Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [308 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [102 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [4771 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server accepted http/1.1
- Server certificate:
- subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science
  Technology Co., Ltd; CN=baidu.com
- start date: Jul 9 07:01:02 2025 GMT
- expire date: Aug 10 07:01:01 2026 GMT
- subjectAltName: host "www.baidu.com" matched cert's "\*.baidu.com"
- issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 07:55:34 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_8481616153485965955 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 Connection
  established

HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: private, no-cache, no-store,
proxy-revalidate, no-transform Connection: keep-alive Content-Length: 277
Content-Type: text/html Date: Sun, 14 Sep 2025 07:55:34 GMT Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
bfe/1.0.8.18 Tr_id: bfe_8481616153485965955

```
### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 20580, 33652, 33652, 30712, 30712, 12104, 12104, 33172, 33172

###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´

2025-09-14 15:55:46

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 33652

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨... âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 30712

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD http://www.baidu.com/ HTTP/1.1 Host: www.baidu.com User-Agent:
  > curl/8.12.1 Accept: _/_ Proxy-Connection: Keep-Alive
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 07:55:33 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_9105971924304972876 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 OK Accept-Ranges:
  bytes Cache-Control: private, no-cache, no-store, proxy-revalidate,
  no-transform Connection: keep-alive Content-Length: 277 Content-Type:
  text/html Date: Sun, 14 Sep 2025 07:55:33 GMT Etag: "575e1f60-115"
  Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
  bfe/1.0.8.18 Tr_id: bfe_9105971924304972876

```
### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:18080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 12104

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD http://www.so.com/ HTTP/1.1 Host: www.so.com User-Agent: curl/8.12.1
  > Accept: _/_ Proxy-Connection: Keep-Alive
- Request completely sent off < HTTP/1.1 302 Found < Connection: keep-alive <
  Content-Type: text/html < Date: Sun, 14 Sep 2025 07:55:33 GMT < Location:
  https://www.so.com/ < Server: openresty < Set-Cookie: QiHooGUID=;
  Max-Age=63072000; Domain=so.com; Path=/
- Ignoring the response-body <

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact
- Clear auth, redirects to port from 80 to 443
- Issue another request to this URL: 'https://www.so.com/'
- Hostname localhost was found in DNS cache
- Trying [::1]:18080...
- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.so.com:443
  > CONNECT www.so.com:443 HTTP/1.1 Host: www.so.com:443 User-Agent: curl/8.12.1
  > Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [305 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [93 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [5077 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server did not agree on a protocol. Uses default.
- Server certificate:
- subject: CN=\*.so.com
- start date: Aug 28 00:00:00 2025 GMT
- expire date: Sep 28 23:59:59 2026 GMT
- subjectAltName: host "www.so.com" matched cert's "\*.so.com"
- issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA [Run by the Issuer]
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha384WithRSAEncryption
- Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using
  sha384WithRSAEncryption
- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.so.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Server: openresty < Date: Sun,
  14 Sep 2025 07:55:33 GMT < Content-Type: text/html; charset=UTF-8 <
  Connection: keep-alive < Vary: Accept-Encoding < Set-Cookie:
  \_S=7f5ktlhncmdgcuh9peidjuqtp0; expires=Sun, 14-Sep-2025 08:05:33 GMT;
  Max-Age=600; path=/ < Expires: Thu, 19 Nov 1981 08:52:00 GMT < Cache-Control:
  no-store, no-cache, must-revalidate < Pragma: no-cache < php-waf-rep: - <
  Set-Cookie: QiHooGUID=9F598D1F6716E9AC145091FBE66D5BD0.1757836533965;
  Max-Age=63072000; Domain=so.com; Path=/ <

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #1 to host localhost left intact HTTP/1.1 302 Found Connection:
  keep-alive Content-Type: text/html Date: Sun, 14 Sep 2025 07:55:33 GMT
  Location: https://www.so.com/ Server: openresty Set-Cookie: QiHooGUID=;
  Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK Server: openresty Date: Sun, 14 Sep 2025 07:55:33 GMT
Content-Type: text/html; charset=UTF-8 Connection: keep-alive Vary:
Accept-Encoding Set-Cookie: \_S=7f5ktlhncmdgcuh9peidjuqtp0; expires=Sun,
14-Sep-2025 08:05:33 GMT; Max-Age=600; path=/ Expires: Thu, 19 Nov 1981 08:52:00
GMT Cache-Control: no-store, no-cache, must-revalidate Pragma: no-cache
php-waf-rep: - Set-Cookie:
QiHooGUID=9F598D1F6716E9AC145091FBE66D5BD0.1757836533965; Max-Age=63072000;
Domain=so.com; Path=/

```
### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 33172

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.baidu.com:443
  > CONNECT www.baidu.com:443 HTTP/1.1 Host: www.baidu.com:443 User-Agent:
  > curl/8.12.1 Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [308 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [102 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [4771 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server accepted http/1.1
- Server certificate:
- subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science
  Technology Co., Ltd; CN=baidu.com
- start date: Jul 9 07:01:02 2025 GMT
- expire date: Aug 10 07:01:01 2026 GMT
- subjectAltName: host "www.baidu.com" matched cert's "\*.baidu.com"
- issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 07:55:34 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_8481616153485965955 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 Connection
  established

HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: private, no-cache, no-store,
proxy-revalidate, no-transform Connection: keep-alive Content-Length: 277
Content-Type: text/html Date: Sun, 14 Sep 2025 07:55:34 GMT Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
bfe/1.0.8.18 Tr_id: bfe_8481616153485965955

```
### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 20580, 33652, 33652, 30712, 30712, 12104, 12104, 33172, 33172

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹... âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º
```

2025/09/14 15:55:47 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­... 2025/09/14 15:55:47
main.go:562: dohalpn: [] 2025/09/14 15:55:47 main.go:564: hostname: 0.0.0.0
2025/09/14 15:55:47 main.go:566: port: 18080 2025/09/14 15:55:47 main.go:568:
server_cert: 2025/09/14 15:55:47 main.go:570: server_key: 2025/09/14 15:55:47
main.go:572: username: 2025/09/14 15:55:47 main.go:574: password: 2025/09/14
15:55:47 main.go:576: dohurl: [] 2025/09/14 15:55:47 main.go:578: dohip: []
2025/09/14 15:55:47 main.go:579: upstream-type: 2025/09/14 15:55:47 main.go:580:
upstream-address: 2025/09/14 15:55:47 main.go:581: upstream-username: 2025/09/14
15:55:47 main.go:582: upstream-password: 2025/09/14 15:55:47 main.go:927: null
2025/09/14 15:55:47 simple.go:31: Proxy server started on port [::]:18080
2025/09/14 15:55:47 http.go:372: Random IP: 127.99.110.52 2025/09/14 15:55:47
http.go:390: Random integer: 25539 2025/09/14 15:55:47 http.go:342: Proxy server
started on port 127.99.110.52:25539 2025/09/14 15:55:48 simple.go:57: remote
addr: [::1]:19236 2025/09/14 15:55:48 simple.go:79: GET http://www.baidu.com/
HTTP/1.1 2025/09/14 15:55:48 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 15:55:48 simple.go:117: address:www.baidu.com:80 2025/09/14 15:55:48
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.99.110.52:25539
2025/09/14 15:55:48 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.99.110.52:25539 2025/09/14
15:55:48 simple.go:248: clienthost: ::1 2025/09/14 15:55:48 simple.go:249:
clientport: 19236 2025/09/14 15:55:48 simple.go:278: simple Handle header:
2025/09/14 15:55:48 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:48
simple.go:283: GET / HTTP/1.1 2025/09/14 15:55:48 simple.go:288: Forwarded:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:48
simple.go:294: Host: www.baidu.com User-Agent: Go-http-client/1.1
Accept-Encoding: gzip 2025/09/14 15:55:48 http.go:90: method: GET 2025/09/14
15:55:48 http.go:91: url: / 2025/09/14 15:55:48 http.go:92: host: www.baidu.com
2025/09/14 15:55:48 http.go:93: proxyHandler header: 2025/09/14 15:55:48
http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:48 http.go:121: clientport:
19237 2025/09/14 15:55:48 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.99.110.52:25539;host=www.baidu.com;proto=http
2025/09/14 15:55:48 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 15:55:48 http.go:132: proxyHandler Accept-Encoding : gzip 2025/09/14
15:55:48 http.go:135: forwardedHeader:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.99.110.52:25539;host=www.baidu.com;proto=http 2025/09/14
15:55:48 http.go:137: forwardedByList: [{[::1]:18080} {127.99.110.52:25539}]
2025/09/14 15:55:48 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
15:55:48 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 15:55:48 | 200 | 60.0206ms | 127.0.0.1 | GET "/" 2025/09/14
15:55:50 simple.go:57: remote addr: [::1]:19239 2025/09/14 15:55:50
simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1 2025/09/14 15:55:50
simple.go:305: Domain: www.baidu.com, Port: 80 2025/09/14 15:55:50
simple.go:117: address:www.baidu.com:80 2025/09/14 15:55:50
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.99.110.52:25539
2025/09/14 15:55:50 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.99.110.52:25539 2025/09/14
15:55:50 simple.go:248: clienthost: ::1 2025/09/14 15:55:50 simple.go:249:
clientport: 19239 2025/09/14 15:55:50 simple.go:278: simple Handle header:
2025/09/14 15:55:50 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:50
simple.go:283: HEAD / HTTP/1.1 2025/09/14 15:55:50 simple.go:288: Forwarded:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http 2025/09/14 15:55:50
simple.go:294: Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
Proxy-Connection: Keep-Alive 2025/09/14 15:55:50 http.go:90: method: HEAD
2025/09/14 15:55:50 http.go:91: url: / 2025/09/14 15:55:50 http.go:92: host:
www.baidu.com 2025/09/14 15:55:50 http.go:93: proxyHandler header: 2025/09/14
15:55:50 http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:50 http.go:121:
clientport: 19240 2025/09/14 15:55:50 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.99.110.52:25539;host=www.baidu.com;proto=http
2025/09/14 15:55:50 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 15:55:50 http.go:132: proxyHandler Accept : _/_ 2025/09/14 15:55:50
http.go:132: proxyHandler Proxy-Connection : Keep-Alive 2025/09/14 15:55:50
http.go:135: forwardedHeader:
for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.99.110.52:25539;host=www.baidu.com;proto=http 2025/09/14
15:55:50 http.go:137: forwardedByList: [{[::1]:18080} {127.99.110.52:25539}]
2025/09/14 15:55:50 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
15:55:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 15:55:50 | 200 | 54.4732ms | 127.0.0.1 | HEAD "/" 2025/09/14
15:55:50 simple.go:57: remote addr: [::1]:19241 2025/09/14 15:55:50
simple.go:79: HEAD http://www.so.com/ HTTP/1.1 2025/09/14 15:55:50
simple.go:305: Domain: www.so.com, Port: 80 2025/09/14 15:55:50 simple.go:117:
address:www.so.com:80 2025/09/14 15:55:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥
CheckShouldUseProxy 127.99.110.52:25539 2025/09/14 15:55:50 simple.go:234:
è¿žæŽ¥æˆåŠŸï¼š127.99.110.52:25539 2025/09/14 15:55:50 simple.go:248: clienthost: ::1
2025/09/14 15:55:50 simple.go:249: clientport: 19241 2025/09/14 15:55:50
simple.go:278: simple Handle header: 2025/09/14 15:55:50 simple.go:281: simple
Handle Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 15:55:50 simple.go:283: HEAD / HTTP/1.1 2025/09/14 15:55:50
simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 15:55:50 simple.go:294: Host: www.so.com User-Agent: curl/8.12.1
Accept: _/_ Proxy-Connection: Keep-Alive 2025/09/14 15:55:50 http.go:90: method:
HEAD 2025/09/14 15:55:50 http.go:91: url: / 2025/09/14 15:55:50 http.go:92:
host: www.so.com 2025/09/14 15:55:50 http.go:93: proxyHandler header: 2025/09/14
15:55:50 http.go:120: clienthost: 127.0.0.1 2025/09/14 15:55:50 http.go:121:
clientport: 19242 2025/09/14 15:55:50 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.99.110.52:25539;host=www.so.com;proto=http
2025/09/14 15:55:50 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 15:55:50 http.go:132: proxyHandler Accept : _/_ 2025/09/14 15:55:50
http.go:132: proxyHandler Proxy-Connection : Keep-Alive 2025/09/14 15:55:50
http.go:135: forwardedHeader:
for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,
for=127.0.0.1;by=127.99.110.52:25539;host=www.so.com;proto=http 2025/09/14
15:55:50 http.go:137: forwardedByList: [{[::1]:18080} {127.99.110.52:25539}]
2025/09/14 15:55:50 http.go:155: targetUrl: http://www.so.com/ 2025/09/14
15:55:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 15:55:50 | 302 | 86.7759ms | 127.0.0.1 | HEAD "/" 2025/09/14
15:55:50 simple.go:57: remote addr: [::1]:19256 2025/09/14 15:55:50
simple.go:79: CONNECT www.so.com:443 HTTP/1.1 2025/09/14 15:55:50 simple.go:117:
address:www.so.com:443 2025/09/14 15:55:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥
CheckShouldUseProxy www.so.com:443 2025/09/14 15:55:50 options.go:98: hostname
www.so.com no ip found 2025/09/14 15:55:50 options.go:123: success connect to
www.so.com:443 by tcp 2025/09/14 15:55:50 simple.go:234:
è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443 2025/09/14 15:55:50 simple.go:57: remote addr:
[::1]:19262 2025/09/14 15:55:50 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 15:55:50 simple.go:117: address:www.baidu.com:443 2025/09/14 15:55:50
CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com:443
2025/09/14 15:55:50 options.go:98: hostname www.baidu.com no ip found 2025/09/14
15:55:50 options.go:123: success connect to www.baidu.com:443 by tcp 2025/09/14
15:55:50 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443

```
### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º
```

### Curl æµ‹è¯• 1 è¾“å‡º

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD http://www.baidu.com/ HTTP/1.1 Host: www.baidu.com User-Agent:
  > curl/8.12.1 Accept: _/_ Proxy-Connection: Keep-Alive
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 07:55:33 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_9105971924304972876 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 OK Accept-Ranges:
  bytes Cache-Control: private, no-cache, no-store, proxy-revalidate,
  no-transform Connection: keep-alive Content-Length: 277 Content-Type:
  text/html Date: Sun, 14 Sep 2025 07:55:33 GMT Etag: "575e1f60-115"
  Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
  bfe/1.0.8.18 Tr_id: bfe_9105971924304972876

### Curl æµ‹è¯• 2 è¾“å‡º

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD http://www.so.com/ HTTP/1.1 Host: www.so.com User-Agent: curl/8.12.1
  > Accept: _/_ Proxy-Connection: Keep-Alive
- Request completely sent off < HTTP/1.1 302 Found < Connection: keep-alive <
  Content-Type: text/html < Date: Sun, 14 Sep 2025 07:55:33 GMT < Location:
  https://www.so.com/ < Server: openresty < Set-Cookie: QiHooGUID=;
  Max-Age=63072000; Domain=so.com; Path=/
- Ignoring the response-body <

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact
- Clear auth, redirects to port from 80 to 443
- Issue another request to this URL: 'https://www.so.com/'
- Hostname localhost was found in DNS cache
- Trying [::1]:18080...
- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.so.com:443
  > CONNECT www.so.com:443 HTTP/1.1 Host: www.so.com:443 User-Agent: curl/8.12.1
  > Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [305 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [93 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [5077 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server did not agree on a protocol. Uses default.
- Server certificate:
- subject: CN=\*.so.com
- start date: Aug 28 00:00:00 2025 GMT
- expire date: Sep 28 23:59:59 2026 GMT
- subjectAltName: host "www.so.com" matched cert's "\*.so.com"
- issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA [Run by the Issuer]
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha384WithRSAEncryption
- Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using
  sha384WithRSAEncryption
- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.so.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Server: openresty < Date: Sun,
  14 Sep 2025 07:55:33 GMT < Content-Type: text/html; charset=UTF-8 <
  Connection: keep-alive < Vary: Accept-Encoding < Set-Cookie:
  \_S=7f5ktlhncmdgcuh9peidjuqtp0; expires=Sun, 14-Sep-2025 08:05:33 GMT;
  Max-Age=600; path=/ < Expires: Thu, 19 Nov 1981 08:52:00 GMT < Cache-Control:
  no-store, no-cache, must-revalidate < Pragma: no-cache < php-waf-rep: - <
  Set-Cookie: QiHooGUID=9F598D1F6716E9AC145091FBE66D5BD0.1757836533965;
  Max-Age=63072000; Domain=so.com; Path=/ <

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #1 to host localhost left intact HTTP/1.1 302 Found Connection:
  keep-alive Content-Type: text/html Date: Sun, 14 Sep 2025 07:55:33 GMT
  Location: https://www.so.com/ Server: openresty Set-Cookie: QiHooGUID=;
  Max-Age=63072000; Domain=so.com; Path=/ HTTP/1.1 200 Connection established
  HTTP/1.1 200 OK Server: openresty Date: Sun, 14 Sep 2025 07:55:33 GMT
  Content-Type: text/html; charset=UTF-8 Connection: keep-alive Vary:
  Accept-Encoding Set-Cookie: \_S=7f5ktlhncmdgcuh9peidjuqtp0; expires=Sun,
  14-Sep-2025 08:05:33 GMT; Max-Age=600; path=/ Expires: Thu, 19 Nov 1981
  08:52:00 GMT Cache-Control: no-store, no-cache, must-revalidate Pragma:
  no-cache php-waf-rep: - Set-Cookie:
  QiHooGUID=9F598D1F6716E9AC145091FBE66D5BD0.1757836533965; Max-Age=63072000;
  Domain=so.com; Path=/

### Curl æµ‹è¯• 3 è¾“å‡º

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:18080 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:18080...

- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.baidu.com:443
  > CONNECT www.baidu.com:443 HTTP/1.1 Host: www.baidu.com:443 User-Agent:
  > curl/8.12.1 Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [308 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [102 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [4771 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server accepted http/1.1
- Server certificate:
- subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science
  Technology Co., Ltd; CN=baidu.com
- start date: Jul 9 07:01:02 2025 GMT
- expire date: Aug 10 07:01:01 2026 GMT
- subjectAltName: host "www.baidu.com" matched cert's "\*.baidu.com"
- issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Connected to localhost (::1) port 18080
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 07:55:34 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_8481616153485965955 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 Connection
  established HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: private,
  no-cache, no-store, proxy-revalidate, no-transform Connection: keep-alive
  Content-Length: 277 Content-Type: text/html Date: Sun, 14 Sep 2025 07:55:34
  GMT Etag: "575e1f60-115" Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma:
  no-cache Server: bfe/1.0.8.18 Tr_id: bfe_8481616153485965955

```
âœ… ç«¯å£18080å·²æˆåŠŸé‡Šæ”¾18080

###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´

2025-09-14 16:34:02

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨18080

æ‰§è¡Œå‘½ä»¤:
`go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤:
`./socks5-websock18080oxy-golang.exe -mode server -protocol websocket -addr :18080`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 17468

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨... âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
18080
## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰18080

æ‰§è¡Œå‘½ä»¤:
`./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:18080`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 19940

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨... âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 24872, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD http://www.baidu.com/ HTTP/1.1 Host: www.baidu.com User-Agent:
  > curl/8.12.1 Accept: _/_ Proxy-Connection: Keep-Alive
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes18080 <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 08:33:52 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_11211808077149344054 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 OK18080
  Accept-Ranges: bytes Cache-Control: private, no-cache, no-store,
  proxy-revalidate, no-transform Connection: keep-alive Content-Length: 277
  Content-Type: text/html Date: Sun, 14 Sep 2025 08:33:52 GMT Etag:
  "575e1f60-115" Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache
  Server: bfe/1.0.8.18 Tr_id: bfe_11219641377149344054

```
### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 7744, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.baidu.com:443
  > CONNECT www.baidu.com:443 HTTP/1.1 Host: www.baidu.com:443 User-Agent:
  > curl/8.12.1 Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [308 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win18080ngw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [102 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [4771 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server accepted http/1.1
- Server certificate:
- subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science
  Technology Co., Ltd; CN=baidu.com
- start date: Jul 9 07:01:02 2025 GMT
- expire date: Aug 10 07:01:01 2026 GMT
- subjectAltName: host "www.baidu.com" matched cert's "\*.baidu.com"
- issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 08:33:52 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_9324045590230278964 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 Connection
  established

HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: private, no-cache, no-store,
proxy-revalidate, no-transform Connection: keep-alive Content-Length: 277
Content-Type: text/html Date: Sun, 14 Sep 2025 08:33:52 GMT Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
bfe/1.0.8.18 Tr_id: bfe_9324045590230278964

```18080
### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 35120, 26084, 17468, 17468, 19940, 19940, 24872, 24872, 7744, 7744

###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´18080

2025-09-14 16:34:02

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤:
`go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ
18080
## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤:
`./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :18080`
18080
ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 1746818080

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨... âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤:
`./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:18080`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 19940

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨... âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 24872, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD http://www.baidu.com/ HTTP/1.1 Host: www.baidu.com User-Agent:
  > curl/8.12.1 Accept: _/_ Proxy-Connection: Keep-Alive18080
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 08:33:52 GMT < Etag: "575e1f6018080 < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_11219641377149344054 < 18080

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 OK Accept-Ranges:
  bytes Cache-Control: private, no-cache, no-store, proxy-revalidate,
  no-transform Connection: keep-alive Content-Length: 277 Content-Type:
  text/html Date: Sun, 14 Sep 2025 08:33:52 GMT Etag: "575e1f60-115"
  Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
  bfe/1.0.8.18 Tr_id: bfe_11219641377149344054

```
### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 7744, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.baidu.com:443
  > CONNECT www.baidu.com:443 HTTP/1.1 Host: www.baidu.com:443 User-Agent:
  > curl/8.12.1 Proxy-Connection: Keep-Alive
  >
  > < HTTP/1.1 200 Connection established <
- CONNECT phase completed
- CONNECT tunnel established, respon180800
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [308 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [102 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [4771 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]
- TLSv1.2 (IN), TLS change cipher, Change cipher spec (1): { [1 bytes data]
- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server accepted http/1.1
- Server certificate:
- subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science
  Technology Co., Ltd; CN=baidu.com
- start date: Jul 9 07:01:02 2025 GMT
- expire date: Aug 10 07:01:01 2026 GMT
- subjectAltName: host "www.baidu.com" matched cert's "\*.baidu.com"
- issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD / HTTP/1.1 Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
- Request completely sent off < HTTP/1.1 200 OK < Accept-Ranges: bytes <
  Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform <
  Connection: keep-alive < Content-Length: 277 < Content-Type: text/html < Date:
  Sun, 14 Sep 2025 08:33:52 GMT < Etag: "575e1f60-115" < Last-Modified: Mon, 13
  Jun 2016 02:50:08 GMT < Pragma: no-cache < Server: bfe/1.0.8.18 < Tr_id:
  bfe_9324045590230278964 <

  0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 Connection
  established

HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: private, no-cache, no-store,
proxy-revalidate, no-transform Connection: keep-alive Content-Length: 277
Content-Type: text/html Date: Sun, 14 Sep 2025 08:33:52 GMT Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
bfe/1.0.8.18 Tr_id: bfe_9324045590230278964

```
### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 35120, 26084, 17468, 17468, 19940, 19940, 24872, 24872, 7744, 7744

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹... âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹... âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹... âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶

### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º
```

2025/09/14 16:34:05 main.go:147: å¯åŠ¨ websocket æœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :18080
2025/09/14 16:34:05 server.go:83: [WEBSOCKET-SERVER] Server started
successfully, listening on :18080 2025/09/14 16:34:05 server.go:84:
[WEBSOCKET-SERVER] Authentication enabled: false (0 users configured) 2025/09/14
16:34:05 server.go:86: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 16:34:05 server.go:87: [WEBSOCKET-SERVER] Read timeout: 30s, Write
timeout: 30s 2025/09/14 16:34:05 main.go:221: websocket æœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰ Ctrl+C
åœæ­¢ 2025/09/14 16:34:07 server.go:102: url / 2025/09/14 16:34:07 server.go:104:
headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate;
server_no_context_takeover; client_no_context_takeover]
Sec-Websocket-Key:[r26LNgTkGpQGChi0KePgpQ==] Sec-Websocket-Version:[13]
Upgrade:[websocket] User-Agent:[Go-http-client/1.1]
X-Proxy-Target-Host:[127.9.161.22] X-Proxy-Target-Port:[16793]] 2025/09/14
16:34:07 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:44062
at 2025-09-14 16:34:07 2025/09/14 16:34:07 server.go:113: [WEBSOCKET-CONN] No
authentication required for client [::1]:44062 2025/09/14 16:34:07
server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '',
targetHost: '127.9.161.22', targetPort: 16793 2025/09/14 16:34:07 server.go:185:
[WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:34:07 server.go:131: [WEBSOCKET-AUTH] Authentication successful
for user '' from [::1]:44062 2025/09/14 16:34:07 server.go:141: [WEBSOCKET-CONN]
WebSocket connection established successfully for target 127.9.161.22:16793 from
[::1]:44062 2025/09/14 16:34:07 server.go:239: [WEBSOCKET-UPSTREAM] Using direct
connection for target 127.9.161.22:16793 (timeout: 30s) 2025/09/14 16:34:07
server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target
127.9.161.22:16793 2025/09/14 16:34:07 server.go:333: [WEBSOCKET-FORWARD]
Starting data forwarding between connections 2025/09/14 16:34:07 server.go:102:
url / 2025/09/14 16:34:07 server.go:104: headers map[Connection:[Upgrade]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Sec-Websocket-Key:[7kvAbLyYPu7jkDjg7f3EsA==]
Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1]
X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]] 2025/09/14
16:34:07 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:44064
at 2025-09-14 16:34:07 2025/09/14 16:34:07 server.go:113: [WEBSOCKET-CONN] No
authentication required for client [::1]:44064 2025/09/14 16:34:07
server.go:323: [WEB18080T-AUTH] Parsed auth info - username: '', password: '',
targetHost: 'www.baidu.com', targetPort: 80 2025/09/14 16:34:07 server.go:185:
[WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:34:07 server.go:131: [WEBSOCKET-AUTH] Authentication successful
for user '' from [::1]:44064 2025/09/14 16:34:07 server.go:141: [WEBSOCKET-CONN]
WebSocket connection established successfully for target www.baidu.com:80 from
[::1]:44064 2025/09/14 16:34:07 server.go:239: [WEBSOCKET-UPSTREAM] Using direct
connection for target www.baidu.com:80 (timeout: 30s) 2025/09/14 16:34:07
server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target
www.baidu.com:80 2025/09/14 16:34:07 server.go:333: [WEBSOCKET-FORWARD] Starting
data forwarding between connections 2025/09/14 16:34:09 server.go:102: url /
2025/09/14 16:34:09 server.go:104: headers map[Connection:[Upgrade]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Sec-Websocket-Key:[hKhjhRb4dk7l7ReB5mcqdw==]
Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1]
X-Proxy-Target-Host:[127.9.161.22] X-Proxy-Target-Port:[16793]] 2025/09/14
16:34:09 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:44102
at 2025-09-14 16:34:09 2025/09/14 16:34:09 server.go:113: [WEBSOCKET-CONN] No
authentication required for client [::1]:44102 2025/09/14 16:34:09
server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '',
targetHost: '127.9.161.22', targetPort: 16793 2025/09/14 16:34:09 server.go:185:
[WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:34:09 server.go:131: [WEBSOCKET-AUTH] Authentication successful
for user '' from [::1]:44102 2025/09/14 16:34:09 server.go:141: [WEBSOCKET-CONN]
WebSocket connection established successfully for target 127.9.161.22:16793 from
[::1]:44102 2025/09/14 16:34:09 server.go:239: [WEBSOCKET-UPSTREAM] Using direct
connection for target 127.9.161.22:16793 (timeout: 30s) 2025/09/14 16:34:09
server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target
127.9.161.22:16793 2025/09/14 16:34:09 server.go:333: [WEBSOCKET-FORWARD]
Starting data forwarding between connections 2025/09/14 16:34:09 server.go:102:
url / 2025/09/14 16:34:09 server.go:104: headers map[Connection:[Upgrade]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Sec-Websocket-Key:[HQ30VGtr0lHAL/IJ6bk+QQ==]
Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1]
X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]] 2025/09/14
16:34:09 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:44108
at 2025-09-14 16:34:09 2025/09/14 16:34:09 server.go:113: [WEBSOCKET-CONN] No
authentication required for client [::1]:44108 2025/09/14 16:34:09
server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '',
targetHost: 'www.baidu.com', targetPort: 443 2025/09/14 16:34:09 server.go:185:
[WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:34:09 server.go:131: [WEBSOCKET-AUTH] Authentication successful
for user '' from [::1]:44108 2025/09/14 16:34:09 server.go:141: [WEBSOCKET-CONN]
WebSocket connection established successfully for target www.baidu.com:443 from
[::1]:44108 2025/09/14 16:34:09 server.go:239: [WEBSOCKET-UPSTREAM] Using direct
connection for target www.baidu.com:443 (timeout: 30s) 2025/09/14 16:34:09
server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target
www.baidu.com:443 2025/09/14 16:34:09 server.go:333: [WEBSOCKET-FORWARD]
Starting data forwarding between connections

```
### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º
```

2025/09/14 16:34:06 main.go:519: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­... 2025/09/14 16:34:06
main.go:563: dohalpn: [] 2025/09/14 16:34:06 main.go:565: hostname: 0.0.0.0
2025/09/14 16:34:06 main.go:567: port: 10810 2025/09/14 16:34:06 main.go:569:
server_cert: 2025/09/14 16:34:06 main.go:571: server_key: 2025/09/14 16:34:06
main.go:573: username: 2025/09/14 16:34:06 main.go:575: password: 2025/09/14
16:34:06 main.go:577: dohurl: [] 2025/09/14 16:34:06 main.go:579: dohip: []
2025/09/14 16:34:06 main.go:580: upstream-type: websocket 2025/09/14 16:34:06
main.go:581: upstream-address: ws://localhost:18080 2025/09/14 16:34:06
main.go:582: upstream-username: 2025/09/14 16:34:06 main.go:583:
upstream-password: 2025/09/14 16:34:06 main.go:640: WebSocket ä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 16:34:06 main.go:898: { "hostname": "",18080 "port": 0,
"server_cert": "", "server_key": "", "username": "", "password": "", "doh":
null, "upstreams": { "websocket_upstream": { "type": "websocket", "http_proxy":
"ws://localhost:18080", "https_proxy": "ws://localhost:18080", "bypass_list":
null, "ws_proxy": "ws://localhost:18080", "ws_username": "", "ws_password": "",
"http_username": "", "http_password": "", "socks5_proxy":
"ws://localhost:18080", "socks5_username": "", "socks5_password": "" } },
"rules": [ { "filter": "websocket_filter", "upstream": "websocket_upstream"18080
} ],18080 "filters": { "websocket_filter": { "patterns": [ "*" ] } } }
2025/09/14 16:34:06 simple.go:31: Proxy server started on port [::]:10810
2025/09/14 16:34:06 http.go:388: Random IP: 127.9.161.22 2025/09/14 16:34:06
http.go:406: Random integer: 16793 2025/09/14 16:34:06 http.go:358: Proxy server
started on port 127.9.161.22:18080 2025/09/14 16:34:07 simple.go:57: remote
addr: [::1]:4406118080 2025/09/14 16:34:07 simple.go:79: GET
http://www.baidu.com18080P/1.1 2025/09/14 16:34:07 simple.go:305: Domain:
www.baidu.com, Port: 80 2025/09/14 16:34:07 simple.go:117:
address:www.baidu.com:80 2025/09/14 16:34:07 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥
CheckShouldUseProxy 127.9.161.22:16793 2025/09/14 16:34:07 main.go:829:
ProxySelector 127.9.161.22:16793 2025/09/14 16:34:07 main.go:835: é€‰æ‹©çš„ä»£ç†
URL: ws://localhost:18080 2025/09/14 16:34:07 simple.go:179: WebSocket Config
Details: 2025/09/14 16:34:07 simple.go:180: host, portNum 127.9.161.22 16793
2025/09/14 16:34:07 simple.go:181: Username: 2025/09/14 16:34:07 simple.go:182:
Password: 2025/09/14 16:34:07 simple.go:183: ServerAddr: ws://localhost:18080
2025/09/14 16:34:07 simple.go:184: Protocol: websocket 2025/09/14 16:34:07
simple.go:185: Timeout: 30s 2025/09/14 16:34:07 client.go:107: url:
ws://localhost:18080 2025/09/14 16:34:07 client.go:108: headers:
map[X-Proxy-Target-Host:[127.9.161.22] X-Proxy-Target-Port:[16793]] 2025/09/14
16:34:07 client.go:119: url: http://localhost:18080 2025/09/14 16:34:07
client.go:120: headers: map[Connection:[Upgrade]
Sec-Websocket-Accept:[WHgsuvzkQzZ9gxg1u+m2d6KvbVQ=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] 2025/09/14 16:34:07
simple.go:209: WebSocket ä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.9.161.22:16793 2025/09/14 16:34:07
simple.go:248: clienthost: ::1 2025/09/14 16:34:07 simple.go:249: clientport:
44061 2025/09/14 16:34:07 simple.go:278: simple Handle header: 2025/09/14
16:34:07 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 16:34:07
simple.go:283: GET / HTTP/1.1 2025/09/14 16:34:07 simple.go:288: Forwarded:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 16:34:07
simple.go:294: Host: www.baidu.com User-Agent: Go-http-client/1.1
Accept-Encoding: gzip 2025/09/14 16:34:07 http.go:90: method: GET 2025/09/14
16:34:07 http.go:91: url: / 2025/09/14 16:34:07 http.go:92: host: www.baidu.com
2025/09/14 16:34:07 http.go:93: proxyHandler header: 2025/09/14 16:34:07
http.go:120: clienthost: 127.0.0.1 2025/09/14 16:34:07 http.go:121: clientport:
44063 2025/09/14 16:34:07 http.go:132: proxyHandler User-Agent :
Go-http-client/1.1 2025/09/14 16:34:07 http.go:132: proxyHandler Accept-Encoding
: gzip 2025/09/14 16:34:07 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.9.161.22:16793;host=www.baidu.com;proto=http
2025/09/14 16:34:07 http.go:135: forwardedHeader:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.9.161.22:16793;host=www.baidu.com;proto=http 2025/09/14
16:34:07 http.go:137: forwardedByList: [{[::1]:10810} {127.9.161.22:16793}]
2025/09/14 16:34:07 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
16:34:07 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
2025/09/14 16:34:07 main.go:829: ProxySelector www.baidu.com 2025/09/14 16:34:07
main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080 2025/09/14 16:34:07
http.go:259: ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080 2025/09/14 16:34:07 http.go:268:
å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸º websocket ws://localhost:18080 2025/09/14 16:34:07 http.go:278:
ä½¿ç”¨ä»£ç†ï¼šws://localhost:1808018080 2025/09/14 16:34:07 http.go:280:
network,addr tcp www.baidu.com:80 2025/09/14 16:34:07 http.go:482: WebSocket
Config Details:18080 2025/09/14 16:34:07 http.go:483: host, portNum
www.baidu.com 80 2025/09/14 16:34:07 http.go:484: Username: 2025/09/14 16:34:07
http.go:485: Password: 2025/09/14 16:34:07 http.go:486: ServerAddr:
ws://localhost:18080 2025/09/14 16:34:07 http.go:487: Protocol: websocket
2025/09/14 16:34:07 http.go:488: Timeout: 30s 2025/09/14 16:34:07 http.go:492:
host, portNum www.baidu.com 80 2025/09/14 16:34:07 client.go:107: url:
ws://localhost:18080 2025/09/14 16:34:07 client.go:108: headers:
map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]] 2025/09/14
16:34:07 client.go:119: url: http://localhost:18080 2025/09/14 16:34:07
client.go:120: headers: map[Connection:[Upgrade]
Sec-Websocket-Accept:[qeNrbcuPoJhzzXbezUInD0TaW1Y=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] [GIN] 2025/09/14 - 16:34:07 |
200 | 88.0006ms | 127.0.0.1 | GET 18080/" 2025/09/14 16:34:09 simple.go:57:
remote addr: [::1]:44101 2025/09/14 16:34:09 simple.go:79: HEAD
http://www.baidu.com/ HTTP/1.1 2025/09/14 16:34:09 simple.go:305: Domain:
www.baidu.com, Port: 8018080 2025/09/14 16:34:09 simple.go:117:
address:www.baidu.com:818080 2025/09/14 16:34:09 CheckShouldUseProxy.go:10:
å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy 127.9.161.22:16793 2025/09/14 16:34:09 main.go:829:
ProxySelector 127.9.161.22:16793 2025/09/14 16:34:09 main.go:835: é€‰æ‹©çš„ä»£ç†
URL: ws://localhost:18080 2025/09/14 16:34:09 simple.go:179: WebSocket Config
Details: 2025/09/14 16:34:09 simple.go:180: host, portNum 127.9.161.22 16793
2025/09/14 16:34:09 simple.go:181: Username: 2025/09/14 16:34:09 simple.go:182:
Password: 2025/09/14 16:34:09 simple.go:183: ServerAddr: ws://localhost:18080
2025/09/14 16:34:09 simple.go:184: Protocol: websocket 2025/09/14 16:34:09
simple.go:185: Timeout: 30s 2025/09/14 16:34:09 client.go:107: url:
ws://localhost:18080 2025/09/14 16:34:09 client.go:108: headers:
map[X-Proxy-Target-Host:[127.9.161.22] X-Proxy-Target-Port:[16793]] 2025/09/14
16:34:09 client.go:119: url: http://localhost:18080 2025/09/14 16:34:09
client.go:120: headers: map[Connection:[Upgrade]
Sec-Websocket-Accept:[q8cU5/rf8TmWLbJR9KsKMWPV02Q=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] 2025/09/14 16:34:09
simple.go:209: WebSocket ä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.9.161.22:16793 2025/09/14 16:34:09
simple.go:248: clienthost: ::1 2025/09/14 16:34:09 simple.go:249: clientport:
44101 2025/09/14 16:34:09 simple.go:278: simple Handle header: 2025/09/14
16:34:09 simple.go:281: simple Handle Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 16:34:09
simple.go:283: HEAD / HTTP/1.1 2025/09/14 16:34:09 simple.go:288: Forwarded:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http 2025/09/14 16:34:09
simple.go:294: Host: www.baidu.com User-Agent: curl/8.12.1 Accept: _/_
Proxy-Connection: Keep-Alive 2025/09/14 16:34:09 http.go:90: method: HEAD
2025/09/14 16:34:09 http.go:91: url: / 2025/09/14 16:34:09 http.go:92: host:
www.baidu.com 2025/09/14 16:34:09 http.go:93: proxyHandler header: 2025/09/14
16:34:09 http.go:120: clienthost: 127.0.0.1 2025/09/14 16:34:09 http.go:121:
clientport: 44103 2025/09/14 16:34:0918080.go:132: proxyHandler Proxy-Connection
: Keep-Alive 2025/09/14 16:34:09 http.go:132: proxyHandler Forwarded :
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.9.161.22:16793;host=www.baidu.com;proto=http
2025/09/14 16:34:09 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:34:09 http.go:132: proxyHandler Accept : _/_ 2025/09/14 16:34:09
http.go:135: forwardedHeader:
for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,
for=127.0.0.1;by=127.9.161.22:16793;host=www.baidu.com;proto=http 2025/09/14
16:34:09 http.go:137: forwardedByList: [{[::1]:10810} {127.9.161.22:16793}]
2025/09/14 16:34:09 http.go:155: targetUrl: http://www.baidu.com/ 2025/09/14
16:34:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy www.baidu.com
2025/09/14 16:34:09 main.go:829: ProxySelector www.baidu.com 2025/09/14 16:34:09
main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080 2025/09/14 16:34:09
http.go:259: ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080 2025/09/14 16:34:09 http.go:268:
å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸º websocket ws://localhost:18080 [GIN] 2025/09/14 - 16:34:09 |
200 | 43.044ms | 127.0.0.1 | HEAD "/" 2025/09/14 16:34:09 simple.go:57: remote
addr: [::1]:44107 2025/09/14 16:34:09 simple.go:79: CONNECT www.baidu.com:443
HTTP/1.1 2025/09/14 16:34:09 simple.go:117: address:www.baidu.com:443 2025/09/14
16:34:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥ CheckShouldUseProxy
www.baidu.com:443 2025/09/14 16:34:09 main.go:829: ProxySelector
www.baidu.com:443 2025/09/14 16:34:09 main.go:835: é€‰æ‹©çš„ä»£ç† URL:
ws://localhost:18080 2025/09/14 16:34:09 simple.go:179: WebSocket Config
Details: 2025/09/14 16:34:09 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 16:34:09 simple.go:181: Username: 2025/09/14 16:34:09 simple.go:182:
Password: 2025/09/14 16:34:09 simple.go:183: ServerAddr: ws://localhost:18080
2025/09/14 16:34:09 simple.go:184: Protocol: websocket 2025/09/14 16:34:09
simple.go:185: Timeout: 30s 2025/09/14 16:34:09 client.go:107: url:
ws://localhost:18080 2025/09/14 16:34:09 clien18080108: headers:
map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]] 2025/09/14
16:34:09 client.go:119: url: http://localhost:18080 2025/09/14 16:34:09
client.go:120: headers: map[Connection:[Upgrade]
Sec-Websocket-Accept:[KJKnk4zcJgfqf1ZfLJhSAQkD6ow=]
Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover;
client_no_context_takeover] Upgrade:[websocket]] 2025/09/14 16:34:09
simple.go:209: WebSocket ä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443 2025/09/14 16:34:09
http.go:509: WebSocket ForwardData error: read tcp [::1]:44064->[::1]:18080:
wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 16:34:09 simple.go:204: WebSocket ForwardData error: read tcp
[::1]:44062->[::1]:18080: wsarecv: An existing connection was forcibly closed by
the remote host. 2025/09/14 16:34:09 simple.go:204: WebSocket ForwardData error:
read tcp [::1]:44108->[::1]:18080: wsarecv: An existing connection was forcibly
closed by the remote host. 2025/09/14 16:34:09 simple.go:204: WebSocket
ForwardData error: read tcp [::1]:44102->[::1]:18080: wsarecv: An existing
connection was forcibly closed by the remote host.

```
âœ… ç«¯å£18080å·²æˆåŠŸé‡Šæ”¾ âœ… ç«¯å£10810å·²æˆåŠŸé‡Šæ”¾
18080

###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 16:36:02

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨18080

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ
18080
## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰18080

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :18080`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 9132

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:18080`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 28256

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 3676, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD http://www.baidu.com/ HTTP/1.1

> Host: www.baidu.com18080

> User-Agent: curl/8.12.1

> Accept: _/_

> Proxy-Connection: Keep-Alive

> 18080

- Request completely sent off < HTTP/1.1 200 OK

< Accept-Ranges: bytes 18080 < Cache-Control: private, no-cache, no-store,
proxy-revalidate, no-transform

< Connection: keep-alive

< Content-Length: 277

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:35:52 GMT

< Etag: "575e1f60-115"

< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT

< Pragma: no-cache

< Server: bfe/1.0.8.18

< Tr_id: bfe_11552078580505659851

<

0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 OK Accept-Ranges:
  bytes Cache-Control: private, no-cache, no-store, proxy-revalidate,
  no-transform Connection: keep-alive Content-Length: 277 Content-Type:
  text/html Date: Sun, 14 Sep 2025 08:35:52 GMT Etag: "575e1f60-115"
  Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
  bfe/1.0.8.18 Tr_id: bfe_11552078580505659851

```
### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 12576, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ18080

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.baidu.com:443
  > CONNECT www.baidu.com:443 HTTP/1.1

> Host: www.baidu.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

< HTTP/1.1 200 Connection established

<

- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [308 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [102 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [4771 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* TLSv1.2 (IN), TLS change
  cipher, Change cipher spec (1): { [1 bytes data]

- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server accepted http/1.1
- Server certificate:
- subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science
  Technology Co., Ltd; CN=baidu.com
- start date: Jul 9 07:01:02 2025 GMT
- expire date: Aug 10 07:01:01 2026 GMT
- subjectAltName: host "www.baidu.com" matched cert's "\*.baidu.com"
- issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD / HTTP/1.1

> Host: www.baidu.com18080

> User-Agent: curl/8.12.1

> Accept: _/_

- Request completely sent off < HTTP/1.1 200 OK

< Accept-Ranges: bytes18080

< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform

< Connection: keep-alive

< Content-Length: 277

< Content-Type: text/html 18080 < Date: Sun, 14 Sep 2025 08:35:52 GMT

< Etag: "575e1f60-115"

< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT18080 18080 < Pragma: no-cache

< Server: bfe/1.0.8.18

< Tr_id: bfe_12104553899071472023

<

0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 Connection
  established

HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: private, no-cache, no-store,
proxy-revalidate, no-transform Connection: keep-alive Content-Length: 277
Content-Type: text/html Date: Sun, 14 Sep 2025 08:35:52 GMT Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
bfe/1.0.8.18 Tr_id: bfe_12104553899071472023

```
### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 32772, 22532, 9132, 9132, 28256, 28256, 3676, 3676, 12576, 12576



###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 16:36:02
18080
## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-w18080ket-proxy-golang.exe -mode server -protocol websocket -addr :18080`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 9132

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ18080

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:18080`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 28256

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 3676, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD http://www.baidu.com/ HTTP/1.1

> Host: www.baidu.com

> User-Agent: curl/8.12.1

> Accept: _/_

> Proxy-Connection: Keep-Alive

- Request completely sent off < HTTP/1.1 200 OK

< Accept-Ranges: bytes18080

< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform

< Connection: keep-alive

< Content-Length: 277

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:35:52 GMT

< Etag: "575e1f60-115"

< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT

< Pragma: no-cache

< Server: bfe/1.0.8.18

< Tr_id: bfe_11552078580505659851

<

0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 OK Accept-Ranges:
  bytes Cache-Control: private, no-cache, no-store, proxy-revalidate,
  no-transform Connection: keep-alive Content-Length: 277 Content-Type:
  text/html Date: Sun, 14 Sep 2025 08:35:52 GMT Etag: "575e1f60-115"
  Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
  bfe/1.0.8.18 Tr_id: bfe_11552078580505659851

```
### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 12576, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```

Note: Using embedded CA bundle, for proxies (233263 bytes)

- Host localhost:10810 was resolved.
- IPv6: ::1
- IPv4: 127.0.0.1 % Total % Received % Xferd Average Speed Time Time Time
  Current Dload Upload Total Spent Left Speed

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* Trying [::1]:10810...

- CONNECT tunnel: HTTP/1.1 negotiated
- allocate connect buffer
- Establish HTTP proxy tunnel to www.baidu.com:443
  > CONNECT www.baidu.com:443 HTTP/1.1

> Host: www.baidu.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

< HTTP/1.1 200 Connection established

<

- CONNECT phase completed
- CONNECT tunnel established, response 200
- ALPN: curl offers h2,http/1.1
- TLSv1.3 (OUT), TLS handshake, Client hello (1): } [308 bytes data]
- CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
- CApath: none
- TLSv1.3 (IN), TLS handshake, Server hello (2): { [102 bytes data]
- TLSv1.2 (IN), TLS handshake, Certificate (11): { [4771 bytes data]
- TLSv1.2 (IN), TLS handshake, Server key exchange (12): { [333 bytes data]
- TLSv1.2 (IN), TLS handshake, Server finished (14): { [4 bytes data]
- TLSv1.2 (OUT), TLS handshake, Client key exchange (16): } [70 bytes data]
- TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1): } [1 bytes data]
- TLSv1.2 (OUT), TLS handshake, Finished (20): } [16 bytes data]

  0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0\* TLSv1.2 (IN), TLS change
  cipher, Change cipher spec (1): { [1 bytes data]

- TLSv1.2 (IN), TLS handshake, Finished (20): { [16 bytes data]
- SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
- ALPN: server accepted http/1.1
- Server certificate:
- subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science
  Technology Co., Ltd; CN=baidu.com
- start date: Jul 9 07:01:02 2025 GMT
- expire date: Aug 10 07:01:01 2026 GMT
- subjectAltName: host "www.baidu.com" matched cert's "\*.baidu.com"
- issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
- SSL certificate verify ok.
- Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using
  sha256WithRSAEncryption
- Connected to localhost (::1) port 10810
- using HTTP/1.x
  > HEAD / HTTP/1.1

> Host: www.baidu.com18080

> User-Agent: curl/8.12.1

> Accept: _/_

- Request completely sent off < HTTP/1.1 200 OK

< Accept-Ranges: bytes

< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform

< Connection: keep-alive

< Content-Length: 277

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:35:52 GMT

< Etag: "575e1f60-115"

< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT

< Pragma: no-cache

< Server: bfe/1.0.8.18

< Tr_id: bfe_12104553899071472023

<

0 277 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0

- Connection #0 to host localhost left intact HTTP/1.1 200 Connection
  established

HTTP/1.1 200 OK Accept-Ranges: bytes Cache-Control: private, no-cache, no-store,
proxy-revalidate, no-transform Connection: keep-alive Content-Length: 277
Content-Type: text/html Date: Sun, 14 Sep 2025 08:35:52 GMT Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT Pragma: no-cache Server:
bfe/1.0.8.1818080 Tr_id: bfe_12104553899071472023

````
### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 32772, 22532, 9132, 9132, 28256, 28256, 3676, 3676, 12576, 12576

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹...
âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹...
âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...
âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```18080
2025/09/14 16:36:05 main.go:147: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :18080
2025/09/14 16:36:05 server.go:83: [WEBSOCKET-SERVER] Server sta18080successfully, listening on :18080
2025/09/14 16:36:05 server.go:84: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 16:36:05 server.go:86: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 16:36:05 server.go:87: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 16:36:05 main.go:221: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 16:36:07 server.go:102: url /
2025/09/14 16:36:07 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[hrMV8+C5werp2uEKykEEQg==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.184.104.179] X-Proxy-Target-Port:[39864]]
2025/09/14 16:36:07 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:44995 at 2025-09-14 16:36:07
2025/09/14 16:36:07 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:44995
2025/09/14 16:36:07 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.184.104.179', targetPort: 39864
2025/09/14 16:36:07 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:36:07 server.go:131: [WEBSOCKET-AUTH] Authentication successf18080r user '' from [::1]:44995
2025/09/14 16:36:07 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.184.104.179:39864 from [::1]:44995
2025/09/14 16:36:07 server.go:239: [WEBSOCKET-UPSTREAM] Using direc18080nection for target 127.184.104.179:39864 (timeout: 30s)
2025/09/14 16:36:07 server.go:244: [WEBSOCKET-UPSTREAM] Di18080connection established for target 127.184.104.179:39864
2025/09/14 16:36:07 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 16:36:07 server.go:102: url /
2025/09/14 16:36:07 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[+ez5hdop3RoR1MJszMXyFQ==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 16:36:07 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:44997 at 2025-09-14 16:36:07
2025/09/14 16:36:07 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:44997
2025/09/14 16:36:07 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 16:36:07 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:36:07 server.go:131: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:44997
2025/09/14 16:36:07 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:44997
2025/09/14 16:36:07 server.go:239: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 16:36:07 server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 16:36:07 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 16:36:09 server.go:102: url /
2025/09/14 16:36:09 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[uyYddEz1GIVucQe6vRA8Ng==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.184.104.179] X-Proxy-Target-Port:[39864]]
2025/09/14 16:36:09 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:45038 at 2025-09-14 16:36:09
2025/09/14 16:36:09 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:45038
2025/09/14 16:36:09 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.184.104.179', targetPort: 39864
2025/09/14 16:36:09 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:36:09 server.go:131: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:45038
2025/09/14 16:36:09 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.184.104.179:39864 from [::1]:45038
2025/09/14 16:36:09 server.go:239: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.184.104.179:39864 (timeout: 30s)
2025/09/14 16:36:09 server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.184.104.179:39864
2025/09/14 16:36:09 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 16:36:09 server.go:102: url /
2025/09/14 16:36:09 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[grbX978Ci+IknPDtscu+Vw==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 16:36:09 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:45041 at 2025-09-14 16:36:09
2025/09/14 16:36:09 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:45041
2025/09/14 16:36:09 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 16:36:09 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:36:09 server.go:131: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:45041
2025/09/14 16:36:09 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:45041
2025/09/14 16:36:09 server.go:239: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 16:36:09 server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 16:36:09 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
````

### http æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 16:36:06 main.go:519: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 16:36:06 main.go:563: dohalpn: []
2025/09/14 16:36:06 main.go:565: hostname: 0.0.0.0
2025/09/14 16:36:06 main.go:567: port: 10810
2025/09/14 16:36:06 main.go:569: server_cert: 18080
2025/09/14 16:36:06 main.go:571: server_key:
2025/09/14 16:36:06 main.go:573: username: 18080
2025/09/14 16:36:06 main.go:575: password:
2025/09/14 16:36:06 main.go:577: dohurl: []
2025/09/14 16:36:06 main.go:579: dohip: []
2025/09/14 16:36:06 main.go:580: upstream-type: websocket
2025/09/14 16:36:06 main.go:581: upstream-address: ws://localhost:18080
2025/09/14 16:36:06 main.go:582: upstream-username:
2025/09/14 16:36:06 main.go:583: upstream-password:
2025/09/14 16:36:06 main.go:640: WebSocketä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 16:36:06 main.go:898: {
  "hostname": "",
  "port": 0,
  "server_cert": "",18080
  "server_key": "",
  "username": "",
  "password": "",18080
  "doh": null,18080
  "upstreams": {
    "websocket_upstream": {
      "type": "websocket",
      "http_proxy": "ws://localhost:18080",
      "https_proxy": "ws://localhost:18080",
      "bypass_list": null,
      "ws_proxy": "ws://localhost:18080",
      "ws_username": "",
      "ws_password": "",
      "http_username": "",
      "http_password": "",
      "socks5_proxy": "ws://localhost:18080",
      "socks5_username": "",
      "socks5_password": ""
    }
  },
  "rules": [
    {
      "filter": "websocket_filter",
      "upstream": "websocket_upstream"
    }
  ],
  "filters": {
    "websocket_filter": {
      "patterns": [
        "*"
      ]
    }
  }
}
2025/09/14 16:36:06 simple.go:31: Proxy server started on port [::]:10810
2025/09/14 16:36:06 http.go:388: Random IP: 127.184.104.179
2025180804 16:36:06 http.go:406: Random integer: 39864
2025/09/14 16:36:06 http.go:358: Proxy server started on port 127.184.104.179:39864
2025/09/14 16:36:07 simple.go:57: remote addr: [::1]:44994
2025/09/14 16:36:07 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 16:36:07 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:36:07 simple.go:117: address:www.baidu.com:80
2025/09/14 16:36:07 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.184.104.179:39864
2025/09/14 16:36:07 main.go:829: ProxySelector 127.184.104.179:39864
2025/09/14 16:36:07 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080
2025/09/14 16:36:07 simple.go:179: WebSocket Config Details:
2025/09/14 16:36:07 simple.go:180: host, portNum 127.184.104.179 39864
2025/09/14 16:36:07 simple.go:181:   Username:
2025/09/14 16:36:07 simple.go:182:   Password:
2025/09/14 16:36:07 simple.go:183:   ServerAddr: ws://localhost:18080
2025/09/14 16:36:07 simple.go:184:   Protocol: websocket
2025/09/14 16:36:07 simple.go:185:   Timeout: 30s
2025/09/14 16:36:07 client.go:107: url: ws://localhost:18080
2025/09/14 16:36:07 client.go:108: headers: map[X-Proxy-Target-Host:[127.184.104.179] X-Proxy-Target-Port:[39864]]
2025/09/14 16:36:07 client.go:119: url: http://localhost:18080
2025/09/14 16:36:07 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[JVVi0RuP3caLBV9SOY4mP2xzDqg=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 16:36:07 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.184.104.179:39864
2025/09/14 16:36:07 simple.go:248: clienthost: ::1
2025/09/14 16:36:07 simple.go:249: clientport: 44994
2025/09/14 16:36:07 simple.go:278: simple Handle header:
2025/09/14 16:36:07 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 16:36:07 simple.go:283: GET / HTTP/1.1
2025/09/14 16:36:07 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 16:36:07 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 16:36:07 http.go:90: method: GET
2025/09/14 16:36:07 http.go:91: url: /
2025/09/14 16:36:07 http.go:92: host: www.baidu.com
2025/09/14 16:36:07 http.go:93: proxyHandler header:
2025/09/14 16:36:07 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:07 http.go:121: clientport: 44996
2025/09/14 16:36:07 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 16:36:07 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.184.104.179:39864;host=www.baidu.com;proto=http
2025/09/14 16:36:07 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 16:36:07 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.184.104.179:39864;host=www.baidu.com;proto=http
2025/09/14 16:36:07 http.go:137: forwardedByList: [{[::1]:10810} {127.184.104.179:39864}]
2025/09/14 16:36:07 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:36:07 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:36:07 main.go:829: ProxySelector www.baidu.com
2025/09/14 16:36:07 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080
2025/09/14 16:36:07 http.go:259: ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080
2025/09/14 16:36:07 http.go:268: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:18080
2025/09/14 16:36:07 http.go:278: ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080
2025/09/14 16:36:07 http.go:280: network,addr tcp www.baidu.com:80
2025/09/14 16:36:07 http.go:482: WebSocket Config Details:
2025/09/14 16:36:07 http.go:483: host, portNum www.baidu.com 80
2025/09/14 16:36:07 http.go:484:   Username:
2025/09/14 16:36:07 http.go:485:   Password:
2025/09/14 16:36:07 http.go:486:   ServerAddr: ws://localhost:18080
2025/09/14 16:36:07 http.go:487:   Protocol: websocket
2025/09/14 16:36:07 http.go:488:   Timeout: 30s
2025/09/14 16:36:07 http.go:492: host, portNum www.baidu.com 80
2025/09/14 16:36:07 client.go:107: url: ws://localhost:18080
2025/09/14 16:36:07 client.go:108: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 16:36:07 client.go:119: url: http://localhost:18080
2025/09/14 16:36:07 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[MnUOjBFKKggvEycdY9XfGv7/MNI=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
[GIN] 2025/09/14 - 16:36:07 | 200 |     73.5373ms |       127.0.0.1 | GET      "/"
2025/09/14 16:36:09 simple.go:57: remote addr: [::1]:45037
2025/09/14 16:36:09 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 16:36:09 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:36:09 simple.go:117: address:www.baidu.com:80
2025/09/14 16:36:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.184.104.179:39864
2025/09/14 16:36:09 main.go:829: ProxySelector 127.184.104.179:39864
2025/09/14 16:36:09 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080
2025/09/14 16:36:09 simple.go:179: WebSocket Config Details:
2025/09/14 16:36:09 simple.go:180: host, portNum 127.184.104.179 39864
2025/09/14 16:36:09 simple.go:181:   Username:
2025/09/14 16:36:09 simple.go:182:   Password:
2025/09/14 16:36:09 simple.go:183:   ServerAddr: ws://localhost:18080
2025/09/14 16:36:09 simple.go:184:   Protocol: websocket
2025/09/14 16:36:09 simple.go:185:   Timeout: 30s
2025/09/14 16:36:09 client.go:107: url: ws://localhost:18080
2025/09/14 16:36:09 client.go:108: headers: map[X-Proxy-Target-Host:[127.184.104.179] X-Proxy-Target-Port:[39864]]
2025/09/14 16:36:09 client.go:119: url: http://localhost:18080
2025/09/14 16:36:09 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[cOOLhHC6zcqvwow8dpWUpkYIZm8=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 16:36:09 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.184.104.179:39864
2025/09/14 16:36:09 simple.go:248: clienthost: ::1
2025/09/14 16:36:09 simple.go:249: clientport: 45037
2025/09/14 16:36:09 simple.go:278: simple Handle header:
2025/09/14 16:36:09 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 16:36:09 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:36:09 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 16:36:09 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:36:09 http.go:90: method: HEAD
2025/09/14 16:36:09 http.go:91: url: /
2025/09/14 16:36:09 http.go:92: host: www.baidu.com
2025/09/14 16:36:09 http.go:93: proxyHandler header:
2025/09/14 16:36:09 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:09 http.go:121: clientport: 45039
2025/09/14 16:36:09 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:36:09 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.184.104.179:39864;host=www.baidu.com;proto=http
2025/09/14 16:36:09 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:36:09 http.go:132: proxyHandler Accept : */*
2025/09/14 16:36:09 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.184.104.179:39864;host=www.baidu.com;proto=http
2025/09/14 16:36:09 http.go:137: forwardedByList: [{[::1]:10810} {127.184.104.179:39864}]
2025/09/14 16:36:09 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:36:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:36:09 main.go:829: ProxySelector www.baidu.com
2025/09/14 16:36:09 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080
2025/09/14 16:36:09 http.go:259: ä½¿ç”¨ä»£ç†ï¼šws://localhost:18080
2025/09/14 16:36:09 http.go:268: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:18080
[GIN] 2025/09/14 - 16:36:09 | 200 |     36.4318ms |       127.0.0.1 | HEAD     "/"
2025/09/14 16:36:09 simple.go:57: remote addr: [::1]:45040
2025/09/14 16:36:09 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 16:36:09 simple.go:117: address:www.baidu.com:443
2025/09/14 16:36:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 16:36:09 main.go:829: ProxySelector www.baidu.com:443
2025/09/14 16:36:09 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:18080
2025/09/14 16:36:09 simple.go:179: WebSocket Config Details:
2025/09/14 16:36:09 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 16:36:09 simple.go:181:   Username:
2025/09/14 16:36:09 simple.go:182:   Password:
2025/09/14 16:36:09 simple.go:183:   ServerAddr: ws://localhost:18080
2025/09/14 16:36:09 simple.go:184:   Protocol: websocket
2025/09/14 16:36:09 simple.go:185:   Timeout: 30s
2025/09/14 16:36:09 client.go:107: url: ws://localhost:18080
2025/09/14 16:36:09 client.go:108: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 16:36:09 client.go:119: url: http://localhost:18080
2025/09/14 16:36:09 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[Fp6R0OIp+qtE2x0luLr9uLRMrzE=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 16:36:09 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
2025/09/14 16:36:09 http.go:509: WebSocket ForwardData error: read tcp [::1]:44997->[::1]:18080: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 16:36:09 simple.go:204: WebSocket ForwardData error: read tcp [::1]:44995->[::1]:18080: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 16:36:09 simple.go:204: WebSocket ForwardData error: read tcp [::1]:45038->[::1]:18080: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 16:36:09 simple.go:204: WebSocket ForwardData error: read tcp [::1]:45041->[::1]:18080: wsarecv: An existing connection was forcibly closed by the remote host.
```

âœ… ç«¯å£ 18080 å·²æˆåŠŸé‡Šæ”¾ âœ… ç«¯å£ 10810 å·²æˆåŠŸé‡Šæ”¾

### 

# DoH HTTP ä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoH æ¨¡å¼ï¼‰... æ‰§è¡Œå‘½ä»¤:
`./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 18080 ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ æµ‹è¯• 1: é€šè¿‡ä»£ç†è®¿é—® HTTP ç½‘ç«™
(baidu.com) âœ… æµ‹è¯• 1 æˆåŠŸ

æµ‹è¯• 2: é€šè¿‡ä»£ç†è®¿é—® HTTP ç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘) âœ… æµ‹è¯• 2 æˆåŠŸ

æµ‹è¯• 3: é€šè¿‡ä»£ç†è®¿é—® HTTPS ç½‘ç«™ (baidu.com) âœ… æµ‹è¯• 3 æˆåŠŸ

### 

# DoH HTTP ä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoH æ¨¡å¼ï¼‰... æ‰§è¡Œå‘½ä»¤:
`./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 18080 ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸ æµ‹è¯• 1: é€šè¿‡ä»£ç†è®¿é—® HTTP ç½‘ç«™
(baidu.com) âœ… æµ‹è¯• 1 æˆåŠŸ

æµ‹è¯• 2: é€šè¿‡ä»£ç†è®¿é—® HTTP ç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘) âœ… æµ‹è¯• 2 æˆåŠŸ

æµ‹è¯• 3: é€šè¿‡ä»£ç†è®¿é—® HTTPS ç½‘ç«™ (baidu.com) âœ… æµ‹è¯• 3 æˆåŠŸ

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 16:36:14 main.go:519: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 16:36:14 main.go:563: dohalpn: [h2, h3]
2025/09/14 16:36:14 main.go:565: hostname: 0.0.0.0
2025/09/14 16:36:14 main.go:567: port: 18080
2025/09/14 16:36:14 main.go:569: server_cert:
2025/09/14 16:36:14 main.go:571: server_key:
2025/09/14 16:36:14 main.go:573: username:
2025/09/14 16:36:14 main.go:575: password:
2025/09/14 16:36:14 main.go:577: dohurl: [https://dns.alidns.com/dns-query, https://dns.alidns.com/dns-query]
2025/09/14 16:36:14 main.go:579: dohip: [223.5.5.5, 223.6.6.6]
2025/09/14 16:36:14 main.go:580: upstream-type:
2025/09/14 16:36:14 main.go:581: upstream-address:
2025/09/14 16:36:14 main.go:582: upstream-username:
2025/09/14 16:36:14 main.go:583: upstream-password:
2025/09/14 16:36:14 main.go:898: null
2025/09/14 16:36:14 simple.go:31: Proxy server started on port [::]:18080
2025/09/14 16:36:14 http.go:388: Random IP: 127.45.250.78
2025/09/14 16:36:14 http.go:406: Random integer: 56813
2025/09/14 16:36:14 http.go:358: Proxy server started on port 127.45.250.78:56813
2025/09/14 16:36:16 simple.go:57: remote addr: [::1]:45108
2025/09/14 16:36:16 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 16:36:16 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:36:16 simple.go:117: address:www.baidu.com:80
2025/09/14 16:36:16 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.45.250.78:56813
2025/09/14 16:36:16 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.45.250.78:56813
2025/09/14 16:36:16 simple.go:248: clienthost: ::1
2025/09/14 16:36:16 simple.go:249: clientport: 45108
2025/09/14 16:36:16 simple.go:278: simple Handle header:
2025/09/14 16:36:16 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:16 simple.go:283: GET / HTTP/1.1
2025/09/14 16:36:16 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:16 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 16:36:16 http.go:90: method: GET
2025/09/14 16:36:16 http.go:91: url: /
2025/09/14 16:36:16 http.go:92: host: www.baidu.com
2025/09/14 16:36:16 http.go:93: proxyHandler header:
2025/09/14 16:36:16 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:16 http.go:121: clientport: 45109
2025/09/14 16:36:16 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.45.250.78:56813;host=www.baidu.com;proto=http
2025/09/14 16:36:16 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 16:36:16 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 16:36:16 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.45.250.78:56813;host=www.baidu.com;proto=http
2025/09/14 16:36:16 http.go:137: forwardedByList: [{[::1]:18080} {127.45.250.78:56813}]
2025/09/14 16:36:16 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:36:16 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:36:16 options.go:186: hostname www.baidu.com no ip found
2025/09/14 16:36:16 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:16 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:16 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:16 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:36:16 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:36:16 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:36:16 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:36:16 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:36:16 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:36:17 doh.go:91: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5]
2025/09/14 16:36:17 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=240e:e9:6002:1ac:0:ff:b07e:36c5
[GIN] 2025/09/14 - 16:36:17 | 200 |    130.8531ms |       127.0.0.1 | GET      "/"
2025/09/14 16:36:17 simple.go:57: remote addr: [::1]:45113
2025/09/14 16:36:17 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 16:36:17 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:36:17 simple.go:117: address:www.baidu.com:80
2025/09/14 16:36:17 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.45.250.78:56813
2025/09/14 16:36:17 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.45.250.78:56813
2025/09/14 16:36:17 simple.go:248: clienthost: ::1
2025/09/14 16:36:17 simple.go:249: clientport: 45113
2025/09/14 16:36:17 simple.go:278: simple Handle header:
2025/09/14 16:36:17 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:17 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:36:17 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:17 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:36:17 http.go:90: method: HEAD
2025/09/14 16:36:17 http.go:91: url: /
2025/09/14 16:36:17 http.go:92: host: www.baidu.com
2025/09/14 16:36:17 http.go:93: proxyHandler header:
2025/09/14 16:36:17 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:17 http.go:121: clientport: 45114
2025/09/14 16:36:17 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.45.250.78:56813;host=www.baidu.com;proto=http
2025/09/14 16:36:17 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:36:17 http.go:132: proxyHandler Accept : */*
2025/09/14 16:36:17 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:36:17 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.45.250.78:56813;host=www.baidu.com;proto=http
2025/09/14 16:36:17 http.go:137: forwardedByList: [{[::1]:18080} {127.45.250.78:56813}]
2025/09/14 16:36:17 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:36:17 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:36:17 options.go:186: hostname www.baidu.com no ip found
2025/09/14 16:36:17 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:36:17 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:36:17 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:36:17 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:36:17 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:36:17 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:36:17 doh.go:91: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5]
2025/09/14 16:36:17 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=240e:e9:6002:1ac:0:ff:b07e:36c5
[GIN] 2025/09/14 - 16:36:17 | 200 |     101.456ms |       127.0.0.1 | HEAD     "/"
2025/09/14 16:36:17 simple.go:57: remote addr: [::1]:45118
2025/09/14 16:36:17 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 16:36:17 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 16:36:17 simple.go:117: address:www.so.com:80
2025/09/14 16:36:17 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.45.250.78:56813
2025/09/14 16:36:17 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.45.250.78:56813
2025/09/14 16:36:17 simple.go:248: clienthost: ::1
2025/09/14 16:36:17 simple.go:249: clientport: 45118
2025/09/14 16:36:17 simple.go:278: simple Handle header:
2025/09/14 16:36:17 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:36:17 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:36:17 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:36:17 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:36:17 http.go:90: method: HEAD
2025/09/14 16:36:17 http.go:91: url: /
2025/09/14 16:36:17 http.go:92: host: www.so.com
2025/09/14 16:36:17 http.go:93: proxyHandler header:
2025/09/14 16:36:17 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:17 http.go:121: clientport: 45119
2025/09/14 16:36:17 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.45.250.78:56813;host=www.so.com;proto=http
2025/09/14 16:36:17 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:36:17 http.go:132: proxyHandler Accept : */*
2025/09/14 16:36:17 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:36:17 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.45.250.78:56813;host=www.so.com;proto=http
2025/09/14 16:36:17 http.go:137: forwardedByList: [{[::1]:18080} {127.45.250.78:56813}]
2025/09/14 16:36:17 http.go:155: targetUrl: http://www.so.com/
2025/09/14 16:36:17 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
2025/09/14 16:36:17 options.go:186: hostname www.so.com no ip found
2025/09/14 16:36:17 doh3.go:15: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh3.go:27: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh3.go:27: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:54703 223.6.6.6:443
2025/09/14 16:36:17 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:54702 223.6.6.6:443
2025/09/14 16:36:17 doh3.go:80: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 16:36:17 options.go:240: success connect to address=www.so.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.163.237.15
[GIN] 2025/09/14 - 16:36:17 | 302 |     82.0658ms |       127.0.0.1 | HEAD     "/"
2025/09/14 16:36:17 simple.go:57: remote addr: [::1]:45121
2025/09/14 16:36:17 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 16:36:17 simple.go:117: address:www.so.com:443
2025/09/14 16:36:17 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 16:36:17 options.go:98: hostname www.so.com no ip found
2025/09/14 16:36:17 options.go:186: hostname www.so.com no ip found
2025/09/14 16:36:17 doh3.go:15: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh3.go:27: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh3.go:27: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:54705 223.6.6.6:443
2025/09/14 16:36:17 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:54704 223.6.6.6:443
2025/09/14 16:36:17 doh3.go:80: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 16:36:17 options.go:240: success connect to address=www.so.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.163.237.15
2025/09/14 16:36:17 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 16:36:17 simple.go:57: remote addr: [::1]:45123
2025/09/14 16:36:17 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 16:36:17 simple.go:117: address:www.baidu.com:443
2025/09/14 16:36:17 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 16:36:17 options.go:98: hostname www.baidu.com no ip found
2025/09/14 16:36:17 options.go:186: hostname www.baidu.com no ip found
2025/09/14 16:36:17 doh3.go:15: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh3.go:27: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 doh3.go:27: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:36:17 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:54706 223.6.6.6:443
2025/09/14 16:36:17 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:54707 223.6.6.6:443
2025/09/14 16:36:17 doh3.go:80: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69]
2025/09/14 16:36:17 options.go:240: success connect to address=www.baidu.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=240e:e9:6002:1fd:0:ff:b0e1:fe69
2025/09/14 16:36:17 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### 

# HTTP ä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´

2025-09-14 16:36:20

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹ PID: 32440

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨... âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯• HTTP ä»£ç†åŠŸèƒ½

### æµ‹è¯• 1: åŸºæœ¬ HTTP ä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curl æµ‹è¯• 1 è¿›ç¨‹ PID: 15852

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1

> Host: www.baidu.com

> User-Agent: curl/8.12.1

> Accept: */*

> Proxy-Connection: Keep-Alive

>

* Request completely sent off
< HTTP/1.1 302 Found

< Content-Type: text/plain; charset=utf-8

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Location: https://www.baidu.com/error.html

< Server: bfe

<


  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 302 Found
Content-Type: text/plain; charset=utf-8
Date: Sun, 14 Sep 2025 08:36:09 GMT
Location: https://www.baidu.com/error.html
Server: bfe
```

### æµ‹è¯• 2: HTTP ä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:18080 -L`

ðŸ“‹ Curl æµ‹è¯• 2 è¿›ç¨‹ PID: 18732

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1

> Host: www.so.com

> User-Agent: curl/8.12.1

> Accept: */*

> Proxy-Connection: Keep-Alive

>

* Request completely sent off
< HTTP/1.1 302 Found

< Connection: keep-alive

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Location: https://www.so.com/

< Server: openresty

< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

* Ignoring the response-body
<


  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1

> Host: www.so.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

>

< HTTP/1.1 200 Connection established

<

* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1

> Host: www.so.com

> User-Agent: curl/8.12.1

> Accept: */*

>

* Request completely sent off
< HTTP/1.1 200 OK

< Server: openresty

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Content-Type: text/html; charset=UTF-8

< Connection: keep-alive

< Vary: Accept-Encoding

< Set-Cookie: _S=rr4uq1q9b48mfkog0ta85hnp71; expires=Sun, 14-Sep-2025 08:46:09 GMT; Max-Age=600; path=/

< Expires: Thu, 19 Nov 1981 08:52:00 GMT

< Cache-Control: no-store, no-cache, must-revalidate

< Pragma: no-cache

< php-waf-rep: -

< Set-Cookie: QiHooGUID=8C45361319A2FACBEEACF15FA9CE86BC.1757838969776; Max-Age=63072000; Domain=so.com; Path=/

<


  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:36:09 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 08:36:09 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=rr4uq1q9b48mfkog0ta85hnp71; expires=Sun, 14-Sep-2025 08:46:09 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=8C45361319A2FACBEEACF15FA9CE86BC.1757838969776; Max-Age=63072000; Domain=so.com; Path=/
```

### æµ‹è¯• 3: HTTPS ä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curl æµ‹è¯• 3 è¿›ç¨‹ PID: 32840

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1

> Host: www.baidu.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

>

< HTTP/1.1 200 Connection established

<

* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1

> Host: www.baidu.com

> User-Agent: curl/8.12.1

> Accept: */*

>

* Request completely sent off
< HTTP/1.1 200 OK

< Accept-Ranges: bytes

< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform

< Connection: keep-alive

< Content-Length: 277

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Etag: "575e1f60-115"

< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT

< Pragma: no-cache

< Server: bfe/1.0.8.18

< Tr_id: bfe_9275929367889434610

<


  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:36:09 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9275929367889434610
```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹ PID è®°å½•

æ‰€æœ‰è¿›ç¨‹ PID: 11568, 32440, 32440, 15852, 15852, 18732, 18732, 32840, 32840

### 

# HTTP ä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´

2025-09-14 16:36:20

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨... âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹ PID: 32440

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨... âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯• HTTP ä»£ç†åŠŸèƒ½

### æµ‹è¯• 1: åŸºæœ¬ HTTP ä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curl æµ‹è¯• 1 è¿›ç¨‹ PID: 15852

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1

> Host: www.baidu.com

> User-Agent: curl/8.12.1

> Accept: */*

> Proxy-Connection: Keep-Alive

>

* Request completely sent off
< HTTP/1.1 302 Found

< Content-Type: text/plain; charset=utf-8

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Location: https://www.baidu.com/error.html

< Server: bfe

<


  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 302 Found
Content-Type: text/plain; charset=utf-8
Date: Sun, 14 Sep 2025 08:36:09 GMT
Location: https://www.baidu.com/error.html
Server: bfe
```

### æµ‹è¯• 2: HTTP ä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:18080 -L`

ðŸ“‹ Curl æµ‹è¯• 2 è¿›ç¨‹ PID: 18732

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1

> Host: www.so.com

> User-Agent: curl/8.12.1

> Accept: */*

> Proxy-Connection: Keep-Alive

>

* Request completely sent off
< HTTP/1.1 302 Found

< Connection: keep-alive

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Location: https://www.so.com/

< Server: openresty

< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

* Ignoring the response-body
<


  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1

> Host: www.so.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

>

< HTTP/1.1 200 Connection established

<

* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1

> Host: www.so.com

> User-Agent: curl/8.12.1

> Accept: */*

>

* Request completely sent off
< HTTP/1.1 200 OK

< Server: openresty

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Content-Type: text/html; charset=UTF-8

< Connection: keep-alive

< Vary: Accept-Encoding

< Set-Cookie: _S=rr4uq1q9b48mfkog0ta85hnp71; expires=Sun, 14-Sep-2025 08:46:09 GMT; Max-Age=600; path=/

< Expires: Thu, 19 Nov 1981 08:52:00 GMT

< Cache-Control: no-store, no-cache, must-revalidate

< Pragma: no-cache

< php-waf-rep: -

< Set-Cookie: QiHooGUID=8C45361319A2FACBEEACF15FA9CE86BC.1757838969776; Max-Age=63072000; Domain=so.com; Path=/

<


  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:36:09 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 08:36:09 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=rr4uq1q9b48mfkog0ta85hnp71; expires=Sun, 14-Sep-2025 08:46:09 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=8C45361319A2FACBEEACF15FA9CE86BC.1757838969776; Max-Age=63072000; Domain=so.com; Path=/
```

### æµ‹è¯• 3: HTTPS ä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curl æµ‹è¯• 3 è¿›ç¨‹ PID: 32840

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:

```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1

> Host: www.baidu.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

>

< HTTP/1.1 200 Connection established

<

* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1

> Host: www.baidu.com

> User-Agent: curl/8.12.1

> Accept: */*

>

* Request completely sent off
< HTTP/1.1 200 OK

< Accept-Ranges: bytes

< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform

< Connection: keep-alive

< Content-Length: 277

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Etag: "575e1f60-115"

< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT

< Pragma: no-cache

< Server: bfe/1.0.8.18

< Tr_id: bfe_9275929367889434610

<


  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:36:09 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9275929367889434610
```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹ PID è®°å½•

æ‰€æœ‰è¿›ç¨‹ PID: 11568, 32440, 32440, 15852, 15852, 18732, 18732, 32840, 32840

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰ curl æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹... âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 16:36:22 main.go:519: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 16:36:22 main.go:563: dohalpn: []
2025/09/14 16:36:22 main.go:565: hostname: 0.0.0.0
2025/09/14 16:36:22 main.go:567: port: 18080
2025/09/14 16:36:22 main.go:569: server_cert:
2025/09/14 16:36:22 main.go:571: server_key:
2025/09/14 16:36:22 main.go:573: username:
2025/09/14 16:36:22 main.go:575: password:
2025/09/14 16:36:22 main.go:577: dohurl: []
2025/09/14 16:36:22 main.go:579: dohip: []
2025/09/14 16:36:22 main.go:580: upstream-type:
2025/09/14 16:36:22 main.go:581: upstream-address:
2025/09/14 16:36:22 main.go:582: upstream-username:
2025/09/14 16:36:22 main.go:583: upstream-password:
2025/09/14 16:36:22 main.go:898: null
2025/09/14 16:36:22 simple.go:31: Proxy server started on port [::]:18080
2025/09/14 16:36:22 http.go:388: Random IP: 127.222.18.66
2025/09/14 16:36:22 http.go:406: Random integer: 15182
2025/09/14 16:36:22 http.go:358: Proxy server started on port 127.222.18.66:15182
2025/09/14 16:36:23 simple.go:57: remote addr: [::1]:45131
2025/09/14 16:36:23 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 16:36:23 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:36:23 simple.go:117: address:www.baidu.com:80
2025/09/14 16:36:23 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.222.18.66:15182
2025/09/14 16:36:23 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.222.18.66:15182
2025/09/14 16:36:23 simple.go:248: clienthost: ::1
2025/09/14 16:36:23 simple.go:249: clientport: 45131
2025/09/14 16:36:23 simple.go:278: simple Handle header:
2025/09/14 16:36:23 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:23 simple.go:283: GET / HTTP/1.1
2025/09/14 16:36:23 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:23 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 16:36:23 http.go:90: method: GET
2025/09/14 16:36:23 http.go:91: url: /
2025/09/14 16:36:23 http.go:92: host: www.baidu.com
2025/09/14 16:36:23 http.go:93: proxyHandler header:
2025/09/14 16:36:23 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:23 http.go:121: clientport: 45132
2025/09/14 16:36:23 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 16:36:23 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 16:36:23 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.222.18.66:15182;host=www.baidu.com;proto=http
2025/09/14 16:36:23 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.222.18.66:15182;host=www.baidu.com;proto=http
2025/09/14 16:36:23 http.go:137: forwardedByList: [{[::1]:18080} {127.222.18.66:15182}]
2025/09/14 16:36:23 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:36:23 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 16:36:23 | 200 |     63.6082ms |       127.0.0.1 | GET      "/"
2025/09/14 16:36:25 simple.go:57: remote addr: [::1]:45161
2025/09/14 16:36:25 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 16:36:25 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:36:25 simple.go:117: address:www.baidu.com:80
2025/09/14 16:36:25 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.222.18.66:15182
2025/09/14 16:36:25 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.222.18.66:15182
2025/09/14 16:36:25 simple.go:248: clienthost: ::1
2025/09/14 16:36:25 simple.go:249: clientport: 45161
2025/09/14 16:36:25 simple.go:278: simple Handle header:
2025/09/14 16:36:25 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:25 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:36:25 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:36:25 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:36:25 http.go:90: method: HEAD
2025/09/14 16:36:25 http.go:91: url: /
2025/09/14 16:36:25 http.go:92: host: www.baidu.com
2025/09/14 16:36:25 http.go:93: proxyHandler header:
2025/09/14 16:36:25 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:25 http.go:121: clientport: 45162
2025/09/14 16:36:25 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.222.18.66:15182;host=www.baidu.com;proto=http
2025/09/14 16:36:25 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:36:25 http.go:132: proxyHandler Accept : */*
2025/09/14 16:36:25 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:36:25 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.222.18.66:15182;host=www.baidu.com;proto=http
2025/09/14 16:36:25 http.go:137: forwardedByList: [{[::1]:18080} {127.222.18.66:15182}]
2025/09/14 16:36:25 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:36:25 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 16:36:26 | 302 |    1.0695431s |       127.0.0.1 | HEAD     "/"
2025/09/14 16:36:26 simple.go:57: remote addr: [::1]:45163
2025/09/14 16:36:26 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 16:36:26 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 16:36:26 simple.go:117: address:www.so.com:80
2025/09/14 16:36:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.222.18.66:15182
2025/09/14 16:36:26 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.222.18.66:15182
2025/09/14 16:36:26 simple.go:248: clienthost: ::1
2025/09/14 16:36:26 simple.go:249: clientport: 45163
2025/09/14 16:36:26 simple.go:278: simple Handle header:
2025/09/14 16:36:26 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:36:26 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:36:26 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:36:26 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:36:26 http.go:90: method: HEAD
2025/09/14 16:36:26 http.go:91: url: /
2025/09/14 16:36:26 http.go:92: host: www.so.com
2025/09/14 16:36:26 http.go:93: proxyHandler header:
2025/09/14 16:36:26 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:36:26 http.go:121: clientport: 45164
2025/09/14 16:36:26 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:36:26 http.go:132: proxyHandler Accept : */*
2025/09/14 16:36:26 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:36:26 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.222.18.66:15182;host=www.so.com;proto=http
2025/09/14 16:36:26 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.222.18.66:15182;host=www.so.com;proto=http
2025/09/14 16:36:26 http.go:137: forwardedByList: [{[::1]:18080} {127.222.18.66:15182}]
2025/09/14 16:36:26 http.go:155: targetUrl: http://www.so.com/
2025/09/14 16:36:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 16:36:26 | 302 |     57.3392ms |       127.0.0.1 | HEAD     "/"
2025/09/14 16:36:26 simple.go:57: remote addr: [::1]:45172
2025/09/14 16:36:26 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 16:36:26 simple.go:117: address:www.so.com:443
2025/09/14 16:36:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 16:36:26 options.go:98: hostname www.so.com no ip found
2025/09/14 16:36:26 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 16:36:26 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 16:36:26 simple.go:57: remote addr: [::1]:45177
2025/09/14 16:36:26 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 16:36:26 simple.go:117: address:www.baidu.com:443
2025/09/14 16:36:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 16:36:26 options.go:98: hostname www.baidu.com no ip found
2025/09/14 16:36:26 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 16:36:26 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1

> Host: www.baidu.com

> User-Agent: curl/8.12.1

> Accept: */*

> Proxy-Connection: Keep-Alive

>

* Request completely sent off
< HTTP/1.1 302 Found

< Content-Type: text/plain; charset=utf-8

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Location: https://www.baidu.com/error.html

< Server: bfe

<


  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 302 Found
Content-Type: text/plain; charset=utf-8
Date: Sun, 14 Sep 2025 08:36:09 GMT
Location: https://www.baidu.com/error.html
Server: bfe
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1

> Host: www.so.com

> User-Agent: curl/8.12.1

> Accept: */*

> Proxy-Connection: Keep-Alive

>

* Request completely sent off
< HTTP/1.1 302 Found

< Connection: keep-alive

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Location: https://www.so.com/

< Server: openresty

< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

* Ignoring the response-body
<


  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1

> Host: www.so.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

>

< HTTP/1.1 200 Connection established

<

* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1

> Host: www.so.com

> User-Agent: curl/8.12.1

> Accept: */*

>

* Request completely sent off
< HTTP/1.1 200 OK

< Server: openresty

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Content-Type: text/html; charset=UTF-8

< Connection: keep-alive

< Vary: Accept-Encoding

< Set-Cookie: _S=rr4uq1q9b48mfkog0ta85hnp71; expires=Sun, 14-Sep-2025 08:46:09 GMT; Max-Age=600; path=/

< Expires: Thu, 19 Nov 1981 08:52:00 GMT

< Cache-Control: no-store, no-cache, must-revalidate

< Pragma: no-cache

< php-waf-rep: -

< Set-Cookie: QiHooGUID=8C45361319A2FACBEEACF15FA9CE86BC.1757838969776; Max-Age=63072000; Domain=so.com; Path=/

<


  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:36:09 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 08:36:09 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=rr4uq1q9b48mfkog0ta85hnp71; expires=Sun, 14-Sep-2025 08:46:09 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=8C45361319A2FACBEEACF15FA9CE86BC.1757838969776; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1

> Host: www.baidu.com:443

> User-Agent: curl/8.12.1

> Proxy-Connection: Keep-Alive

>

< HTTP/1.1 200 Connection established

<

* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1

> Host: www.baidu.com

> User-Agent: curl/8.12.1

> Accept: */*

>

* Request completely sent off
< HTTP/1.1 200 OK

< Accept-Ranges: bytes

< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform

< Connection: keep-alive

< Content-Length: 277

< Content-Type: text/html

< Date: Sun, 14 Sep 2025 08:36:09 GMT

< Etag: "575e1f60-115"

< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT

< Pragma: no-cache

< Server: bfe/1.0.8.18

< Tr_id: bfe_9275929367889434610

<


  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:36:09 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9275929367889434610
```

âœ… ç«¯å£ 18080 å·²æˆåŠŸé‡Šæ”¾


###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 16:44:12

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :28081`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 31592

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 18080 -upstream-type websocket -upstream-address ws://localhost:28081`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 31948

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 26772, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:01 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_10901102181150578156
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:01 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_10901102181150578156


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 15992, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:01 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11268909660045715536
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:01 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11268909660045715536


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 32584, 29460, 31592, 31592, 31948, 31948, 26772, 26772, 15992, 15992



###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 16:44:12

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :28081`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 31592

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 18080 -upstream-type websocket -upstream-address ws://localhost:28081`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 31948

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 26772, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:01 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_10901102181150578156
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:01 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_10901102181150578156


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 15992, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:01 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11268909660045715536
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:01 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11268909660045715536


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 32584, 29460, 31592, 31592, 31948, 31948, 26772, 26772, 15992, 15992

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹...
âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹...
âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...
âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 16:44:14 main.go:147: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :28081
2025/09/14 16:44:14 server.go:83: [WEBSOCKET-SERVER] Server started successfully, listening on :28081
2025/09/14 16:44:14 server.go:84: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 16:44:14 server.go:86: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 16:44:14 server.go:87: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 16:44:14 main.go:221: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 16:44:16 server.go:102: url /
2025/09/14 16:44:16 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[Syd/F+u2sT7+OB+8DgtxDA==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.154.131.218] X-Proxy-Target-Port:[37418]]
2025/09/14 16:44:16 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:49095 at 2025-09-14 16:44:16
2025/09/14 16:44:16 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:49095
2025/09/14 16:44:16 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.154.131.218', targetPort: 37418
2025/09/14 16:44:16 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:44:16 server.go:131: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:49095
2025/09/14 16:44:16 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.154.131.218:37418 from [::1]:49095
2025/09/14 16:44:16 server.go:239: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.154.131.218:37418 (timeout: 30s)
2025/09/14 16:44:16 server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.154.131.218:37418
2025/09/14 16:44:16 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 16:44:16 server.go:102: url /
2025/09/14 16:44:16 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[h5mqLexy9V3Hf3HlYbhimg==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 16:44:16 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:49097 at 2025-09-14 16:44:16
2025/09/14 16:44:16 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:49097
2025/09/14 16:44:16 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 16:44:16 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:44:16 server.go:131: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:49097
2025/09/14 16:44:16 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:49097
2025/09/14 16:44:16 server.go:239: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 16:44:16 server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 16:44:16 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 16:44:18 server.go:102: url /
2025/09/14 16:44:18 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[whCR4l+5jjWYjK8a+DwkCQ==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.154.131.218] X-Proxy-Target-Port:[37418]]
2025/09/14 16:44:18 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:49124 at 2025-09-14 16:44:18
2025/09/14 16:44:18 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:49124
2025/09/14 16:44:18 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.154.131.218', targetPort: 37418
2025/09/14 16:44:18 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:44:18 server.go:131: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:49124
2025/09/14 16:44:18 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.154.131.218:37418 from [::1]:49124
2025/09/14 16:44:18 server.go:239: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.154.131.218:37418 (timeout: 30s)
2025/09/14 16:44:18 server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.154.131.218:37418
2025/09/14 16:44:18 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 16:44:18 server.go:102: url /
2025/09/14 16:44:18 server.go:104: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[yDe2LsPwnudgnAHsF23x8g==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 16:44:18 server.go:107: [WEBSOCKET-CONN] New connection attempt from [::1]:49127 at 2025-09-14 16:44:18
2025/09/14 16:44:18 server.go:113: [WEBSOCKET-CONN] No authentication required for client [::1]:49127
2025/09/14 16:44:18 server.go:323: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 16:44:18 server.go:185: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 16:44:18 server.go:131: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:49127
2025/09/14 16:44:18 server.go:141: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:49127
2025/09/14 16:44:18 server.go:239: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 16:44:18 server.go:244: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 16:44:18 server.go:333: [WEBSOCKET-FORWARD] Starting data forwarding between connections
```

### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 16:44:15 main.go:519: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 16:44:15 main.go:563: dohalpn: []
2025/09/14 16:44:15 main.go:565: hostname: 0.0.0.0
2025/09/14 16:44:15 main.go:567: port: 18080
2025/09/14 16:44:15 main.go:569: server_cert: 
2025/09/14 16:44:15 main.go:571: server_key: 
2025/09/14 16:44:15 main.go:573: username: 
2025/09/14 16:44:15 main.go:575: password: 
2025/09/14 16:44:15 main.go:577: dohurl: []
2025/09/14 16:44:15 main.go:579: dohip: []
2025/09/14 16:44:15 main.go:580: upstream-type: websocket
2025/09/14 16:44:15 main.go:581: upstream-address: ws://localhost:28081
2025/09/14 16:44:15 main.go:582: upstream-username: 
2025/09/14 16:44:15 main.go:583: upstream-password: 
2025/09/14 16:44:15 main.go:640: WebSocketä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 16:44:15 main.go:898: {
  "hostname": "",
  "port": 0,
  "server_cert": "",
  "server_key": "",
  "username": "",
  "password": "",
  "doh": null,
  "upstreams": {
    "websocket_upstream": {
      "type": "websocket",
      "http_proxy": "ws://localhost:28081",
      "https_proxy": "ws://localhost:28081",
      "bypass_list": null,
      "ws_proxy": "ws://localhost:28081",
      "ws_username": "",
      "ws_password": "",
      "http_username": "",
      "http_password": "",
      "socks5_proxy": "ws://localhost:28081",
      "socks5_username": "",
      "socks5_password": ""
    }
  },
  "rules": [
    {
      "filter": "websocket_filter",
      "upstream": "websocket_upstream"
    }
  ],
  "filters": {
    "websocket_filter": {
      "patterns": [
        "*"
      ]
    }
  }
}
2025/09/14 16:44:15 simple.go:31: Proxy server started on port [::]:18080
2025/09/14 16:44:15 http.go:388: Random IP: 127.154.131.218
2025/09/14 16:44:15 http.go:406: Random integer: 37418
2025/09/14 16:44:15 http.go:358: Proxy server started on port 127.154.131.218:37418
2025/09/14 16:44:16 simple.go:57: remote addr: [::1]:49094
2025/09/14 16:44:16 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 16:44:16 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:44:16 simple.go:117: address:www.baidu.com:80
2025/09/14 16:44:16 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.154.131.218:37418
2025/09/14 16:44:16 main.go:829: ProxySelector 127.154.131.218:37418
2025/09/14 16:44:16 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:28081
2025/09/14 16:44:16 simple.go:179: WebSocket Config Details:
2025/09/14 16:44:16 simple.go:180: host, portNum 127.154.131.218 37418
2025/09/14 16:44:16 simple.go:181:   Username: 
2025/09/14 16:44:16 simple.go:182:   Password: 
2025/09/14 16:44:16 simple.go:183:   ServerAddr: ws://localhost:28081
2025/09/14 16:44:16 simple.go:184:   Protocol: websocket
2025/09/14 16:44:16 simple.go:185:   Timeout: 30s
2025/09/14 16:44:16 client.go:107: url: ws://localhost:28081
2025/09/14 16:44:16 client.go:108: headers: map[X-Proxy-Target-Host:[127.154.131.218] X-Proxy-Target-Port:[37418]]
2025/09/14 16:44:16 client.go:119: url: http://localhost:28081
2025/09/14 16:44:16 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[jVZswGHFrEVgKZBmhLKwvRWszMI=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 16:44:16 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.154.131.218:37418
2025/09/14 16:44:16 simple.go:248: clienthost: ::1
2025/09/14 16:44:16 simple.go:249: clientport: 49094
2025/09/14 16:44:16 simple.go:278: simple Handle header:
2025/09/14 16:44:16 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:16 simple.go:283: GET / HTTP/1.1
2025/09/14 16:44:16 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:16 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 16:44:16 http.go:90: method: GET
2025/09/14 16:44:16 http.go:91: url: /
2025/09/14 16:44:16 http.go:92: host: www.baidu.com
2025/09/14 16:44:16 http.go:93: proxyHandler header:
2025/09/14 16:44:16 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:16 http.go:121: clientport: 49096
2025/09/14 16:44:16 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.154.131.218:37418;host=www.baidu.com;proto=http
2025/09/14 16:44:16 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 16:44:16 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 16:44:16 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.154.131.218:37418;host=www.baidu.com;proto=http
2025/09/14 16:44:16 http.go:137: forwardedByList: [{[::1]:18080} {127.154.131.218:37418}]
2025/09/14 16:44:16 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:44:16 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:44:16 main.go:829: ProxySelector www.baidu.com
2025/09/14 16:44:16 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:28081
2025/09/14 16:44:16 http.go:259: ä½¿ç”¨ä»£ç†ï¼šws://localhost:28081
2025/09/14 16:44:16 http.go:268: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:28081
2025/09/14 16:44:16 http.go:278: ä½¿ç”¨ä»£ç†ï¼šws://localhost:28081
2025/09/14 16:44:16 http.go:280: network,addr tcp www.baidu.com:80
2025/09/14 16:44:16 http.go:482: WebSocket Config Details:
2025/09/14 16:44:16 http.go:483: host, portNum www.baidu.com 80
2025/09/14 16:44:16 http.go:484:   Username: 
2025/09/14 16:44:16 http.go:485:   Password: 
2025/09/14 16:44:16 http.go:486:   ServerAddr: ws://localhost:28081
2025/09/14 16:44:16 http.go:487:   Protocol: websocket
2025/09/14 16:44:16 http.go:488:   Timeout: 30s
2025/09/14 16:44:16 http.go:492: host, portNum www.baidu.com 80
2025/09/14 16:44:16 client.go:107: url: ws://localhost:28081
2025/09/14 16:44:16 client.go:108: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 16:44:16 client.go:119: url: http://localhost:28081
2025/09/14 16:44:16 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[TZFE+CLBIfKGAL8DIfSjJjLUuXo=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
[GIN] 2025/09/14 - 16:44:16 | 200 |       96.86ms |       127.0.0.1 | GET      "/"
2025/09/14 16:44:18 simple.go:57: remote addr: [::1]:49123
2025/09/14 16:44:18 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 16:44:18 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:44:18 simple.go:117: address:www.baidu.com:80
2025/09/14 16:44:18 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.154.131.218:37418
2025/09/14 16:44:18 main.go:829: ProxySelector 127.154.131.218:37418
2025/09/14 16:44:18 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:28081
2025/09/14 16:44:18 simple.go:179: WebSocket Config Details:
2025/09/14 16:44:18 simple.go:180: host, portNum 127.154.131.218 37418
2025/09/14 16:44:18 simple.go:181:   Username: 
2025/09/14 16:44:18 simple.go:182:   Password: 
2025/09/14 16:44:18 simple.go:183:   ServerAddr: ws://localhost:28081
2025/09/14 16:44:18 simple.go:184:   Protocol: websocket
2025/09/14 16:44:18 simple.go:185:   Timeout: 30s
2025/09/14 16:44:18 client.go:107: url: ws://localhost:28081
2025/09/14 16:44:18 client.go:108: headers: map[X-Proxy-Target-Host:[127.154.131.218] X-Proxy-Target-Port:[37418]]
2025/09/14 16:44:18 client.go:119: url: http://localhost:28081
2025/09/14 16:44:18 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[PvGSmHWtWyywdK1nOV0q5g5dYp4=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 16:44:18 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.154.131.218:37418
2025/09/14 16:44:18 simple.go:248: clienthost: ::1
2025/09/14 16:44:18 simple.go:249: clientport: 49123
2025/09/14 16:44:18 simple.go:278: simple Handle header:
2025/09/14 16:44:18 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:18 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:44:18 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:18 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:44:18 http.go:90: method: HEAD
2025/09/14 16:44:18 http.go:91: url: /
2025/09/14 16:44:18 http.go:92: host: www.baidu.com
2025/09/14 16:44:18 http.go:93: proxyHandler header:
2025/09/14 16:44:18 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:18 http.go:121: clientport: 49125
2025/09/14 16:44:18 http.go:132: proxyHandler Accept : */*
2025/09/14 16:44:18 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:44:18 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.154.131.218:37418;host=www.baidu.com;proto=http
2025/09/14 16:44:18 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:44:18 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.154.131.218:37418;host=www.baidu.com;proto=http
2025/09/14 16:44:18 http.go:137: forwardedByList: [{[::1]:18080} {127.154.131.218:37418}]
2025/09/14 16:44:18 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:44:18 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:44:18 main.go:829: ProxySelector www.baidu.com
2025/09/14 16:44:18 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:28081
2025/09/14 16:44:18 http.go:259: ä½¿ç”¨ä»£ç†ï¼šws://localhost:28081
2025/09/14 16:44:18 http.go:268: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:28081
[GIN] 2025/09/14 - 16:44:18 | 200 |       36.22ms |       127.0.0.1 | HEAD     "/"
2025/09/14 16:44:18 simple.go:57: remote addr: [::1]:49126
2025/09/14 16:44:18 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 16:44:18 simple.go:117: address:www.baidu.com:443
2025/09/14 16:44:18 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 16:44:18 main.go:829: ProxySelector www.baidu.com:443
2025/09/14 16:44:18 main.go:835: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:28081
2025/09/14 16:44:18 simple.go:179: WebSocket Config Details:
2025/09/14 16:44:18 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 16:44:18 simple.go:181:   Username: 
2025/09/14 16:44:18 simple.go:182:   Password: 
2025/09/14 16:44:18 simple.go:183:   ServerAddr: ws://localhost:28081
2025/09/14 16:44:18 simple.go:184:   Protocol: websocket
2025/09/14 16:44:18 simple.go:185:   Timeout: 30s
2025/09/14 16:44:18 client.go:107: url: ws://localhost:28081
2025/09/14 16:44:18 client.go:108: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 16:44:18 client.go:119: url: http://localhost:28081
2025/09/14 16:44:18 client.go:120: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[DCbhhYEm5NauCdRwL7ljfgYx0VU=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 16:44:18 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
2025/09/14 16:44:18 simple.go:204: WebSocket ForwardData error: read tcp [::1]:49095->[::1]:28081: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 16:44:18 http.go:509: WebSocket ForwardData error: read tcp [::1]:49097->[::1]:28081: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 16:44:18 simple.go:204: WebSocket ForwardData error: read tcp [::1]:49124->[::1]:28081: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 16:44:18 simple.go:204: WebSocket ForwardData error: read tcp [::1]:49127->[::1]:28081: wsarecv: An existing connection was forcibly closed by the remote host.
```

âœ… ç«¯å£18080å·²æˆåŠŸé‡Šæ”¾
âœ… ç«¯å£18080å·²æˆåŠŸé‡Šæ”¾


###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 18080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 18080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 16:44:23 main.go:519: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 16:44:23 main.go:563: dohalpn: [h2, h3]
2025/09/14 16:44:23 main.go:565: hostname: 0.0.0.0
2025/09/14 16:44:23 main.go:567: port: 18080
2025/09/14 16:44:23 main.go:569: server_cert: 
2025/09/14 16:44:23 main.go:571: server_key: 
2025/09/14 16:44:23 main.go:573: username: 
2025/09/14 16:44:23 main.go:575: password: 
2025/09/14 16:44:23 main.go:577: dohurl: [https://dns.alidns.com/dns-query, https://dns.alidns.com/dns-query]
2025/09/14 16:44:23 main.go:579: dohip: [223.5.5.5, 223.6.6.6]
2025/09/14 16:44:23 main.go:580: upstream-type: 
2025/09/14 16:44:23 main.go:581: upstream-address: 
2025/09/14 16:44:23 main.go:582: upstream-username: 
2025/09/14 16:44:23 main.go:583: upstream-password: 
2025/09/14 16:44:23 main.go:898: null
2025/09/14 16:44:23 simple.go:31: Proxy server started on port [::]:18080
2025/09/14 16:44:23 http.go:388: Random IP: 127.53.144.212
2025/09/14 16:44:23 http.go:406: Random integer: 13045
2025/09/14 16:44:23 http.go:358: Proxy server started on port 127.53.144.212:13045
2025/09/14 16:44:25 simple.go:57: remote addr: [::1]:49139
2025/09/14 16:44:25 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 16:44:25 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:44:25 simple.go:117: address:www.baidu.com:80
2025/09/14 16:44:25 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.144.212:13045
2025/09/14 16:44:25 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.53.144.212:13045
2025/09/14 16:44:25 simple.go:248: clienthost: ::1
2025/09/14 16:44:25 simple.go:249: clientport: 49139
2025/09/14 16:44:25 simple.go:278: simple Handle header:
2025/09/14 16:44:25 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:25 simple.go:283: GET / HTTP/1.1
2025/09/14 16:44:25 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:25 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 16:44:25 http.go:90: method: GET
2025/09/14 16:44:25 http.go:91: url: /
2025/09/14 16:44:25 http.go:92: host: www.baidu.com
2025/09/14 16:44:25 http.go:93: proxyHandler header:
2025/09/14 16:44:25 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:25 http.go:121: clientport: 49140
2025/09/14 16:44:25 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.53.144.212:13045;host=www.baidu.com;proto=http
2025/09/14 16:44:25 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 16:44:25 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 16:44:25 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.53.144.212:13045;host=www.baidu.com;proto=http
2025/09/14 16:44:25 http.go:137: forwardedByList: [{[::1]:18080} {127.53.144.212:13045}]
2025/09/14 16:44:25 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:44:25 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:44:25 options.go:186: hostname www.baidu.com no ip found
2025/09/14 16:44:25 doh3.go:15: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:25 doh3.go:27: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:25 doh3.go:27: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:26 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:56244 223.6.6.6:443
2025/09/14 16:44:26 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:56245 223.6.6.6:443
2025/09/14 16:44:26 doh3.go:80: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69]
2025/09/14 16:44:26 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.101.49.44
[GIN] 2025/09/14 - 16:44:26 | 200 |    126.1271ms |       127.0.0.1 | GET      "/"
2025/09/14 16:44:26 simple.go:57: remote addr: [::1]:49145
2025/09/14 16:44:26 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 16:44:26 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:44:26 simple.go:117: address:www.baidu.com:80
2025/09/14 16:44:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.144.212:13045
2025/09/14 16:44:26 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.53.144.212:13045
2025/09/14 16:44:26 simple.go:248: clienthost: ::1
2025/09/14 16:44:26 simple.go:249: clientport: 49145
2025/09/14 16:44:26 simple.go:278: simple Handle header:
2025/09/14 16:44:26 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:26 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:44:26 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:26 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:44:26 http.go:90: method: HEAD
2025/09/14 16:44:26 http.go:91: url: /
2025/09/14 16:44:26 http.go:92: host: www.baidu.com
2025/09/14 16:44:26 http.go:93: proxyHandler header:
2025/09/14 16:44:26 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:26 http.go:121: clientport: 49146
2025/09/14 16:44:26 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:44:26 http.go:132: proxyHandler Accept : */*
2025/09/14 16:44:26 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:44:26 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.53.144.212:13045;host=www.baidu.com;proto=http
2025/09/14 16:44:26 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.53.144.212:13045;host=www.baidu.com;proto=http
2025/09/14 16:44:26 http.go:137: forwardedByList: [{[::1]:18080} {127.53.144.212:13045}]
2025/09/14 16:44:26 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:44:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 16:44:26 options.go:186: hostname www.baidu.com no ip found
2025/09/14 16:44:26 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:26 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:26 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:26 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:44:26 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:44:26 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:44:26 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:44:26 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:44:26 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:44:26 doh.go:91: dns resolved www.baidu.com ips:[180.101.49.44,180.101.51.73,240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5]
2025/09/14 16:44:26 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.101.49.44
[GIN] 2025/09/14 - 16:44:27 | 200 |    1.1332825s |       127.0.0.1 | HEAD     "/"
2025/09/14 16:44:27 simple.go:57: remote addr: [::1]:49157
2025/09/14 16:44:27 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 16:44:27 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 16:44:27 simple.go:117: address:www.so.com:80
2025/09/14 16:44:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.144.212:13045
2025/09/14 16:44:27 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.53.144.212:13045
2025/09/14 16:44:27 simple.go:248: clienthost: ::1
2025/09/14 16:44:27 simple.go:249: clientport: 49157
2025/09/14 16:44:27 simple.go:278: simple Handle header:
2025/09/14 16:44:27 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:44:27 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:44:27 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:44:27 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:44:27 http.go:90: method: HEAD
2025/09/14 16:44:27 http.go:91: url: /
2025/09/14 16:44:27 http.go:92: host: www.so.com
2025/09/14 16:44:27 http.go:93: proxyHandler header:
2025/09/14 16:44:27 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:27 http.go:121: clientport: 49158
2025/09/14 16:44:27 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:44:27 http.go:132: proxyHandler Accept : */*
2025/09/14 16:44:27 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:44:27 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.53.144.212:13045;host=www.so.com;proto=http
2025/09/14 16:44:27 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.53.144.212:13045;host=www.so.com;proto=http
2025/09/14 16:44:27 http.go:137: forwardedByList: [{[::1]:18080} {127.53.144.212:13045}]
2025/09/14 16:44:27 http.go:155: targetUrl: http://www.so.com/
2025/09/14 16:44:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
2025/09/14 16:44:27 options.go:186: hostname www.so.com no ip found
2025/09/14 16:44:27 doh.go:16: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 doh.go:28: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:44:27 doh.go:28: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:44:27 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:44:27 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:44:27 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:44:27 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:44:27 doh.go:91: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 16:44:27 options.go:240: success connect to address=www.so.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.163.237.15
[GIN] 2025/09/14 - 16:44:27 | 302 |      92.988ms |       127.0.0.1 | HEAD     "/"
2025/09/14 16:44:27 simple.go:57: remote addr: [::1]:49162
2025/09/14 16:44:27 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 16:44:27 simple.go:117: address:www.so.com:443
2025/09/14 16:44:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 16:44:27 options.go:98: hostname www.so.com no ip found
2025/09/14 16:44:27 options.go:186: hostname www.so.com no ip found
2025/09/14 16:44:27 doh3.go:15: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 doh3.go:27: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 doh3.go:27: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:51889 223.6.6.6:443
2025/09/14 16:44:27 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:51888 223.6.6.6:443
2025/09/14 16:44:27 doh3.go:80: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 16:44:27 options.go:240: success connect to address=www.so.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.163.237.15
2025/09/14 16:44:27 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 16:44:27 simple.go:57: remote addr: [::1]:49164
2025/09/14 16:44:27 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 16:44:27 simple.go:117: address:www.baidu.com:443
2025/09/14 16:44:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 16:44:27 options.go:98: hostname www.baidu.com no ip found
2025/09/14 16:44:27 options.go:186: hostname www.baidu.com no ip found
2025/09/14 16:44:27 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 16:44:27 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:44:27 dns.go:247: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 16:44:27 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:44:27 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:44:27 dns.go:135: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 16:44:27 dns.go:165: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 16:44:27 doh.go:91: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69]
2025/09/14 16:44:27 options.go:240: success connect to address=www.baidu.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=240e:e9:6002:1ac:0:ff:b07e:36c5
2025/09/14 16:44:27 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 16:44:30

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 34624

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 27120

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_10315764190906471132
< 
  0   277    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0  0   277    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_10315764190906471132


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:18080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 25820

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=jte1u7p07vcs55r2n6ov0rlb27; expires=Sun, 14-Sep-2025 08:54:19 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=28757436392D5484E6F1114BFC9F77F8.1757839459810; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 08:44:19 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=jte1u7p07vcs55r2n6ov0rlb27; expires=Sun, 14-Sep-2025 08:54:19 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=28757436392D5484E6F1114BFC9F77F8.1757839459810; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 30052

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11473488289623244232
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11473488289623244232


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 27384, 34624, 34624, 27120, 27120, 25820, 25820, 30052, 30052



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 16:44:30

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 34624

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 27120

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_10315764190906471132
< 
  0   277    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0  0   277    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_10315764190906471132


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:18080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 25820

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=jte1u7p07vcs55r2n6ov0rlb27; expires=Sun, 14-Sep-2025 08:54:19 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=28757436392D5484E6F1114BFC9F77F8.1757839459810; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 08:44:19 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=jte1u7p07vcs55r2n6ov0rlb27; expires=Sun, 14-Sep-2025 08:54:19 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=28757436392D5484E6F1114BFC9F77F8.1757839459810; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:18080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 30052

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11473488289623244232
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11473488289623244232


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 27384, 34624, 34624, 27120, 27120, 25820, 25820, 30052, 30052

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 16:44:32 main.go:519: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 16:44:32 main.go:563: dohalpn: []
2025/09/14 16:44:32 main.go:565: hostname: 0.0.0.0
2025/09/14 16:44:32 main.go:567: port: 18080
2025/09/14 16:44:32 main.go:569: server_cert: 
2025/09/14 16:44:32 main.go:571: server_key: 
2025/09/14 16:44:32 main.go:573: username: 
2025/09/14 16:44:32 main.go:575: password: 
2025/09/14 16:44:32 main.go:577: dohurl: []
2025/09/14 16:44:32 main.go:579: dohip: []
2025/09/14 16:44:32 main.go:580: upstream-type: 
2025/09/14 16:44:32 main.go:581: upstream-address: 
2025/09/14 16:44:32 main.go:582: upstream-username: 
2025/09/14 16:44:32 main.go:583: upstream-password: 
2025/09/14 16:44:32 main.go:898: null
2025/09/14 16:44:32 simple.go:31: Proxy server started on port [::]:18080
2025/09/14 16:44:32 http.go:388: Random IP: 127.110.214.74
2025/09/14 16:44:32 http.go:406: Random integer: 61822
2025/09/14 16:44:32 http.go:358: Proxy server started on port 127.110.214.74:61822
2025/09/14 16:44:33 simple.go:57: remote addr: [::1]:49174
2025/09/14 16:44:33 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 16:44:33 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:44:33 simple.go:117: address:www.baidu.com:80
2025/09/14 16:44:33 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.110.214.74:61822
2025/09/14 16:44:33 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.110.214.74:61822
2025/09/14 16:44:33 simple.go:248: clienthost: ::1
2025/09/14 16:44:33 simple.go:249: clientport: 49174
2025/09/14 16:44:33 simple.go:278: simple Handle header:
2025/09/14 16:44:33 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:33 simple.go:283: GET / HTTP/1.1
2025/09/14 16:44:33 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:33 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 16:44:33 http.go:90: method: GET
2025/09/14 16:44:33 http.go:91: url: /
2025/09/14 16:44:33 http.go:92: host: www.baidu.com
2025/09/14 16:44:33 http.go:93: proxyHandler header:
2025/09/14 16:44:33 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:33 http.go:121: clientport: 49175
2025/09/14 16:44:33 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.110.214.74:61822;host=www.baidu.com;proto=http
2025/09/14 16:44:33 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 16:44:33 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 16:44:33 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.110.214.74:61822;host=www.baidu.com;proto=http
2025/09/14 16:44:33 http.go:137: forwardedByList: [{[::1]:18080} {127.110.214.74:61822}]
2025/09/14 16:44:33 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:44:33 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 16:44:33 | 200 |     90.7413ms |       127.0.0.1 | GET      "/"
2025/09/14 16:44:35 simple.go:57: remote addr: [::1]:49178
2025/09/14 16:44:35 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 16:44:35 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 16:44:35 simple.go:117: address:www.baidu.com:80
2025/09/14 16:44:35 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.110.214.74:61822
2025/09/14 16:44:35 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.110.214.74:61822
2025/09/14 16:44:35 simple.go:248: clienthost: ::1
2025/09/14 16:44:35 simple.go:249: clientport: 49178
2025/09/14 16:44:35 simple.go:278: simple Handle header:
2025/09/14 16:44:35 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:35 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:44:35 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http
2025/09/14 16:44:35 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:44:35 http.go:90: method: HEAD
2025/09/14 16:44:35 http.go:91: url: /
2025/09/14 16:44:35 http.go:92: host: www.baidu.com
2025/09/14 16:44:35 http.go:93: proxyHandler header:
2025/09/14 16:44:35 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:35 http.go:121: clientport: 49179
2025/09/14 16:44:35 http.go:132: proxyHandler Accept : */*
2025/09/14 16:44:35 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:44:35 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.110.214.74:61822;host=www.baidu.com;proto=http
2025/09/14 16:44:35 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:44:35 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.110.214.74:61822;host=www.baidu.com;proto=http
2025/09/14 16:44:35 http.go:137: forwardedByList: [{[::1]:18080} {127.110.214.74:61822}]
2025/09/14 16:44:35 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 16:44:35 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 16:44:36 | 200 |    1.0512794s |       127.0.0.1 | HEAD     "/"
2025/09/14 16:44:36 simple.go:57: remote addr: [::1]:49180
2025/09/14 16:44:36 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 16:44:36 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 16:44:36 simple.go:117: address:www.so.com:80
2025/09/14 16:44:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.110.214.74:61822
2025/09/14 16:44:36 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.110.214.74:61822
2025/09/14 16:44:36 simple.go:248: clienthost: ::1
2025/09/14 16:44:36 simple.go:249: clientport: 49180
2025/09/14 16:44:36 simple.go:278: simple Handle header:
2025/09/14 16:44:36 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:44:36 simple.go:283: HEAD / HTTP/1.1
2025/09/14 16:44:36 simple.go:288: Forwarded: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http
2025/09/14 16:44:36 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 16:44:36 http.go:90: method: HEAD
2025/09/14 16:44:36 http.go:91: url: /
2025/09/14 16:44:36 http.go:92: host: www.so.com
2025/09/14 16:44:36 http.go:93: proxyHandler header:
2025/09/14 16:44:36 http.go:120: clienthost: 127.0.0.1
2025/09/14 16:44:36 http.go:121: clientport: 49181
2025/09/14 16:44:36 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:18080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.110.214.74:61822;host=www.so.com;proto=http
2025/09/14 16:44:36 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 16:44:36 http.go:132: proxyHandler Accept : */*
2025/09/14 16:44:36 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 16:44:36 http.go:135: forwardedHeader: for=::1;by=[::1]:18080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.110.214.74:61822;host=www.so.com;proto=http
2025/09/14 16:44:36 http.go:137: forwardedByList: [{[::1]:18080} {127.110.214.74:61822}]
2025/09/14 16:44:36 http.go:155: targetUrl: http://www.so.com/
2025/09/14 16:44:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 16:44:36 | 302 |     62.7366ms |       127.0.0.1 | HEAD     "/"
2025/09/14 16:44:36 simple.go:57: remote addr: [::1]:49191
2025/09/14 16:44:36 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 16:44:36 simple.go:117: address:www.so.com:443
2025/09/14 16:44:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 16:44:36 options.go:98: hostname www.so.com no ip found
2025/09/14 16:44:36 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 16:44:36 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 16:44:36 simple.go:57: remote addr: [::1]:49197
2025/09/14 16:44:36 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 16:44:36 simple.go:117: address:www.baidu.com:443
2025/09/14 16:44:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 16:44:36 options.go:98: hostname www.baidu.com no ip found
2025/09/14 16:44:36 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 16:44:36 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_10315764190906471132
< 
  0   277    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0  0   277    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_10315764190906471132
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=jte1u7p07vcs55r2n6ov0rlb27; expires=Sun, 14-Sep-2025 08:54:19 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=28757436392D5484E6F1114BFC9F77F8.1757839459810; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 08:44:19 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=jte1u7p07vcs55r2n6ov0rlb27; expires=Sun, 14-Sep-2025 08:54:19 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=28757436392D5484E6F1114BFC9F77F8.1757839459810; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:18080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:18080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 18080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 08:44:19 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11473488289623244232
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 08:44:19 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11473488289623244232
```

âœ… ç«¯å£18080å·²æˆåŠŸé‡Šæ”¾
