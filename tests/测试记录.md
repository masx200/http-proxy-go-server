

###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:11:09

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 35276

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 24868

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.14.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12015824289897902877
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12015824289897902877


* Connection #0 to host localhost left intact

```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 18128

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.14.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.14.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* schannel: disabled automatic use of client certificate
* ALPN: curl offers http/1.1
* ALPN: server did not agree on a protocol. Uses default.
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.14.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=84vqk56dhqeubch5064cn656h2; expires=Sat, 13-Sep-2025 17:20:58 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=97430541FB75C91233EAB13DDBF3C603.1757783458830; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:10:58 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=84vqk56dhqeubch5064cn656h2; expires=Sat, 13-Sep-2025 17:20:58 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=97430541FB75C91233EAB13DDBF3C603.1757783458830; Max-Age=63072000; Domain=so.com; Path=/


* Connection #1 to host localhost left intact

```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 34780

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.14.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* schannel: disabled automatic use of client certificate
* ALPN: curl offers http/1.1
* ALPN: server accepted http/1.1
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.14.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9543423590586223627
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9543423590586223627


* Connection #0 to host localhost left intact

```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 35276, 24868, 18128, 34780



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:11:09

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 35276

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 24868

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.14.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12015824289897902877
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12015824289897902877


* Connection #0 to host localhost left intact

```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 18128

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.14.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.14.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* schannel: disabled automatic use of client certificate
* ALPN: curl offers http/1.1
* ALPN: server did not agree on a protocol. Uses default.
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.14.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=84vqk56dhqeubch5064cn656h2; expires=Sat, 13-Sep-2025 17:20:58 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=97430541FB75C91233EAB13DDBF3C603.1757783458830; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:10:58 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=84vqk56dhqeubch5064cn656h2; expires=Sat, 13-Sep-2025 17:20:58 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=97430541FB75C91233EAB13DDBF3C603.1757783458830; Max-Age=63072000; Domain=so.com; Path=/


* Connection #1 to host localhost left intact

```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 34780

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.14.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* schannel: disabled automatic use of client certificate
* ALPN: curl offers http/1.1
* ALPN: server accepted http/1.1
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.14.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9543423590586223627
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9543423590586223627


* Connection #0 to host localhost left intact

```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 35276, 24868, 18128, 34780

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:11:11 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:11:11 main.go:562: dohalpn: []
2025/09/14 01:11:11 main.go:564: hostname: 0.0.0.0
2025/09/14 01:11:11 main.go:566: port: 8080
2025/09/14 01:11:11 main.go:568: server_cert: 
2025/09/14 01:11:11 main.go:570: server_key: 
2025/09/14 01:11:11 main.go:572: username: 
2025/09/14 01:11:11 main.go:574: password: 
2025/09/14 01:11:11 main.go:576: dohurl: []
2025/09/14 01:11:11 main.go:578: dohip: []
2025/09/14 01:11:11 main.go:579: upstream-type: 
2025/09/14 01:11:11 main.go:580: upstream-address: 
2025/09/14 01:11:11 main.go:581: upstream-username: 
2025/09/14 01:11:11 main.go:582: upstream-password: 
2025/09/14 01:11:11 main.go:854: null
2025/09/14 01:11:11 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:11:11 http.go:372: Random IP: 127.53.199.241
2025/09/14 01:11:11 http.go:390: Random integer: 43109
2025/09/14 01:11:11 http.go:342: Proxy server started on port 127.53.199.241:43109
2025/09/14 01:11:12 simple.go:57: remote addr: [::1]:38631
2025/09/14 01:11:12 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:11:12 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:11:12 simple.go:117: address:www.baidu.com:80
2025/09/14 01:11:12 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.199.241:43109
2025/09/14 01:11:12 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.53.199.241:43109
2025/09/14 01:11:12 simple.go:248: clienthost: ::1
2025/09/14 01:11:12 simple.go:249: clientport: 38631
2025/09/14 01:11:12 simple.go:278: simple Handle header:
2025/09/14 01:11:12 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:11:12 simple.go:283: GET / HTTP/1.1
2025/09/14 01:11:12 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:11:12 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:11:12 http.go:90: method: GET
2025/09/14 01:11:12 http.go:91: url: /
2025/09/14 01:11:12 http.go:92: host: www.baidu.com
2025/09/14 01:11:12 http.go:93: proxyHandler header:
2025/09/14 01:11:12 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:11:12 http.go:121: clientport: 38632
2025/09/14 01:11:12 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.53.199.241:43109;host=www.baidu.com;proto=http
2025/09/14 01:11:12 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:11:12 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:11:12 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.53.199.241:43109;host=www.baidu.com;proto=http
2025/09/14 01:11:12 http.go:137: forwardedByList: [{[::1]:8080} {127.53.199.241:43109}]
2025/09/14 01:11:12 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:11:12 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:11:12 | 200 |     56.0881ms |       127.0.0.1 | GET      "/"
2025/09/14 01:11:14 simple.go:57: remote addr: [::1]:38636
2025/09/14 01:11:14 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:11:14 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:11:14 simple.go:117: address:www.baidu.com:80
2025/09/14 01:11:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.199.241:43109
2025/09/14 01:11:14 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.53.199.241:43109
2025/09/14 01:11:14 simple.go:248: clienthost: ::1
2025/09/14 01:11:14 simple.go:249: clientport: 38636
2025/09/14 01:11:14 simple.go:278: simple Handle header:
2025/09/14 01:11:14 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:11:14 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:11:14 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:11:14 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.14.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:11:14 http.go:90: method: HEAD
2025/09/14 01:11:14 http.go:91: url: /
2025/09/14 01:11:14 http.go:92: host: www.baidu.com
2025/09/14 01:11:14 http.go:93: proxyHandler header:
2025/09/14 01:11:14 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:11:14 http.go:121: clientport: 38637
2025/09/14 01:11:14 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.53.199.241:43109;host=www.baidu.com;proto=http
2025/09/14 01:11:14 http.go:132: proxyHandler User-Agent : curl/8.14.1
2025/09/14 01:11:14 http.go:132: proxyHandler Accept : */*
2025/09/14 01:11:14 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:11:14 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.53.199.241:43109;host=www.baidu.com;proto=http
2025/09/14 01:11:14 http.go:137: forwardedByList: [{[::1]:8080} {127.53.199.241:43109}]
2025/09/14 01:11:14 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:11:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:11:14 | 200 |     18.2732ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:11:14 simple.go:57: remote addr: [::1]:38638
2025/09/14 01:11:14 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:11:14 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:11:14 simple.go:117: address:www.so.com:80
2025/09/14 01:11:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.199.241:43109
2025/09/14 01:11:14 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.53.199.241:43109
2025/09/14 01:11:14 simple.go:248: clienthost: ::1
2025/09/14 01:11:14 simple.go:249: clientport: 38638
2025/09/14 01:11:14 simple.go:278: simple Handle header:
2025/09/14 01:11:14 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:11:14 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:11:14 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:11:14 simple.go:294: Host: www.so.com
User-Agent: curl/8.14.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:11:14 http.go:90: method: HEAD
2025/09/14 01:11:14 http.go:91: url: /
2025/09/14 01:11:14 http.go:92: host: www.so.com
2025/09/14 01:11:14 http.go:93: proxyHandler header:
2025/09/14 01:11:14 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:11:14 http.go:121: clientport: 38639
2025/09/14 01:11:14 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:11:14 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.53.199.241:43109;host=www.so.com;proto=http
2025/09/14 01:11:14 http.go:132: proxyHandler User-Agent : curl/8.14.1
2025/09/14 01:11:14 http.go:132: proxyHandler Accept : */*
2025/09/14 01:11:14 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.53.199.241:43109;host=www.so.com;proto=http
2025/09/14 01:11:14 http.go:137: forwardedByList: [{[::1]:8080} {127.53.199.241:43109}]
2025/09/14 01:11:14 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:11:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:11:14 | 302 |     36.5373ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:11:14 simple.go:57: remote addr: [::1]:38641
2025/09/14 01:11:14 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:11:14 simple.go:117: address:www.so.com:443
2025/09/14 01:11:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:11:14 options.go:98: hostname www.so.com no ip found
2025/09/14 01:11:14 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:11:14 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:11:15 simple.go:57: remote addr: [::1]:38652
2025/09/14 01:11:15 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:11:15 simple.go:117: address:www.baidu.com:443
2025/09/14 01:11:15 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:11:15 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:11:15 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:11:15 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.14.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12015824289897902877
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12015824289897902877
* Connection #0 to host localhost left intact
### Curlæµ‹è¯•2è¾“å‡º ###
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.14.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.14.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* schannel: disabled automatic use of client certificate
* ALPN: curl offers http/1.1
* ALPN: server did not agree on a protocol. Uses default.
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.14.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=84vqk56dhqeubch5064cn656h2; expires=Sat, 13-Sep-2025 17:20:58 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=97430541FB75C91233EAB13DDBF3C603.1757783458830; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:10:58 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=84vqk56dhqeubch5064cn656h2; expires=Sat, 13-Sep-2025 17:20:58 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=97430541FB75C91233EAB13DDBF3C603.1757783458830; Max-Age=63072000; Domain=so.com; Path=/
* Connection #1 to host localhost left intact
### Curlæµ‹è¯•3è¾“å‡º ###
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.14.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* schannel: disabled automatic use of client certificate
* ALPN: curl offers http/1.1
* ALPN: server accepted http/1.1
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.14.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:10:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9543423590586223627
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:10:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9543423590586223627
* Connection #0 to host localhost left intact
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:12:51

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 35640

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 38244

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11904522441405846353
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11904522441405846353


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 39256

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=u7rkth21uvv3duhkmkjm6qmbd5; expires=Sat, 13-Sep-2025 17:22:40 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=6170AB1455AED11D15FAE188FC94C44D.1757783560460; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:12:40 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=u7rkth21uvv3duhkmkjm6qmbd5; expires=Sat, 13-Sep-2025 17:22:40 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=6170AB1455AED11D15FAE188FC94C44D.1757783560460; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 8264

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11432493217373461392
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11432493217373461392


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 35640, 38244, 39256, 8264



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:12:51

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 35640

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 38244

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11904522441405846353
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11904522441405846353


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 39256

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=u7rkth21uvv3duhkmkjm6qmbd5; expires=Sat, 13-Sep-2025 17:22:40 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=6170AB1455AED11D15FAE188FC94C44D.1757783560460; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:12:40 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=u7rkth21uvv3duhkmkjm6qmbd5; expires=Sat, 13-Sep-2025 17:22:40 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=6170AB1455AED11D15FAE188FC94C44D.1757783560460; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 8264

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11432493217373461392
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11432493217373461392


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 35640, 38244, 39256, 8264

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:12:53 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:12:53 main.go:562: dohalpn: []
2025/09/14 01:12:53 main.go:564: hostname: 0.0.0.0
2025/09/14 01:12:53 main.go:566: port: 8080
2025/09/14 01:12:53 main.go:568: server_cert: 
2025/09/14 01:12:53 main.go:570: server_key: 
2025/09/14 01:12:53 main.go:572: username: 
2025/09/14 01:12:53 main.go:574: password: 
2025/09/14 01:12:53 main.go:576: dohurl: []
2025/09/14 01:12:53 main.go:578: dohip: []
2025/09/14 01:12:53 main.go:579: upstream-type: 
2025/09/14 01:12:53 main.go:580: upstream-address: 
2025/09/14 01:12:53 main.go:581: upstream-username: 
2025/09/14 01:12:53 main.go:582: upstream-password: 
2025/09/14 01:12:53 main.go:854: null
2025/09/14 01:12:53 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:12:53 http.go:372: Random IP: 127.5.115.71
2025/09/14 01:12:53 http.go:390: Random integer: 62229
2025/09/14 01:12:53 http.go:342: Proxy server started on port 127.5.115.71:62229
2025/09/14 01:12:54 simple.go:57: remote addr: [::1]:39463
2025/09/14 01:12:54 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:12:54 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:12:54 simple.go:117: address:www.baidu.com:80
2025/09/14 01:12:54 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.5.115.71:62229
2025/09/14 01:12:54 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.5.115.71:62229
2025/09/14 01:12:54 simple.go:248: clienthost: ::1
2025/09/14 01:12:54 simple.go:249: clientport: 39463
2025/09/14 01:12:54 simple.go:278: simple Handle header:
2025/09/14 01:12:54 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:12:54 simple.go:283: GET / HTTP/1.1
2025/09/14 01:12:54 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:12:54 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:12:54 http.go:90: method: GET
2025/09/14 01:12:54 http.go:91: url: /
2025/09/14 01:12:54 http.go:92: host: www.baidu.com
2025/09/14 01:12:54 http.go:93: proxyHandler header:
2025/09/14 01:12:54 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:12:54 http.go:121: clientport: 39464
2025/09/14 01:12:54 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.5.115.71:62229;host=www.baidu.com;proto=http
2025/09/14 01:12:54 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:12:54 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:12:54 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.5.115.71:62229;host=www.baidu.com;proto=http
2025/09/14 01:12:54 http.go:137: forwardedByList: [{[::1]:8080} {127.5.115.71:62229}]
2025/09/14 01:12:54 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:12:54 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:12:54 | 200 |     63.2929ms |       127.0.0.1 | GET      "/"
2025/09/14 01:12:56 simple.go:57: remote addr: [::1]:39496
2025/09/14 01:12:56 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:12:56 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:12:56 simple.go:117: address:www.baidu.com:80
2025/09/14 01:12:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.5.115.71:62229
2025/09/14 01:12:56 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.5.115.71:62229
2025/09/14 01:12:56 simple.go:248: clienthost: ::1
2025/09/14 01:12:56 simple.go:249: clientport: 39496
2025/09/14 01:12:56 simple.go:278: simple Handle header:
2025/09/14 01:12:56 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:12:56 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:12:56 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:12:56 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:12:56 http.go:90: method: HEAD
2025/09/14 01:12:56 http.go:91: url: /
2025/09/14 01:12:56 http.go:92: host: www.baidu.com
2025/09/14 01:12:56 http.go:93: proxyHandler header:
2025/09/14 01:12:56 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:12:56 http.go:121: clientport: 39497
2025/09/14 01:12:56 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:12:56 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.5.115.71:62229;host=www.baidu.com;proto=http
2025/09/14 01:12:56 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:12:56 http.go:132: proxyHandler Accept : */*
2025/09/14 01:12:56 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.5.115.71:62229;host=www.baidu.com;proto=http
2025/09/14 01:12:56 http.go:137: forwardedByList: [{[::1]:8080} {127.5.115.71:62229}]
2025/09/14 01:12:56 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:12:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:12:56 | 200 |     18.9955ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:12:56 simple.go:57: remote addr: [::1]:39498
2025/09/14 01:12:56 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:12:56 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:12:56 simple.go:117: address:www.so.com:80
2025/09/14 01:12:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.5.115.71:62229
2025/09/14 01:12:56 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.5.115.71:62229
2025/09/14 01:12:56 simple.go:248: clienthost: ::1
2025/09/14 01:12:56 simple.go:249: clientport: 39498
2025/09/14 01:12:56 simple.go:278: simple Handle header:
2025/09/14 01:12:56 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:12:56 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:12:56 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:12:56 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:12:56 http.go:90: method: HEAD
2025/09/14 01:12:56 http.go:91: url: /
2025/09/14 01:12:56 http.go:92: host: www.so.com
2025/09/14 01:12:56 http.go:93: proxyHandler header:
2025/09/14 01:12:56 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:12:56 http.go:121: clientport: 39499
2025/09/14 01:12:56 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:12:56 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.5.115.71:62229;host=www.so.com;proto=http
2025/09/14 01:12:56 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:12:56 http.go:132: proxyHandler Accept : */*
2025/09/14 01:12:56 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.5.115.71:62229;host=www.so.com;proto=http
2025/09/14 01:12:56 http.go:137: forwardedByList: [{[::1]:8080} {127.5.115.71:62229}]
2025/09/14 01:12:56 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:12:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:12:56 | 302 |     74.4206ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:12:56 simple.go:57: remote addr: [::1]:39507
2025/09/14 01:12:56 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:12:56 simple.go:117: address:www.so.com:443
2025/09/14 01:12:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:12:56 options.go:98: hostname www.so.com no ip found
2025/09/14 01:12:56 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:12:56 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:12:56 simple.go:57: remote addr: [::1]:39515
2025/09/14 01:12:56 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:12:56 simple.go:117: address:www.baidu.com:443
2025/09/14 01:12:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:12:56 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:12:56 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:12:56 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11904522441405846353
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11904522441405846353
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=u7rkth21uvv3duhkmkjm6qmbd5; expires=Sat, 13-Sep-2025 17:22:40 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=6170AB1455AED11D15FAE188FC94C44D.1757783560460; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:12:40 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=u7rkth21uvv3duhkmkjm6qmbd5; expires=Sat, 13-Sep-2025 17:22:40 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=6170AB1455AED11D15FAE188FC94C44D.1757783560460; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11432493217373461392
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11432493217373461392
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:13:02

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 25160

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 5324

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11746253304547802643
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11746253304547802643


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 33732

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=pjk7cijiklh1b6vcstsl4fmpo5; expires=Sat, 13-Sep-2025 17:22:50 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=C3BB93653A7BC9CAA0D0318D4227F966.1757783570656; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:12:50 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=pjk7cijiklh1b6vcstsl4fmpo5; expires=Sat, 13-Sep-2025 17:22:50 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=C3BB93653A7BC9CAA0D0318D4227F966.1757783570656; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 40252

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8561368074000356417
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8561368074000356417


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 25160, 5324, 33732, 40252



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:13:02

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 25160

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 5324

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11746253304547802643
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11746253304547802643


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 33732

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=pjk7cijiklh1b6vcstsl4fmpo5; expires=Sat, 13-Sep-2025 17:22:50 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=C3BB93653A7BC9CAA0D0318D4227F966.1757783570656; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:12:50 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=pjk7cijiklh1b6vcstsl4fmpo5; expires=Sat, 13-Sep-2025 17:22:50 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=C3BB93653A7BC9CAA0D0318D4227F966.1757783570656; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 40252

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8561368074000356417
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8561368074000356417


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 25160, 5324, 33732, 40252

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:13:03 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:13:03 main.go:562: dohalpn: []
2025/09/14 01:13:03 main.go:564: hostname: 0.0.0.0
2025/09/14 01:13:03 main.go:566: port: 8080
2025/09/14 01:13:03 main.go:568: server_cert: 
2025/09/14 01:13:03 main.go:570: server_key: 
2025/09/14 01:13:03 main.go:572: username: 
2025/09/14 01:13:03 main.go:574: password: 
2025/09/14 01:13:03 main.go:576: dohurl: []
2025/09/14 01:13:03 main.go:578: dohip: []
2025/09/14 01:13:03 main.go:579: upstream-type: 
2025/09/14 01:13:03 main.go:580: upstream-address: 
2025/09/14 01:13:03 main.go:581: upstream-username: 
2025/09/14 01:13:03 main.go:582: upstream-password: 
2025/09/14 01:13:03 main.go:854: null
2025/09/14 01:13:03 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:13:03 http.go:372: Random IP: 127.255.185.186
2025/09/14 01:13:03 http.go:390: Random integer: 39199
2025/09/14 01:13:03 http.go:342: Proxy server started on port 127.255.185.186:39199
2025/09/14 01:13:04 simple.go:57: remote addr: [::1]:39561
2025/09/14 01:13:04 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:13:04 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:13:04 simple.go:117: address:www.baidu.com:80
2025/09/14 01:13:04 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.255.185.186:39199
2025/09/14 01:13:04 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.255.185.186:39199
2025/09/14 01:13:04 simple.go:248: clienthost: ::1
2025/09/14 01:13:04 simple.go:249: clientport: 39561
2025/09/14 01:13:04 simple.go:278: simple Handle header:
2025/09/14 01:13:04 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:13:04 simple.go:283: GET / HTTP/1.1
2025/09/14 01:13:04 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:13:04 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:13:04 http.go:90: method: GET
2025/09/14 01:13:04 http.go:91: url: /
2025/09/14 01:13:04 http.go:92: host: www.baidu.com
2025/09/14 01:13:04 http.go:93: proxyHandler header:
2025/09/14 01:13:04 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:13:04 http.go:121: clientport: 39562
2025/09/14 01:13:04 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.255.185.186:39199;host=www.baidu.com;proto=http
2025/09/14 01:13:04 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:13:04 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:13:04 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.255.185.186:39199;host=www.baidu.com;proto=http
2025/09/14 01:13:04 http.go:137: forwardedByList: [{[::1]:8080} {127.255.185.186:39199}]
2025/09/14 01:13:04 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:13:04 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:13:04 | 200 |     49.9368ms |       127.0.0.1 | GET      "/"
2025/09/14 01:13:06 simple.go:57: remote addr: [::1]:39568
2025/09/14 01:13:06 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:13:06 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:13:06 simple.go:117: address:www.baidu.com:80
2025/09/14 01:13:06 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.255.185.186:39199
2025/09/14 01:13:06 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.255.185.186:39199
2025/09/14 01:13:06 simple.go:248: clienthost: ::1
2025/09/14 01:13:06 simple.go:249: clientport: 39568
2025/09/14 01:13:06 simple.go:278: simple Handle header:
2025/09/14 01:13:06 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:13:06 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:13:06 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:13:06 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:13:06 http.go:90: method: HEAD
2025/09/14 01:13:06 http.go:91: url: /
2025/09/14 01:13:06 http.go:92: host: www.baidu.com
2025/09/14 01:13:06 http.go:93: proxyHandler header:
2025/09/14 01:13:06 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:13:06 http.go:121: clientport: 39569
2025/09/14 01:13:06 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:13:06 http.go:132: proxyHandler Accept : */*
2025/09/14 01:13:06 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:13:06 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.255.185.186:39199;host=www.baidu.com;proto=http
2025/09/14 01:13:06 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.255.185.186:39199;host=www.baidu.com;proto=http
2025/09/14 01:13:06 http.go:137: forwardedByList: [{[::1]:8080} {127.255.185.186:39199}]
2025/09/14 01:13:06 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:13:06 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:13:06 | 200 |     19.3092ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:13:06 simple.go:57: remote addr: [::1]:39570
2025/09/14 01:13:06 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:13:06 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:13:06 simple.go:117: address:www.so.com:80
2025/09/14 01:13:06 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.255.185.186:39199
2025/09/14 01:13:06 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.255.185.186:39199
2025/09/14 01:13:06 simple.go:248: clienthost: ::1
2025/09/14 01:13:06 simple.go:249: clientport: 39570
2025/09/14 01:13:06 simple.go:278: simple Handle header:
2025/09/14 01:13:06 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:13:06 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:13:06 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:13:06 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:13:06 http.go:90: method: HEAD
2025/09/14 01:13:06 http.go:91: url: /
2025/09/14 01:13:06 http.go:92: host: www.so.com
2025/09/14 01:13:06 http.go:93: proxyHandler header:
2025/09/14 01:13:06 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:13:06 http.go:121: clientport: 39571
2025/09/14 01:13:06 http.go:132: proxyHandler Accept : */*
2025/09/14 01:13:06 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:13:06 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.255.185.186:39199;host=www.so.com;proto=http
2025/09/14 01:13:06 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:13:06 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.255.185.186:39199;host=www.so.com;proto=http
2025/09/14 01:13:06 http.go:137: forwardedByList: [{[::1]:8080} {127.255.185.186:39199}]
2025/09/14 01:13:06 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:13:06 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:13:06 | 302 |      30.449ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:13:06 simple.go:57: remote addr: [::1]:39573
2025/09/14 01:13:06 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:13:06 simple.go:117: address:www.so.com:443
2025/09/14 01:13:06 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:13:06 options.go:98: hostname www.so.com no ip found
2025/09/14 01:13:06 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:13:06 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:13:06 simple.go:57: remote addr: [::1]:39583
2025/09/14 01:13:06 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:13:06 simple.go:117: address:www.baidu.com:443
2025/09/14 01:13:06 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:13:06 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:13:06 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:13:06 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11746253304547802643
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11746253304547802643
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=pjk7cijiklh1b6vcstsl4fmpo5; expires=Sat, 13-Sep-2025 17:22:50 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=C3BB93653A7BC9CAA0D0318D4227F966.1757783570656; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:12:50 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=pjk7cijiklh1b6vcstsl4fmpo5; expires=Sat, 13-Sep-2025 17:22:50 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=C3BB93653A7BC9CAA0D0318D4227F966.1757783570656; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:12:50 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8561368074000356417
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:12:50 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8561368074000356417
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# WebSocketå’Œhttpçº§è”æµ‹è¯•è¶…æ—¶è®°å½•

## è¶…æ—¶æ—¶é—´
2025-09-14 01:13:47

âŒ æµ‹è¯•æ‰§è¡Œè¶…è¿‡35ç§’è¶…æ—¶é™åˆ¶ï¼Œå¼ºåˆ¶é€€å‡º

å¯èƒ½çš„åŽŸå› :
- æœåŠ¡å™¨è¿›ç¨‹æœªæ­£å¸¸é€€å‡º
- curlå‘½ä»¤å¡ä½
- ç½‘ç»œè¿žæŽ¥é—®é¢˜
- çº§è”ä»£ç†é…ç½®é—®é¢˜

å·²å°è¯•ç»ˆæ­¢æ‰€æœ‰ç›¸å…³è¿›ç¨‹



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:17:15

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 12748

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 37200

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9737617530607727559
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9737617530607727559


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 22412

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=npdhn2kul70hnoqd82mucnc0a2; expires=Sat, 13-Sep-2025 17:27:04 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=E623F560E48838B819A01113EEE661D5.1757783824533; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:17:04 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=npdhn2kul70hnoqd82mucnc0a2; expires=Sat, 13-Sep-2025 17:27:04 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=E623F560E48838B819A01113EEE661D5.1757783824533; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 38504

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8834924252019451636
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8834924252019451636


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 12748, 37200, 22412, 38504



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:17:15

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 12748

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 37200

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9737617530607727559
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9737617530607727559


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 22412

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=npdhn2kul70hnoqd82mucnc0a2; expires=Sat, 13-Sep-2025 17:27:04 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=E623F560E48838B819A01113EEE661D5.1757783824533; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:17:04 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=npdhn2kul70hnoqd82mucnc0a2; expires=Sat, 13-Sep-2025 17:27:04 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=E623F560E48838B819A01113EEE661D5.1757783824533; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 38504

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8834924252019451636
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8834924252019451636


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 12748, 37200, 22412, 38504

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:17:17 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:17:17 main.go:562: dohalpn: []
2025/09/14 01:17:17 main.go:564: hostname: 0.0.0.0
2025/09/14 01:17:17 main.go:566: port: 8080
2025/09/14 01:17:17 main.go:568: server_cert: 
2025/09/14 01:17:17 main.go:570: server_key: 
2025/09/14 01:17:17 main.go:572: username: 
2025/09/14 01:17:17 main.go:574: password: 
2025/09/14 01:17:17 main.go:576: dohurl: []
2025/09/14 01:17:17 main.go:578: dohip: []
2025/09/14 01:17:17 main.go:579: upstream-type: 
2025/09/14 01:17:17 main.go:580: upstream-address: 
2025/09/14 01:17:17 main.go:581: upstream-username: 
2025/09/14 01:17:17 main.go:582: upstream-password: 
2025/09/14 01:17:17 main.go:854: null
2025/09/14 01:17:17 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:17:17 http.go:372: Random IP: 127.125.87.252
2025/09/14 01:17:17 http.go:390: Random integer: 21821
2025/09/14 01:17:17 http.go:342: Proxy server started on port 127.125.87.252:21821
2025/09/14 01:17:18 simple.go:57: remote addr: [::1]:42642
2025/09/14 01:17:18 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:17:18 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:17:18 simple.go:117: address:www.baidu.com:80
2025/09/14 01:17:18 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.125.87.252:21821
2025/09/14 01:17:18 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.125.87.252:21821
2025/09/14 01:17:18 simple.go:248: clienthost: ::1
2025/09/14 01:17:18 simple.go:249: clientport: 42642
2025/09/14 01:17:18 simple.go:278: simple Handle header:
2025/09/14 01:17:18 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:18 simple.go:283: GET / HTTP/1.1
2025/09/14 01:17:18 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:18 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:17:18 http.go:90: method: GET
2025/09/14 01:17:18 http.go:91: url: /
2025/09/14 01:17:18 http.go:92: host: www.baidu.com
2025/09/14 01:17:18 http.go:93: proxyHandler header:
2025/09/14 01:17:18 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:18 http.go:121: clientport: 42643
2025/09/14 01:17:18 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:17:18 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.125.87.252:21821;host=www.baidu.com;proto=http
2025/09/14 01:17:18 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:17:18 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.125.87.252:21821;host=www.baidu.com;proto=http
2025/09/14 01:17:18 http.go:137: forwardedByList: [{[::1]:8080} {127.125.87.252:21821}]
2025/09/14 01:17:18 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:17:18 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:17:18 | 200 |    116.8143ms |       127.0.0.1 | GET      "/"
2025/09/14 01:17:20 simple.go:57: remote addr: [::1]:42670
2025/09/14 01:17:20 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:17:20 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:17:20 simple.go:117: address:www.baidu.com:80
2025/09/14 01:17:20 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.125.87.252:21821
2025/09/14 01:17:20 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.125.87.252:21821
2025/09/14 01:17:20 simple.go:248: clienthost: ::1
2025/09/14 01:17:20 simple.go:249: clientport: 42670
2025/09/14 01:17:20 simple.go:278: simple Handle header:
2025/09/14 01:17:20 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:20 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:17:20 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:20 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:17:20 http.go:90: method: HEAD
2025/09/14 01:17:20 http.go:91: url: /
2025/09/14 01:17:20 http.go:92: host: www.baidu.com
2025/09/14 01:17:20 http.go:93: proxyHandler header:
2025/09/14 01:17:20 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:20 http.go:121: clientport: 42671
2025/09/14 01:17:20 http.go:132: proxyHandler Accept : */*
2025/09/14 01:17:20 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:17:20 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.125.87.252:21821;host=www.baidu.com;proto=http
2025/09/14 01:17:20 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:17:20 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.125.87.252:21821;host=www.baidu.com;proto=http
2025/09/14 01:17:20 http.go:137: forwardedByList: [{[::1]:8080} {127.125.87.252:21821}]
2025/09/14 01:17:20 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:17:20 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:17:20 | 200 |     31.1949ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:17:20 simple.go:57: remote addr: [::1]:42672
2025/09/14 01:17:20 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:17:20 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:17:20 simple.go:117: address:www.so.com:80
2025/09/14 01:17:20 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.125.87.252:21821
2025/09/14 01:17:20 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.125.87.252:21821
2025/09/14 01:17:20 simple.go:248: clienthost: ::1
2025/09/14 01:17:20 simple.go:249: clientport: 42672
2025/09/14 01:17:20 simple.go:278: simple Handle header:
2025/09/14 01:17:20 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:17:20 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:17:20 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:17:20 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:17:20 http.go:90: method: HEAD
2025/09/14 01:17:20 http.go:91: url: /
2025/09/14 01:17:20 http.go:92: host: www.so.com
2025/09/14 01:17:20 http.go:93: proxyHandler header:
2025/09/14 01:17:20 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:20 http.go:121: clientport: 42673
2025/09/14 01:17:20 http.go:132: proxyHandler Accept : */*
2025/09/14 01:17:20 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:17:20 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.125.87.252:21821;host=www.so.com;proto=http
2025/09/14 01:17:20 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:17:20 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.125.87.252:21821;host=www.so.com;proto=http
2025/09/14 01:17:20 http.go:137: forwardedByList: [{[::1]:8080} {127.125.87.252:21821}]
2025/09/14 01:17:20 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:17:20 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:17:20 | 302 |     73.8867ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:17:20 simple.go:57: remote addr: [::1]:42681
2025/09/14 01:17:20 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:17:20 simple.go:117: address:www.so.com:443
2025/09/14 01:17:20 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:17:20 options.go:98: hostname www.so.com no ip found
2025/09/14 01:17:20 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:17:20 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:17:20 simple.go:57: remote addr: [::1]:42686
2025/09/14 01:17:20 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:17:20 simple.go:117: address:www.baidu.com:443
2025/09/14 01:17:20 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:17:20 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:17:20 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:17:20 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9737617530607727559
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9737617530607727559
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=npdhn2kul70hnoqd82mucnc0a2; expires=Sat, 13-Sep-2025 17:27:04 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=E623F560E48838B819A01113EEE661D5.1757783824533; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:17:04 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=npdhn2kul70hnoqd82mucnc0a2; expires=Sat, 13-Sep-2025 17:27:04 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=E623F560E48838B819A01113EEE661D5.1757783824533; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:04 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8834924252019451636
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:04 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8834924252019451636
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:17:26

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 37892

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 37064

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12100033192509180451
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12100033192509180451


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 12068

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=5nv5p084panelt3s4aqjj57194; expires=Sat, 13-Sep-2025 17:27:14 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=BBBA60E0B56B3FD83C80F1F05FC51B05.1757783834690; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:17:14 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=5nv5p084panelt3s4aqjj57194; expires=Sat, 13-Sep-2025 17:27:14 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=BBBA60E0B56B3FD83C80F1F05FC51B05.1757783834690; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 2512

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12102339856219504458
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12102339856219504458


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 37892, 37064, 12068, 2512



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:17:26

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 37892

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 37064

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12100033192509180451
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12100033192509180451


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 12068

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=5nv5p084panelt3s4aqjj57194; expires=Sat, 13-Sep-2025 17:27:14 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=BBBA60E0B56B3FD83C80F1F05FC51B05.1757783834690; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:17:14 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=5nv5p084panelt3s4aqjj57194; expires=Sat, 13-Sep-2025 17:27:14 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=BBBA60E0B56B3FD83C80F1F05FC51B05.1757783834690; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 2512

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12102339856219504458
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12102339856219504458


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 37892, 37064, 12068, 2512

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:17:27 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:17:27 main.go:562: dohalpn: []
2025/09/14 01:17:27 main.go:564: hostname: 0.0.0.0
2025/09/14 01:17:27 main.go:566: port: 8080
2025/09/14 01:17:27 main.go:568: server_cert: 
2025/09/14 01:17:27 main.go:570: server_key: 
2025/09/14 01:17:27 main.go:572: username: 
2025/09/14 01:17:27 main.go:574: password: 
2025/09/14 01:17:27 main.go:576: dohurl: []
2025/09/14 01:17:27 main.go:578: dohip: []
2025/09/14 01:17:27 main.go:579: upstream-type: 
2025/09/14 01:17:27 main.go:580: upstream-address: 
2025/09/14 01:17:27 main.go:581: upstream-username: 
2025/09/14 01:17:27 main.go:582: upstream-password: 
2025/09/14 01:17:27 main.go:854: null
2025/09/14 01:17:27 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:17:27 http.go:372: Random IP: 127.158.28.247
2025/09/14 01:17:27 http.go:390: Random integer: 13486
2025/09/14 01:17:27 http.go:342: Proxy server started on port 127.158.28.247:13486
2025/09/14 01:17:28 simple.go:57: remote addr: [::1]:42768
2025/09/14 01:17:28 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:17:28 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:17:28 simple.go:117: address:www.baidu.com:80
2025/09/14 01:17:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.158.28.247:13486
2025/09/14 01:17:28 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.158.28.247:13486
2025/09/14 01:17:28 simple.go:248: clienthost: ::1
2025/09/14 01:17:28 simple.go:249: clientport: 42768
2025/09/14 01:17:28 simple.go:278: simple Handle header:
2025/09/14 01:17:28 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:28 simple.go:283: GET / HTTP/1.1
2025/09/14 01:17:28 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:28 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:17:28 http.go:90: method: GET
2025/09/14 01:17:28 http.go:91: url: /
2025/09/14 01:17:28 http.go:92: host: www.baidu.com
2025/09/14 01:17:28 http.go:93: proxyHandler header:
2025/09/14 01:17:28 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:28 http.go:121: clientport: 42769
2025/09/14 01:17:28 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:17:28 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.158.28.247:13486;host=www.baidu.com;proto=http
2025/09/14 01:17:28 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:17:28 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.158.28.247:13486;host=www.baidu.com;proto=http
2025/09/14 01:17:28 http.go:137: forwardedByList: [{[::1]:8080} {127.158.28.247:13486}]
2025/09/14 01:17:28 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:17:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:17:28 | 200 |     59.2635ms |       127.0.0.1 | GET      "/"
2025/09/14 01:17:30 simple.go:57: remote addr: [::1]:42800
2025/09/14 01:17:30 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:17:30 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:17:30 simple.go:117: address:www.baidu.com:80
2025/09/14 01:17:30 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.158.28.247:13486
2025/09/14 01:17:30 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.158.28.247:13486
2025/09/14 01:17:30 simple.go:248: clienthost: ::1
2025/09/14 01:17:30 simple.go:249: clientport: 42800
2025/09/14 01:17:30 simple.go:278: simple Handle header:
2025/09/14 01:17:30 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:30 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:17:30 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:17:30 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:17:30 http.go:90: method: HEAD
2025/09/14 01:17:30 http.go:91: url: /
2025/09/14 01:17:30 http.go:92: host: www.baidu.com
2025/09/14 01:17:30 http.go:93: proxyHandler header:
2025/09/14 01:17:30 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:30 http.go:121: clientport: 42801
2025/09/14 01:17:30 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.158.28.247:13486;host=www.baidu.com;proto=http
2025/09/14 01:17:30 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:17:30 http.go:132: proxyHandler Accept : */*
2025/09/14 01:17:30 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:17:30 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.158.28.247:13486;host=www.baidu.com;proto=http
2025/09/14 01:17:30 http.go:137: forwardedByList: [{[::1]:8080} {127.158.28.247:13486}]
2025/09/14 01:17:30 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:17:30 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:17:30 | 200 |     39.7775ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:17:30 simple.go:57: remote addr: [::1]:42802
2025/09/14 01:17:30 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:17:30 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:17:30 simple.go:117: address:www.so.com:80
2025/09/14 01:17:30 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.158.28.247:13486
2025/09/14 01:17:30 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.158.28.247:13486
2025/09/14 01:17:30 simple.go:248: clienthost: ::1
2025/09/14 01:17:30 simple.go:249: clientport: 42802
2025/09/14 01:17:30 simple.go:278: simple Handle header:
2025/09/14 01:17:30 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:17:30 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:17:30 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:17:30 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:17:30 http.go:90: method: HEAD
2025/09/14 01:17:30 http.go:91: url: /
2025/09/14 01:17:30 http.go:92: host: www.so.com
2025/09/14 01:17:30 http.go:93: proxyHandler header:
2025/09/14 01:17:30 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:30 http.go:121: clientport: 42803
2025/09/14 01:17:30 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.158.28.247:13486;host=www.so.com;proto=http
2025/09/14 01:17:30 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:17:30 http.go:132: proxyHandler Accept : */*
2025/09/14 01:17:30 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:17:30 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.158.28.247:13486;host=www.so.com;proto=http
2025/09/14 01:17:30 http.go:137: forwardedByList: [{[::1]:8080} {127.158.28.247:13486}]
2025/09/14 01:17:30 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:17:30 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:17:30 | 302 |     29.5907ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:17:30 simple.go:57: remote addr: [::1]:42805
2025/09/14 01:17:30 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:17:30 simple.go:117: address:www.so.com:443
2025/09/14 01:17:30 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:17:30 options.go:98: hostname www.so.com no ip found
2025/09/14 01:17:30 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:17:30 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:17:30 simple.go:57: remote addr: [::1]:42813
2025/09/14 01:17:30 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:17:30 simple.go:117: address:www.baidu.com:443
2025/09/14 01:17:30 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:17:30 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:17:30 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:17:30 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12100033192509180451
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12100033192509180451
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=5nv5p084panelt3s4aqjj57194; expires=Sat, 13-Sep-2025 17:27:14 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=BBBA60E0B56B3FD83C80F1F05FC51B05.1757783834690; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:17:14 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=5nv5p084panelt3s4aqjj57194; expires=Sat, 13-Sep-2025 17:27:14 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=BBBA60E0B56B3FD83C80F1F05FC51B05.1757783834690; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:14 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12102339856219504458
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:14 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12102339856219504458
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:17:36

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 6188

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 40152

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 9220, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:26 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11772985825386956629
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:26 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11772985825386956629


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 39488, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:26 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12156699822735828105
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:26 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12156699822735828105


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 6188, 40152, 9220, 39488



###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:17:36

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 6188

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 40152

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 9220, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:26 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11772985825386956629
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:26 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11772985825386956629


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 39488, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:17:26 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12156699822735828105
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:17:26 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12156699822735828105


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 6188, 40152, 9220, 39488

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹...
âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹...
âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...
âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:17:38 main.go:71: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :38800
2025/09/14 01:17:38 server.go:71: [WEBSOCKET-SERVER] Server started successfully, listening on :38800
2025/09/14 01:17:38 server.go:72: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 01:17:38 server.go:74: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 01:17:38 server.go:75: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 01:17:38 main.go:129: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 01:17:40 server.go:90: url /
2025/09/14 01:17:40 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[DYOXiWtgIzVupaaMa7M4cQ==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.225.59.57] X-Proxy-Target-Port:[62145]]
2025/09/14 01:17:40 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42942 at 2025-09-14 01:17:40
2025/09/14 01:17:40 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42942
2025/09/14 01:17:40 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.225.59.57', targetPort: 62145
2025/09/14 01:17:40 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:17:40 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42942
2025/09/14 01:17:40 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.225.59.57:62145 from [::1]:42942
2025/09/14 01:17:40 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.225.59.57:62145 (timeout: 30s)
2025/09/14 01:17:40 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.225.59.57:62145
2025/09/14 01:17:40 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 01:17:40 server.go:90: url /
2025/09/14 01:17:40 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[FzIJQJmxpAuboxNUAEHU3g==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 01:17:40 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42944 at 2025-09-14 01:17:40
2025/09/14 01:17:40 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42944
2025/09/14 01:17:40 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 01:17:40 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:17:40 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42944
2025/09/14 01:17:40 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:42944
2025/09/14 01:17:40 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 01:17:40 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 01:17:40 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 01:17:42 server.go:90: url /
2025/09/14 01:17:42 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[a0DgVrGhpmVR7YQFgHMUWQ==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.225.59.57] X-Proxy-Target-Port:[62145]]
2025/09/14 01:17:42 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42972 at 2025-09-14 01:17:42
2025/09/14 01:17:42 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42972
2025/09/14 01:17:42 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.225.59.57', targetPort: 62145
2025/09/14 01:17:42 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:17:42 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42972
2025/09/14 01:17:42 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.225.59.57:62145 from [::1]:42972
2025/09/14 01:17:42 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.225.59.57:62145 (timeout: 30s)
2025/09/14 01:17:42 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.225.59.57:62145
2025/09/14 01:17:42 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 01:17:42 server.go:90: url /
2025/09/14 01:17:42 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[XCW2woEauunfV5jXo2i2Sg==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 01:17:42 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42975 at 2025-09-14 01:17:42
2025/09/14 01:17:42 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42975
2025/09/14 01:17:42 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 01:17:42 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:17:42 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42975
2025/09/14 01:17:42 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:42975
2025/09/14 01:17:42 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 01:17:42 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 01:17:42 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
```

### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:17:39 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:17:39 main.go:562: dohalpn: []
2025/09/14 01:17:39 main.go:564: hostname: 0.0.0.0
2025/09/14 01:17:39 main.go:566: port: 10810
2025/09/14 01:17:39 main.go:568: server_cert: 
2025/09/14 01:17:39 main.go:570: server_key: 
2025/09/14 01:17:39 main.go:572: username: 
2025/09/14 01:17:39 main.go:574: password: 
2025/09/14 01:17:39 main.go:576: dohurl: []
2025/09/14 01:17:39 main.go:578: dohip: []
2025/09/14 01:17:39 main.go:579: upstream-type: websocket
2025/09/14 01:17:39 main.go:580: upstream-address: ws://localhost:38800
2025/09/14 01:17:39 main.go:581: upstream-username: 
2025/09/14 01:17:39 main.go:582: upstream-password: 
2025/09/14 01:17:39 main.go:639: WebSocketä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 01:17:39 main.go:854: {
  "hostname": "",
  "port": 0,
  "server_cert": "",
  "server_key": "",
  "username": "",
  "password": "",
  "doh": null,
  "upstreams": {
    "websocket_upstream": {
      "type": "websocket",
      "http_proxy": "",
      "https_proxy": "",
      "bypass_list": [],
      "ws_proxy": "ws://localhost:38800",
      "ws_username": "",
      "ws_password": "",
      "http_username": "",
      "http_password": "",
      "socks5_proxy": "",
      "socks5_username": "",
      "socks5_password": ""
    }
  },
  "rules": [
    {
      "filter": "websocket_filter",
      "upstream": "websocket_upstream"
    }
  ],
  "filters": {
    "websocket_filter": {
      "patterns": [
        "*"
      ]
    }
  }
}
2025/09/14 01:17:39 simple.go:31: Proxy server started on port [::]:10810
2025/09/14 01:17:39 http.go:372: Random IP: 127.225.59.57
2025/09/14 01:17:39 http.go:390: Random integer: 62145
2025/09/14 01:17:39 http.go:342: Proxy server started on port 127.225.59.57:62145
2025/09/14 01:17:40 simple.go:57: remote addr: [::1]:42941
2025/09/14 01:17:40 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:17:40 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:17:40 simple.go:117: address:www.baidu.com:80
2025/09/14 01:17:40 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.225.59.57:62145
2025/09/14 01:17:40 main.go:791: ProxySelector 127.225.59.57:62145
2025/09/14 01:17:40 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:17:40 simple.go:179: WebSocket Config Details:
2025/09/14 01:17:40 simple.go:180: host, portNum 127.225.59.57 62145
2025/09/14 01:17:40 simple.go:181:   Username: 
2025/09/14 01:17:40 simple.go:182:   Password: 
2025/09/14 01:17:40 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 01:17:40 simple.go:184:   Protocol: websocket
2025/09/14 01:17:40 simple.go:185:   Timeout: 30s
2025/09/14 01:17:40 client.go:98: url: ws://localhost:38800
2025/09/14 01:17:40 client.go:99: headers: map[X-Proxy-Target-Host:[127.225.59.57] X-Proxy-Target-Port:[62145]]
2025/09/14 01:17:40 client.go:110: url: http://localhost:38800
2025/09/14 01:17:40 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[viPbSSk8buzLYPmKjURIS9wedbg=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 01:17:40 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.225.59.57:62145
2025/09/14 01:17:40 simple.go:248: clienthost: ::1
2025/09/14 01:17:40 simple.go:249: clientport: 42941
2025/09/14 01:17:40 simple.go:278: simple Handle header:
2025/09/14 01:17:40 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:17:40 simple.go:283: GET / HTTP/1.1
2025/09/14 01:17:40 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:17:40 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:17:40 http.go:90: method: GET
2025/09/14 01:17:40 http.go:91: url: /
2025/09/14 01:17:40 http.go:92: host: www.baidu.com
2025/09/14 01:17:40 http.go:93: proxyHandler header:
2025/09/14 01:17:40 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:40 http.go:121: clientport: 42943
2025/09/14 01:17:40 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.225.59.57:62145;host=www.baidu.com;proto=http
2025/09/14 01:17:40 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:17:40 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:17:40 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.225.59.57:62145;host=www.baidu.com;proto=http
2025/09/14 01:17:40 http.go:137: forwardedByList: [{[::1]:10810} {127.225.59.57:62145}]
2025/09/14 01:17:40 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:17:40 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 01:17:40 main.go:791: ProxySelector www.baidu.com
2025/09/14 01:17:40 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:17:40 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 01:17:40 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
2025/09/14 01:17:40 http.go:262: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 01:17:40 http.go:264: network,addr tcp www.baidu.com:80
2025/09/14 01:17:40 http.go:466: WebSocket Config Details:
2025/09/14 01:17:40 http.go:467: host, portNum www.baidu.com 80
2025/09/14 01:17:40 http.go:468:   Username: 
2025/09/14 01:17:40 http.go:469:   Password: 
2025/09/14 01:17:40 http.go:470:   ServerAddr: ws://localhost:38800
2025/09/14 01:17:40 http.go:471:   Protocol: websocket
2025/09/14 01:17:40 http.go:472:   Timeout: 30s
2025/09/14 01:17:40 http.go:476: host, portNum www.baidu.com 80
2025/09/14 01:17:40 client.go:98: url: ws://localhost:38800
2025/09/14 01:17:40 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 01:17:40 client.go:110: url: http://localhost:38800
2025/09/14 01:17:40 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[ZBWbow1lYomH/jCClpzc/F6OyVY=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
[GIN] 2025/09/14 - 01:17:40 | 200 |     59.2856ms |       127.0.0.1 | GET      "/"
2025/09/14 01:17:42 simple.go:57: remote addr: [::1]:42971
2025/09/14 01:17:42 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:17:42 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:17:42 simple.go:117: address:www.baidu.com:80
2025/09/14 01:17:42 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.225.59.57:62145
2025/09/14 01:17:42 main.go:791: ProxySelector 127.225.59.57:62145
2025/09/14 01:17:42 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:17:42 simple.go:179: WebSocket Config Details:
2025/09/14 01:17:42 simple.go:180: host, portNum 127.225.59.57 62145
2025/09/14 01:17:42 simple.go:181:   Username: 
2025/09/14 01:17:42 simple.go:182:   Password: 
2025/09/14 01:17:42 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 01:17:42 simple.go:184:   Protocol: websocket
2025/09/14 01:17:42 simple.go:185:   Timeout: 30s
2025/09/14 01:17:42 client.go:98: url: ws://localhost:38800
2025/09/14 01:17:42 client.go:99: headers: map[X-Proxy-Target-Host:[127.225.59.57] X-Proxy-Target-Port:[62145]]
2025/09/14 01:17:42 client.go:110: url: http://localhost:38800
2025/09/14 01:17:42 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[1WdcxGXENh/4CDnx4oypzcBHN2I=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 01:17:42 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.225.59.57:62145
2025/09/14 01:17:42 simple.go:248: clienthost: ::1
2025/09/14 01:17:42 simple.go:249: clientport: 42971
2025/09/14 01:17:42 simple.go:278: simple Handle header:
2025/09/14 01:17:42 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:17:42 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:17:42 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:17:42 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:17:42 http.go:90: method: HEAD
2025/09/14 01:17:42 http.go:91: url: /
2025/09/14 01:17:42 http.go:92: host: www.baidu.com
2025/09/14 01:17:42 http.go:93: proxyHandler header:
2025/09/14 01:17:42 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:17:42 http.go:121: clientport: 42973
2025/09/14 01:17:42 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.225.59.57:62145;host=www.baidu.com;proto=http
2025/09/14 01:17:42 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:17:42 http.go:132: proxyHandler Accept : */*
2025/09/14 01:17:42 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:17:42 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.225.59.57:62145;host=www.baidu.com;proto=http
2025/09/14 01:17:42 http.go:137: forwardedByList: [{[::1]:10810} {127.225.59.57:62145}]
2025/09/14 01:17:42 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:17:42 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 01:17:42 main.go:791: ProxySelector www.baidu.com
2025/09/14 01:17:42 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:17:42 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 01:17:42 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
[GIN] 2025/09/14 - 01:17:42 | 200 |     33.3226ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:17:42 simple.go:57: remote addr: [::1]:42974
2025/09/14 01:17:42 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:17:42 simple.go:117: address:www.baidu.com:443
2025/09/14 01:17:42 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:17:42 main.go:791: ProxySelector www.baidu.com:443
2025/09/14 01:17:42 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:17:42 simple.go:179: WebSocket Config Details:
2025/09/14 01:17:42 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 01:17:42 simple.go:181:   Username: 
2025/09/14 01:17:42 simple.go:182:   Password: 
2025/09/14 01:17:42 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 01:17:42 simple.go:184:   Protocol: websocket
2025/09/14 01:17:42 simple.go:185:   Timeout: 30s
2025/09/14 01:17:42 client.go:98: url: ws://localhost:38800
2025/09/14 01:17:42 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 01:17:42 client.go:110: url: http://localhost:38800
2025/09/14 01:17:42 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[XC5aJ/WfNTInHAWOqrVfHYFaRqg=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 01:17:42 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
2025/09/14 01:17:42 simple.go:204: WebSocket ForwardData error: read tcp [::1]:42942->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 01:17:42 http.go:493: WebSocket ForwardData error: read tcp [::1]:42944->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 01:17:42 simple.go:204: WebSocket ForwardData error: read tcp [::1]:42975->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 01:17:42 simple.go:204: WebSocket ForwardData error: read tcp [::1]:42972->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
```

âœ… ç«¯å£38800å·²æˆåŠŸé‡Šæ”¾
âœ… ç«¯å£10810å·²æˆåŠŸé‡Šæ”¾


###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:34:23

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 36072

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 40420

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11934198097074938811
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11934198097074938811


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 30312

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=3rvojbed0s5kb1p8tdeotrt9p7; expires=Sat, 13-Sep-2025 17:44:11 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=636511C24762E526A6550101C017DA31.1757784851592; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:34:11 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=3rvojbed0s5kb1p8tdeotrt9p7; expires=Sat, 13-Sep-2025 17:44:11 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=636511C24762E526A6550101C017DA31.1757784851592; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 25580

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8979890500803855582
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8979890500803855582


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 36072, 40420, 30312, 25580



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:34:23

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 36072

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 40420

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11934198097074938811
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11934198097074938811


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 30312

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=3rvojbed0s5kb1p8tdeotrt9p7; expires=Sat, 13-Sep-2025 17:44:11 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=636511C24762E526A6550101C017DA31.1757784851592; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:34:11 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=3rvojbed0s5kb1p8tdeotrt9p7; expires=Sat, 13-Sep-2025 17:44:11 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=636511C24762E526A6550101C017DA31.1757784851592; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 25580

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8979890500803855582
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8979890500803855582


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 36072, 40420, 30312, 25580

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:34:24 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:34:24 main.go:562: dohalpn: []
2025/09/14 01:34:24 main.go:564: hostname: 0.0.0.0
2025/09/14 01:34:24 main.go:566: port: 8080
2025/09/14 01:34:24 main.go:568: server_cert: 
2025/09/14 01:34:24 main.go:570: server_key: 
2025/09/14 01:34:24 main.go:572: username: 
2025/09/14 01:34:24 main.go:574: password: 
2025/09/14 01:34:24 main.go:576: dohurl: []
2025/09/14 01:34:24 main.go:578: dohip: []
2025/09/14 01:34:24 main.go:579: upstream-type: 
2025/09/14 01:34:24 main.go:580: upstream-address: 
2025/09/14 01:34:24 main.go:581: upstream-username: 
2025/09/14 01:34:24 main.go:582: upstream-password: 
2025/09/14 01:34:24 main.go:854: null
2025/09/14 01:34:24 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:34:24 http.go:372: Random IP: 127.198.128.198
2025/09/14 01:34:24 http.go:390: Random integer: 55734
2025/09/14 01:34:24 http.go:342: Proxy server started on port 127.198.128.198:55734
2025/09/14 01:34:25 simple.go:57: remote addr: [::1]:39074
2025/09/14 01:34:25 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:34:25 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:34:25 simple.go:117: address:www.baidu.com:80
2025/09/14 01:34:25 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.198.128.198:55734
2025/09/14 01:34:25 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.198.128.198:55734
2025/09/14 01:34:25 simple.go:248: clienthost: ::1
2025/09/14 01:34:25 simple.go:249: clientport: 39074
2025/09/14 01:34:25 simple.go:278: simple Handle header:
2025/09/14 01:34:25 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:25 simple.go:283: GET / HTTP/1.1
2025/09/14 01:34:25 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:25 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:34:25 http.go:90: method: GET
2025/09/14 01:34:25 http.go:91: url: /
2025/09/14 01:34:25 http.go:92: host: www.baidu.com
2025/09/14 01:34:25 http.go:93: proxyHandler header:
2025/09/14 01:34:25 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:25 http.go:121: clientport: 39075
2025/09/14 01:34:25 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.198.128.198:55734;host=www.baidu.com;proto=http
2025/09/14 01:34:25 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:34:25 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:34:25 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.198.128.198:55734;host=www.baidu.com;proto=http
2025/09/14 01:34:25 http.go:137: forwardedByList: [{[::1]:8080} {127.198.128.198:55734}]
2025/09/14 01:34:25 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:34:25 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:34:25 | 200 |     59.2927ms |       127.0.0.1 | GET      "/"
2025/09/14 01:34:27 simple.go:57: remote addr: [::1]:39115
2025/09/14 01:34:27 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:34:27 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:34:27 simple.go:117: address:www.baidu.com:80
2025/09/14 01:34:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.198.128.198:55734
2025/09/14 01:34:27 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.198.128.198:55734
2025/09/14 01:34:27 simple.go:248: clienthost: ::1
2025/09/14 01:34:27 simple.go:249: clientport: 39115
2025/09/14 01:34:27 simple.go:278: simple Handle header:
2025/09/14 01:34:27 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:27 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:34:27 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:27 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:34:27 http.go:90: method: HEAD
2025/09/14 01:34:27 http.go:91: url: /
2025/09/14 01:34:27 http.go:92: host: www.baidu.com
2025/09/14 01:34:27 http.go:93: proxyHandler header:
2025/09/14 01:34:27 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:27 http.go:121: clientport: 39116
2025/09/14 01:34:27 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:34:27 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.198.128.198:55734;host=www.baidu.com;proto=http
2025/09/14 01:34:27 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:34:27 http.go:132: proxyHandler Accept : */*
2025/09/14 01:34:27 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.198.128.198:55734;host=www.baidu.com;proto=http
2025/09/14 01:34:27 http.go:137: forwardedByList: [{[::1]:8080} {127.198.128.198:55734}]
2025/09/14 01:34:27 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:34:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:34:27 | 200 |     13.3383ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:34:27 simple.go:57: remote addr: [::1]:39117
2025/09/14 01:34:27 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:34:27 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:34:27 simple.go:117: address:www.so.com:80
2025/09/14 01:34:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.198.128.198:55734
2025/09/14 01:34:27 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.198.128.198:55734
2025/09/14 01:34:27 simple.go:248: clienthost: ::1
2025/09/14 01:34:27 simple.go:249: clientport: 39117
2025/09/14 01:34:27 simple.go:278: simple Handle header:
2025/09/14 01:34:27 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:34:27 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:34:27 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:34:27 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:34:27 http.go:90: method: HEAD
2025/09/14 01:34:27 http.go:91: url: /
2025/09/14 01:34:27 http.go:92: host: www.so.com
2025/09/14 01:34:27 http.go:93: proxyHandler header:
2025/09/14 01:34:27 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:27 http.go:121: clientport: 39118
2025/09/14 01:34:27 http.go:132: proxyHandler Accept : */*
2025/09/14 01:34:27 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:34:27 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.198.128.198:55734;host=www.so.com;proto=http
2025/09/14 01:34:27 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:34:27 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.198.128.198:55734;host=www.so.com;proto=http
2025/09/14 01:34:27 http.go:137: forwardedByList: [{[::1]:8080} {127.198.128.198:55734}]
2025/09/14 01:34:27 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:34:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:34:27 | 302 |     41.8404ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:34:27 simple.go:57: remote addr: [::1]:39126
2025/09/14 01:34:27 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:34:27 simple.go:117: address:www.so.com:443
2025/09/14 01:34:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:34:27 options.go:98: hostname www.so.com no ip found
2025/09/14 01:34:27 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:34:27 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:34:27 simple.go:57: remote addr: [::1]:39132
2025/09/14 01:34:27 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:34:27 simple.go:117: address:www.baidu.com:443
2025/09/14 01:34:27 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:34:27 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:34:27 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:34:27 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11934198097074938811
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11934198097074938811
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=3rvojbed0s5kb1p8tdeotrt9p7; expires=Sat, 13-Sep-2025 17:44:11 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=636511C24762E526A6550101C017DA31.1757784851592; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:34:11 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=3rvojbed0s5kb1p8tdeotrt9p7; expires=Sat, 13-Sep-2025 17:44:11 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=636511C24762E526A6550101C017DA31.1757784851592; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8979890500803855582
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8979890500803855582
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:34:33

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 33172

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 35136

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11876608259157673922
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11876608259157673922


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 39084

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=csl6aomcbm7ikjpv4u54o4u7q3; expires=Sat, 13-Sep-2025 17:44:21 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=B688562E1C3FB44F237401EBAFBDBDB6.1757784861534; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:34:21 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=csl6aomcbm7ikjpv4u54o4u7q3; expires=Sat, 13-Sep-2025 17:44:21 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=B688562E1C3FB44F237401EBAFBDBDB6.1757784861534; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 14936

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9244652294484637390
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9244652294484637390


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 33172, 35136, 39084, 14936



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:34:33

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 33172

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 35136

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11876608259157673922
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11876608259157673922


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 39084

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=csl6aomcbm7ikjpv4u54o4u7q3; expires=Sat, 13-Sep-2025 17:44:21 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=B688562E1C3FB44F237401EBAFBDBDB6.1757784861534; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:34:21 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=csl6aomcbm7ikjpv4u54o4u7q3; expires=Sat, 13-Sep-2025 17:44:21 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=B688562E1C3FB44F237401EBAFBDBDB6.1757784861534; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 14936

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9244652294484637390
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9244652294484637390


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 33172, 35136, 39084, 14936

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:34:34 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:34:34 main.go:562: dohalpn: []
2025/09/14 01:34:34 main.go:564: hostname: 0.0.0.0
2025/09/14 01:34:34 main.go:566: port: 8080
2025/09/14 01:34:34 main.go:568: server_cert: 
2025/09/14 01:34:34 main.go:570: server_key: 
2025/09/14 01:34:34 main.go:572: username: 
2025/09/14 01:34:34 main.go:574: password: 
2025/09/14 01:34:34 main.go:576: dohurl: []
2025/09/14 01:34:34 main.go:578: dohip: []
2025/09/14 01:34:34 main.go:579: upstream-type: 
2025/09/14 01:34:34 main.go:580: upstream-address: 
2025/09/14 01:34:34 main.go:581: upstream-username: 
2025/09/14 01:34:34 main.go:582: upstream-password: 
2025/09/14 01:34:34 main.go:854: null
2025/09/14 01:34:34 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:34:34 http.go:372: Random IP: 127.126.65.84
2025/09/14 01:34:34 http.go:390: Random integer: 47150
2025/09/14 01:34:34 http.go:342: Proxy server started on port 127.126.65.84:47150
2025/09/14 01:34:35 simple.go:57: remote addr: [::1]:39195
2025/09/14 01:34:35 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:34:35 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:34:35 simple.go:117: address:www.baidu.com:80
2025/09/14 01:34:35 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.126.65.84:47150
2025/09/14 01:34:35 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.126.65.84:47150
2025/09/14 01:34:35 simple.go:248: clienthost: ::1
2025/09/14 01:34:35 simple.go:249: clientport: 39195
2025/09/14 01:34:35 simple.go:278: simple Handle header:
2025/09/14 01:34:35 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:35 simple.go:283: GET / HTTP/1.1
2025/09/14 01:34:35 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:35 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:34:35 http.go:90: method: GET
2025/09/14 01:34:35 http.go:91: url: /
2025/09/14 01:34:35 http.go:92: host: www.baidu.com
2025/09/14 01:34:35 http.go:93: proxyHandler header:
2025/09/14 01:34:35 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:35 http.go:121: clientport: 39196
2025/09/14 01:34:35 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:34:35 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.126.65.84:47150;host=www.baidu.com;proto=http
2025/09/14 01:34:35 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:34:35 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.126.65.84:47150;host=www.baidu.com;proto=http
2025/09/14 01:34:35 http.go:137: forwardedByList: [{[::1]:8080} {127.126.65.84:47150}]
2025/09/14 01:34:35 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:34:35 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:34:35 | 200 |     91.4489ms |       127.0.0.1 | GET      "/"
2025/09/14 01:34:37 simple.go:57: remote addr: [::1]:39211
2025/09/14 01:34:37 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:34:37 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:34:37 simple.go:117: address:www.baidu.com:80
2025/09/14 01:34:37 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.126.65.84:47150
2025/09/14 01:34:37 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.126.65.84:47150
2025/09/14 01:34:37 simple.go:248: clienthost: ::1
2025/09/14 01:34:37 simple.go:249: clientport: 39211
2025/09/14 01:34:37 simple.go:278: simple Handle header:
2025/09/14 01:34:37 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:37 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:34:37 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:34:37 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:34:37 http.go:90: method: HEAD
2025/09/14 01:34:37 http.go:91: url: /
2025/09/14 01:34:37 http.go:92: host: www.baidu.com
2025/09/14 01:34:37 http.go:93: proxyHandler header:
2025/09/14 01:34:37 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:37 http.go:121: clientport: 39212
2025/09/14 01:34:37 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.126.65.84:47150;host=www.baidu.com;proto=http
2025/09/14 01:34:37 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:34:37 http.go:132: proxyHandler Accept : */*
2025/09/14 01:34:37 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:34:37 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.126.65.84:47150;host=www.baidu.com;proto=http
2025/09/14 01:34:37 http.go:137: forwardedByList: [{[::1]:8080} {127.126.65.84:47150}]
2025/09/14 01:34:37 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:34:37 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:34:37 | 200 |     18.1449ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:34:37 simple.go:57: remote addr: [::1]:39213
2025/09/14 01:34:37 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:34:37 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:34:37 simple.go:117: address:www.so.com:80
2025/09/14 01:34:37 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.126.65.84:47150
2025/09/14 01:34:37 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.126.65.84:47150
2025/09/14 01:34:37 simple.go:248: clienthost: ::1
2025/09/14 01:34:37 simple.go:249: clientport: 39213
2025/09/14 01:34:37 simple.go:278: simple Handle header:
2025/09/14 01:34:37 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:34:37 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:34:37 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:34:37 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:34:37 http.go:90: method: HEAD
2025/09/14 01:34:37 http.go:91: url: /
2025/09/14 01:34:37 http.go:92: host: www.so.com
2025/09/14 01:34:37 http.go:93: proxyHandler header:
2025/09/14 01:34:37 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:37 http.go:121: clientport: 39214
2025/09/14 01:34:37 http.go:132: proxyHandler Accept : */*
2025/09/14 01:34:37 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:34:37 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.126.65.84:47150;host=www.so.com;proto=http
2025/09/14 01:34:37 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:34:37 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.126.65.84:47150;host=www.so.com;proto=http
2025/09/14 01:34:37 http.go:137: forwardedByList: [{[::1]:8080} {127.126.65.84:47150}]
2025/09/14 01:34:37 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:34:37 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:34:37 | 302 |     43.2905ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:34:37 simple.go:57: remote addr: [::1]:39222
2025/09/14 01:34:37 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:34:37 simple.go:117: address:www.so.com:443
2025/09/14 01:34:37 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:34:37 options.go:98: hostname www.so.com no ip found
2025/09/14 01:34:37 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:34:37 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:34:37 simple.go:57: remote addr: [::1]:39227
2025/09/14 01:34:37 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:34:37 simple.go:117: address:www.baidu.com:443
2025/09/14 01:34:37 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:34:37 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:34:37 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:34:37 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11876608259157673922
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11876608259157673922
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=csl6aomcbm7ikjpv4u54o4u7q3; expires=Sat, 13-Sep-2025 17:44:21 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=B688562E1C3FB44F237401EBAFBDBDB6.1757784861534; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:34:21 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=csl6aomcbm7ikjpv4u54o4u7q3; expires=Sat, 13-Sep-2025 17:44:21 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=B688562E1C3FB44F237401EBAFBDBDB6.1757784861534; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:21 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9244652294484637390
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:21 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9244652294484637390
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:34:43

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 34280

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 33052

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 39748, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:32 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9313797059694367087
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:32 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9313797059694367087


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 35768, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:33 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8709760409625575372
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:33 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8709760409625575372


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 34280, 33052, 39748, 35768



###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:34:43

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 34280

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 33052

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 39748, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:32 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_9313797059694367087
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:32 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_9313797059694367087


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 35768, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:34:33 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8709760409625575372
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:34:33 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8709760409625575372


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 34280, 33052, 39748, 35768

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹...
âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹...
âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...
âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:34:44 main.go:71: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :38800
2025/09/14 01:34:44 server.go:71: [WEBSOCKET-SERVER] Server started successfully, listening on :38800
2025/09/14 01:34:44 server.go:72: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 01:34:44 server.go:74: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 01:34:44 server.go:75: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 01:34:44 main.go:129: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 01:34:46 server.go:90: url /
2025/09/14 01:34:46 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[LbM60xzSkI+ywWin7dDY7Q==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.202.41.161] X-Proxy-Target-Port:[16890]]
2025/09/14 01:34:46 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:39341 at 2025-09-14 01:34:46
2025/09/14 01:34:46 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:39341
2025/09/14 01:34:46 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.202.41.161', targetPort: 16890
2025/09/14 01:34:46 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:34:46 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:39341
2025/09/14 01:34:46 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.202.41.161:16890 from [::1]:39341
2025/09/14 01:34:46 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.202.41.161:16890 (timeout: 30s)
2025/09/14 01:34:46 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.202.41.161:16890
2025/09/14 01:34:46 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 01:34:46 server.go:90: url /
2025/09/14 01:34:46 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[prCjtlKK0vbx0byaLBf8Jg==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 01:34:46 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:39343 at 2025-09-14 01:34:46
2025/09/14 01:34:46 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:39343
2025/09/14 01:34:46 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 01:34:46 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:34:46 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:39343
2025/09/14 01:34:46 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:39343
2025/09/14 01:34:46 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 01:34:46 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 01:34:46 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 01:34:49 server.go:90: url /
2025/09/14 01:34:49 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[IcoV59sXwEzkkM87rHfTkA==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.202.41.161] X-Proxy-Target-Port:[16890]]
2025/09/14 01:34:49 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:39346 at 2025-09-14 01:34:49
2025/09/14 01:34:49 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:39346
2025/09/14 01:34:49 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.202.41.161', targetPort: 16890
2025/09/14 01:34:49 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:34:49 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:39346
2025/09/14 01:34:49 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.202.41.161:16890 from [::1]:39346
2025/09/14 01:34:49 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.202.41.161:16890 (timeout: 30s)
2025/09/14 01:34:49 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.202.41.161:16890
2025/09/14 01:34:49 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 01:34:49 server.go:90: url /
2025/09/14 01:34:49 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[woqj8eh2TmZhUYG3OxPNAA==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 01:34:49 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:39349 at 2025-09-14 01:34:49
2025/09/14 01:34:49 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:39349
2025/09/14 01:34:49 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 01:34:49 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 01:34:49 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:39349
2025/09/14 01:34:49 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:39349
2025/09/14 01:34:49 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 01:34:49 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 01:34:49 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
```

### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:34:45 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:34:45 main.go:562: dohalpn: []
2025/09/14 01:34:45 main.go:564: hostname: 0.0.0.0
2025/09/14 01:34:45 main.go:566: port: 10810
2025/09/14 01:34:45 main.go:568: server_cert: 
2025/09/14 01:34:45 main.go:570: server_key: 
2025/09/14 01:34:45 main.go:572: username: 
2025/09/14 01:34:45 main.go:574: password: 
2025/09/14 01:34:45 main.go:576: dohurl: []
2025/09/14 01:34:45 main.go:578: dohip: []
2025/09/14 01:34:45 main.go:579: upstream-type: websocket
2025/09/14 01:34:45 main.go:580: upstream-address: ws://localhost:38800
2025/09/14 01:34:45 main.go:581: upstream-username: 
2025/09/14 01:34:45 main.go:582: upstream-password: 
2025/09/14 01:34:45 main.go:639: WebSocketä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 01:34:45 main.go:854: {
  "hostname": "",
  "port": 0,
  "server_cert": "",
  "server_key": "",
  "username": "",
  "password": "",
  "doh": null,
  "upstreams": {
    "websocket_upstream": {
      "type": "websocket",
      "http_proxy": "",
      "https_proxy": "",
      "bypass_list": [],
      "ws_proxy": "ws://localhost:38800",
      "ws_username": "",
      "ws_password": "",
      "http_username": "",
      "http_password": "",
      "socks5_proxy": "",
      "socks5_username": "",
      "socks5_password": ""
    }
  },
  "rules": [
    {
      "filter": "websocket_filter",
      "upstream": "websocket_upstream"
    }
  ],
  "filters": {
    "websocket_filter": {
      "patterns": [
        "*"
      ]
    }
  }
}
2025/09/14 01:34:45 simple.go:31: Proxy server started on port [::]:10810
2025/09/14 01:34:45 http.go:372: Random IP: 127.202.41.161
2025/09/14 01:34:45 http.go:390: Random integer: 16890
2025/09/14 01:34:45 http.go:342: Proxy server started on port 127.202.41.161:16890
2025/09/14 01:34:46 simple.go:57: remote addr: [::1]:39340
2025/09/14 01:34:46 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:34:46 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:34:46 simple.go:117: address:www.baidu.com:80
2025/09/14 01:34:46 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.202.41.161:16890
2025/09/14 01:34:46 main.go:791: ProxySelector 127.202.41.161:16890
2025/09/14 01:34:46 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:34:46 simple.go:179: WebSocket Config Details:
2025/09/14 01:34:46 simple.go:180: host, portNum 127.202.41.161 16890
2025/09/14 01:34:46 simple.go:181:   Username: 
2025/09/14 01:34:46 simple.go:182:   Password: 
2025/09/14 01:34:46 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 01:34:46 simple.go:184:   Protocol: websocket
2025/09/14 01:34:46 simple.go:185:   Timeout: 30s
2025/09/14 01:34:46 client.go:98: url: ws://localhost:38800
2025/09/14 01:34:46 client.go:99: headers: map[X-Proxy-Target-Host:[127.202.41.161] X-Proxy-Target-Port:[16890]]
2025/09/14 01:34:46 client.go:110: url: http://localhost:38800
2025/09/14 01:34:46 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[ojAQM8e4WrKlb6KG144nZ/P0GCE=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 01:34:46 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.202.41.161:16890
2025/09/14 01:34:46 simple.go:248: clienthost: ::1
2025/09/14 01:34:46 simple.go:249: clientport: 39340
2025/09/14 01:34:46 simple.go:278: simple Handle header:
2025/09/14 01:34:46 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:34:46 simple.go:283: GET / HTTP/1.1
2025/09/14 01:34:46 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:34:46 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:34:46 http.go:90: method: GET
2025/09/14 01:34:46 http.go:91: url: /
2025/09/14 01:34:46 http.go:92: host: www.baidu.com
2025/09/14 01:34:46 http.go:93: proxyHandler header:
2025/09/14 01:34:46 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:46 http.go:121: clientport: 39342
2025/09/14 01:34:46 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.202.41.161:16890;host=www.baidu.com;proto=http
2025/09/14 01:34:46 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:34:46 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:34:46 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.202.41.161:16890;host=www.baidu.com;proto=http
2025/09/14 01:34:46 http.go:137: forwardedByList: [{[::1]:10810} {127.202.41.161:16890}]
2025/09/14 01:34:46 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:34:46 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 01:34:46 main.go:791: ProxySelector www.baidu.com
2025/09/14 01:34:46 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:34:46 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 01:34:46 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
2025/09/14 01:34:46 http.go:262: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 01:34:46 http.go:264: network,addr tcp www.baidu.com:80
2025/09/14 01:34:46 http.go:466: WebSocket Config Details:
2025/09/14 01:34:46 http.go:467: host, portNum www.baidu.com 80
2025/09/14 01:34:46 http.go:468:   Username: 
2025/09/14 01:34:46 http.go:469:   Password: 
2025/09/14 01:34:46 http.go:470:   ServerAddr: ws://localhost:38800
2025/09/14 01:34:46 http.go:471:   Protocol: websocket
2025/09/14 01:34:46 http.go:472:   Timeout: 30s
2025/09/14 01:34:46 http.go:476: host, portNum www.baidu.com 80
2025/09/14 01:34:46 client.go:98: url: ws://localhost:38800
2025/09/14 01:34:46 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 01:34:46 client.go:110: url: http://localhost:38800
2025/09/14 01:34:46 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[sJ+KD1zlFfeWsGHA3T1CsdNPbFQ=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
[GIN] 2025/09/14 - 01:34:46 | 200 |     46.0584ms |       127.0.0.1 | GET      "/"
2025/09/14 01:34:49 simple.go:57: remote addr: [::1]:39345
2025/09/14 01:34:49 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:34:49 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:34:49 simple.go:117: address:www.baidu.com:80
2025/09/14 01:34:49 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.202.41.161:16890
2025/09/14 01:34:49 main.go:791: ProxySelector 127.202.41.161:16890
2025/09/14 01:34:49 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:34:49 simple.go:179: WebSocket Config Details:
2025/09/14 01:34:49 simple.go:180: host, portNum 127.202.41.161 16890
2025/09/14 01:34:49 simple.go:181:   Username: 
2025/09/14 01:34:49 simple.go:182:   Password: 
2025/09/14 01:34:49 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 01:34:49 simple.go:184:   Protocol: websocket
2025/09/14 01:34:49 simple.go:185:   Timeout: 30s
2025/09/14 01:34:49 client.go:98: url: ws://localhost:38800
2025/09/14 01:34:49 client.go:99: headers: map[X-Proxy-Target-Host:[127.202.41.161] X-Proxy-Target-Port:[16890]]
2025/09/14 01:34:49 client.go:110: url: http://localhost:38800
2025/09/14 01:34:49 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[vdCuHoRmIkv7TCnpJwNRqMF/4J0=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 01:34:49 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.202.41.161:16890
2025/09/14 01:34:49 simple.go:248: clienthost: ::1
2025/09/14 01:34:49 simple.go:249: clientport: 39345
2025/09/14 01:34:49 simple.go:278: simple Handle header:
2025/09/14 01:34:49 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:34:49 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:34:49 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 01:34:49 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:34:49 http.go:90: method: HEAD
2025/09/14 01:34:49 http.go:91: url: /
2025/09/14 01:34:49 http.go:92: host: www.baidu.com
2025/09/14 01:34:49 http.go:93: proxyHandler header:
2025/09/14 01:34:49 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:34:49 http.go:121: clientport: 39347
2025/09/14 01:34:49 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:34:49 http.go:132: proxyHandler Accept : */*
2025/09/14 01:34:49 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:34:49 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.202.41.161:16890;host=www.baidu.com;proto=http
2025/09/14 01:34:49 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.202.41.161:16890;host=www.baidu.com;proto=http
2025/09/14 01:34:49 http.go:137: forwardedByList: [{[::1]:10810} {127.202.41.161:16890}]
2025/09/14 01:34:49 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:34:49 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 01:34:49 main.go:791: ProxySelector www.baidu.com
2025/09/14 01:34:49 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:34:49 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 01:34:49 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
[GIN] 2025/09/14 - 01:34:49 | 200 |     24.8706ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:34:49 simple.go:57: remote addr: [::1]:39348
2025/09/14 01:34:49 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:34:49 simple.go:117: address:www.baidu.com:443
2025/09/14 01:34:49 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:34:49 main.go:791: ProxySelector www.baidu.com:443
2025/09/14 01:34:49 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 01:34:49 simple.go:179: WebSocket Config Details:
2025/09/14 01:34:49 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 01:34:49 simple.go:181:   Username: 
2025/09/14 01:34:49 simple.go:182:   Password: 
2025/09/14 01:34:49 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 01:34:49 simple.go:184:   Protocol: websocket
2025/09/14 01:34:49 simple.go:185:   Timeout: 30s
2025/09/14 01:34:49 client.go:98: url: ws://localhost:38800
2025/09/14 01:34:49 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 01:34:49 client.go:110: url: http://localhost:38800
2025/09/14 01:34:49 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[j4huAAg/+8ZIME55+HUme0rrJJ4=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 01:34:49 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
2025/09/14 01:34:49 http.go:493: WebSocket ForwardData error: read tcp [::1]:39343->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 01:34:49 simple.go:204: WebSocket ForwardData error: read tcp [::1]:39341->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 01:34:49 simple.go:204: WebSocket ForwardData error: read tcp [::1]:39349->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 01:34:49 simple.go:204: WebSocket ForwardData error: read tcp [::1]:39346->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
```

âœ… ç«¯å£38800å·²æˆåŠŸé‡Šæ”¾
âœ… ç«¯å£10810å·²æˆåŠŸé‡Šæ”¾


###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:48:05

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 38164

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 41060

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12505682812067172896
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12505682812067172896


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 43000

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=vhitpfdcq1b6ttvlu4n2bbea17; expires=Sat, 13-Sep-2025 17:57:53 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=39036690505BF072E6C471E9B22F21C2.1757785673632; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:47:53 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=vhitpfdcq1b6ttvlu4n2bbea17; expires=Sat, 13-Sep-2025 17:57:53 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=39036690505BF072E6C471E9B22F21C2.1757785673632; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 42148

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12274553630881881398
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12274553630881881398


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 38164, 41060, 43000, 42148



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 01:48:05

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 38164

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 41060

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12505682812067172896
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12505682812067172896


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 43000

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=vhitpfdcq1b6ttvlu4n2bbea17; expires=Sat, 13-Sep-2025 17:57:53 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=39036690505BF072E6C471E9B22F21C2.1757785673632; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:47:53 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=vhitpfdcq1b6ttvlu4n2bbea17; expires=Sat, 13-Sep-2025 17:57:53 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=39036690505BF072E6C471E9B22F21C2.1757785673632; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 42148

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12274553630881881398
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12274553630881881398


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 38164, 41060, 43000, 42148

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 01:48:06 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 01:48:06 main.go:562: dohalpn: []
2025/09/14 01:48:06 main.go:564: hostname: 0.0.0.0
2025/09/14 01:48:06 main.go:566: port: 8080
2025/09/14 01:48:06 main.go:568: server_cert: 
2025/09/14 01:48:06 main.go:570: server_key: 
2025/09/14 01:48:06 main.go:572: username: 
2025/09/14 01:48:06 main.go:574: password: 
2025/09/14 01:48:06 main.go:576: dohurl: []
2025/09/14 01:48:06 main.go:578: dohip: []
2025/09/14 01:48:06 main.go:579: upstream-type: 
2025/09/14 01:48:06 main.go:580: upstream-address: 
2025/09/14 01:48:06 main.go:581: upstream-username: 
2025/09/14 01:48:06 main.go:582: upstream-password: 
2025/09/14 01:48:06 main.go:854: null
2025/09/14 01:48:06 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 01:48:06 http.go:372: Random IP: 127.7.111.243
2025/09/14 01:48:06 http.go:390: Random integer: 64745
2025/09/14 01:48:06 http.go:342: Proxy server started on port 127.7.111.243:64745
2025/09/14 01:48:07 simple.go:57: remote addr: [::1]:62883
2025/09/14 01:48:07 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 01:48:07 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:48:07 simple.go:117: address:www.baidu.com:80
2025/09/14 01:48:07 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.7.111.243:64745
2025/09/14 01:48:07 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.7.111.243:64745
2025/09/14 01:48:07 simple.go:248: clienthost: ::1
2025/09/14 01:48:07 simple.go:249: clientport: 62883
2025/09/14 01:48:07 simple.go:278: simple Handle header:
2025/09/14 01:48:07 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:48:07 simple.go:283: GET / HTTP/1.1
2025/09/14 01:48:07 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:48:07 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 01:48:07 http.go:90: method: GET
2025/09/14 01:48:07 http.go:91: url: /
2025/09/14 01:48:07 http.go:92: host: www.baidu.com
2025/09/14 01:48:07 http.go:93: proxyHandler header:
2025/09/14 01:48:07 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:48:07 http.go:121: clientport: 62884
2025/09/14 01:48:07 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.7.111.243:64745;host=www.baidu.com;proto=http
2025/09/14 01:48:07 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 01:48:07 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 01:48:07 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.7.111.243:64745;host=www.baidu.com;proto=http
2025/09/14 01:48:07 http.go:137: forwardedByList: [{[::1]:8080} {127.7.111.243:64745}]
2025/09/14 01:48:07 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:48:07 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:48:07 | 200 |    129.2438ms |       127.0.0.1 | GET      "/"
2025/09/14 01:48:09 simple.go:57: remote addr: [::1]:63029
2025/09/14 01:48:09 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 01:48:09 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 01:48:09 simple.go:117: address:www.baidu.com:80
2025/09/14 01:48:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.7.111.243:64745
2025/09/14 01:48:09 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.7.111.243:64745
2025/09/14 01:48:09 simple.go:248: clienthost: ::1
2025/09/14 01:48:09 simple.go:249: clientport: 63029
2025/09/14 01:48:09 simple.go:278: simple Handle header:
2025/09/14 01:48:09 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:48:09 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:48:09 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 01:48:09 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:48:09 http.go:90: method: HEAD
2025/09/14 01:48:09 http.go:91: url: /
2025/09/14 01:48:09 http.go:92: host: www.baidu.com
2025/09/14 01:48:09 http.go:93: proxyHandler header:
2025/09/14 01:48:09 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:48:09 http.go:121: clientport: 63030
2025/09/14 01:48:09 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.7.111.243:64745;host=www.baidu.com;proto=http
2025/09/14 01:48:09 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:48:09 http.go:132: proxyHandler Accept : */*
2025/09/14 01:48:09 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:48:09 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.7.111.243:64745;host=www.baidu.com;proto=http
2025/09/14 01:48:09 http.go:137: forwardedByList: [{[::1]:8080} {127.7.111.243:64745}]
2025/09/14 01:48:09 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 01:48:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 01:48:09 | 200 |     15.1215ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:48:09 simple.go:57: remote addr: [::1]:63037
2025/09/14 01:48:09 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 01:48:09 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 01:48:09 simple.go:117: address:www.so.com:80
2025/09/14 01:48:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.7.111.243:64745
2025/09/14 01:48:09 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.7.111.243:64745
2025/09/14 01:48:09 simple.go:248: clienthost: ::1
2025/09/14 01:48:09 simple.go:249: clientport: 63037
2025/09/14 01:48:09 simple.go:278: simple Handle header:
2025/09/14 01:48:09 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:48:09 simple.go:283: HEAD / HTTP/1.1
2025/09/14 01:48:09 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 01:48:09 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 01:48:09 http.go:90: method: HEAD
2025/09/14 01:48:09 http.go:91: url: /
2025/09/14 01:48:09 http.go:92: host: www.so.com
2025/09/14 01:48:09 http.go:93: proxyHandler header:
2025/09/14 01:48:09 http.go:120: clienthost: 127.0.0.1
2025/09/14 01:48:09 http.go:121: clientport: 63038
2025/09/14 01:48:09 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.7.111.243:64745;host=www.so.com;proto=http
2025/09/14 01:48:09 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 01:48:09 http.go:132: proxyHandler Accept : */*
2025/09/14 01:48:09 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 01:48:09 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.7.111.243:64745;host=www.so.com;proto=http
2025/09/14 01:48:09 http.go:137: forwardedByList: [{[::1]:8080} {127.7.111.243:64745}]
2025/09/14 01:48:09 http.go:155: targetUrl: http://www.so.com/
2025/09/14 01:48:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 01:48:09 | 302 |     42.4607ms |       127.0.0.1 | HEAD     "/"
2025/09/14 01:48:09 simple.go:57: remote addr: [::1]:63041
2025/09/14 01:48:09 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 01:48:09 simple.go:117: address:www.so.com:443
2025/09/14 01:48:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 01:48:09 options.go:98: hostname www.so.com no ip found
2025/09/14 01:48:09 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 01:48:09 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 01:48:09 simple.go:57: remote addr: [::1]:63054
2025/09/14 01:48:09 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 01:48:09 simple.go:117: address:www.baidu.com:443
2025/09/14 01:48:09 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 01:48:09 options.go:98: hostname www.baidu.com no ip found
2025/09/14 01:48:09 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 01:48:09 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12505682812067172896
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12505682812067172896
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=vhitpfdcq1b6ttvlu4n2bbea17; expires=Sat, 13-Sep-2025 17:57:53 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=39036690505BF072E6C471E9B22F21C2.1757785673632; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 17:47:53 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=vhitpfdcq1b6ttvlu4n2bbea17; expires=Sat, 13-Sep-2025 17:57:53 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=39036690505BF072E6C471E9B22F21C2.1757785673632; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 17:47:53 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12274553630881881398
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 17:47:53 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12274553630881881398
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âŒ æµ‹è¯•1å¤±è´¥: exit status 7

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âŒ æµ‹è¯•2å¤±è´¥: exit status 7

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âŒ æµ‹è¯•3å¤±è´¥: exit status 7



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 02:22:10

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 38820

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 42620

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12033132020282947310
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12033132020282947310


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 43208

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=l8snd1bk4rs1o8fscd0tiq5737; expires=Sat, 13-Sep-2025 18:31:58 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=861E163FBDC25862610EE1F9E9FB11D9.1757787718678; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 18:21:58 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=l8snd1bk4rs1o8fscd0tiq5737; expires=Sat, 13-Sep-2025 18:31:58 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=861E163FBDC25862610EE1F9E9FB11D9.1757787718678; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 43748

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12245756777065127796
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12245756777065127796


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 38820, 42620, 43208, 43748



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 02:22:10

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 38820

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 42620

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12033132020282947310
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12033132020282947310


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 43208

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=l8snd1bk4rs1o8fscd0tiq5737; expires=Sat, 13-Sep-2025 18:31:58 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=861E163FBDC25862610EE1F9E9FB11D9.1757787718678; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 18:21:58 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=l8snd1bk4rs1o8fscd0tiq5737; expires=Sat, 13-Sep-2025 18:31:58 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=861E163FBDC25862610EE1F9E9FB11D9.1757787718678; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 43748

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12245756777065127796
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12245756777065127796


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 38820, 42620, 43208, 43748

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 02:22:11 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 02:22:11 main.go:562: dohalpn: []
2025/09/14 02:22:11 main.go:564: hostname: 0.0.0.0
2025/09/14 02:22:11 main.go:566: port: 8080
2025/09/14 02:22:11 main.go:568: server_cert: 
2025/09/14 02:22:11 main.go:570: server_key: 
2025/09/14 02:22:11 main.go:572: username: 
2025/09/14 02:22:11 main.go:574: password: 
2025/09/14 02:22:11 main.go:576: dohurl: []
2025/09/14 02:22:11 main.go:578: dohip: []
2025/09/14 02:22:11 main.go:579: upstream-type: 
2025/09/14 02:22:11 main.go:580: upstream-address: 
2025/09/14 02:22:11 main.go:581: upstream-username: 
2025/09/14 02:22:11 main.go:582: upstream-password: 
2025/09/14 02:22:11 main.go:854: null
2025/09/14 02:22:11 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 02:22:11 http.go:372: Random IP: 127.23.153.3
2025/09/14 02:22:11 http.go:390: Random integer: 37351
2025/09/14 02:22:11 http.go:342: Proxy server started on port 127.23.153.3:37351
2025/09/14 02:22:12 simple.go:57: remote addr: [::1]:42253
2025/09/14 02:22:12 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 02:22:12 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 02:22:12 simple.go:117: address:www.baidu.com:80
2025/09/14 02:22:12 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.23.153.3:37351
2025/09/14 02:22:12 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.23.153.3:37351
2025/09/14 02:22:12 simple.go:248: clienthost: ::1
2025/09/14 02:22:12 simple.go:249: clientport: 42253
2025/09/14 02:22:12 simple.go:278: simple Handle header:
2025/09/14 02:22:12 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:22:12 simple.go:283: GET / HTTP/1.1
2025/09/14 02:22:12 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:22:12 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 02:22:12 http.go:90: method: GET
2025/09/14 02:22:12 http.go:91: url: /
2025/09/14 02:22:12 http.go:92: host: www.baidu.com
2025/09/14 02:22:12 http.go:93: proxyHandler header:
2025/09/14 02:22:12 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:22:12 http.go:121: clientport: 42254
2025/09/14 02:22:12 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 02:22:12 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 02:22:12 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.23.153.3:37351;host=www.baidu.com;proto=http
2025/09/14 02:22:12 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.23.153.3:37351;host=www.baidu.com;proto=http
2025/09/14 02:22:12 http.go:137: forwardedByList: [{[::1]:8080} {127.23.153.3:37351}]
2025/09/14 02:22:12 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 02:22:12 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 02:22:12 | 200 |     62.2041ms |       127.0.0.1 | GET      "/"
2025/09/14 02:22:14 simple.go:57: remote addr: [::1]:42307
2025/09/14 02:22:14 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 02:22:14 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 02:22:14 simple.go:117: address:www.baidu.com:80
2025/09/14 02:22:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.23.153.3:37351
2025/09/14 02:22:14 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.23.153.3:37351
2025/09/14 02:22:14 simple.go:248: clienthost: ::1
2025/09/14 02:22:14 simple.go:249: clientport: 42307
2025/09/14 02:22:14 simple.go:278: simple Handle header:
2025/09/14 02:22:14 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:22:14 simple.go:283: HEAD / HTTP/1.1
2025/09/14 02:22:14 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:22:14 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 02:22:14 http.go:90: method: HEAD
2025/09/14 02:22:14 http.go:91: url: /
2025/09/14 02:22:14 http.go:92: host: www.baidu.com
2025/09/14 02:22:14 http.go:93: proxyHandler header:
2025/09/14 02:22:14 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:22:14 http.go:121: clientport: 42308
2025/09/14 02:22:14 http.go:132: proxyHandler Accept : */*
2025/09/14 02:22:14 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 02:22:14 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.23.153.3:37351;host=www.baidu.com;proto=http
2025/09/14 02:22:14 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 02:22:14 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.23.153.3:37351;host=www.baidu.com;proto=http
2025/09/14 02:22:14 http.go:137: forwardedByList: [{[::1]:8080} {127.23.153.3:37351}]
2025/09/14 02:22:14 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 02:22:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 02:22:14 | 200 |     15.5659ms |       127.0.0.1 | HEAD     "/"
2025/09/14 02:22:14 simple.go:57: remote addr: [::1]:42309
2025/09/14 02:22:14 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 02:22:14 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 02:22:14 simple.go:117: address:www.so.com:80
2025/09/14 02:22:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.23.153.3:37351
2025/09/14 02:22:14 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.23.153.3:37351
2025/09/14 02:22:14 simple.go:248: clienthost: ::1
2025/09/14 02:22:14 simple.go:249: clientport: 42309
2025/09/14 02:22:14 simple.go:278: simple Handle header:
2025/09/14 02:22:14 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 02:22:14 simple.go:283: HEAD / HTTP/1.1
2025/09/14 02:22:14 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 02:22:14 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 02:22:14 http.go:90: method: HEAD
2025/09/14 02:22:14 http.go:91: url: /
2025/09/14 02:22:14 http.go:92: host: www.so.com
2025/09/14 02:22:14 http.go:93: proxyHandler header:
2025/09/14 02:22:14 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:22:14 http.go:121: clientport: 42310
2025/09/14 02:22:14 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.23.153.3:37351;host=www.so.com;proto=http
2025/09/14 02:22:14 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 02:22:14 http.go:132: proxyHandler Accept : */*
2025/09/14 02:22:14 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 02:22:14 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.23.153.3:37351;host=www.so.com;proto=http
2025/09/14 02:22:14 http.go:137: forwardedByList: [{[::1]:8080} {127.23.153.3:37351}]
2025/09/14 02:22:14 http.go:155: targetUrl: http://www.so.com/
2025/09/14 02:22:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 02:22:14 | 302 |     51.3997ms |       127.0.0.1 | HEAD     "/"
2025/09/14 02:22:14 simple.go:57: remote addr: [::1]:42318
2025/09/14 02:22:14 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 02:22:14 simple.go:117: address:www.so.com:443
2025/09/14 02:22:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 02:22:14 options.go:98: hostname www.so.com no ip found
2025/09/14 02:22:14 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 02:22:14 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 02:22:14 simple.go:57: remote addr: [::1]:42324
2025/09/14 02:22:14 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 02:22:14 simple.go:117: address:www.baidu.com:443
2025/09/14 02:22:14 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 02:22:14 options.go:98: hostname www.baidu.com no ip found
2025/09/14 02:22:14 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 02:22:14 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12033132020282947310
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12033132020282947310
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=l8snd1bk4rs1o8fscd0tiq5737; expires=Sat, 13-Sep-2025 18:31:58 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=861E163FBDC25862610EE1F9E9FB11D9.1757787718678; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sat, 13 Sep 2025 18:21:58 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=l8snd1bk4rs1o8fscd0tiq5737; expires=Sat, 13-Sep-2025 18:31:58 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=861E163FBDC25862610EE1F9E9FB11D9.1757787718678; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:21:58 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_12245756777065127796
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:21:58 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_12245756777065127796
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 02:22:20

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 40796

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 3332

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 40640, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:22:10 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:22:10 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 40592, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Location: https://www.baidu.com/error.html
< Server: bfe
< Date: Sat, 13 Sep 2025 18:22:10 GMT
< Content-Type: text/plain; charset=utf-8
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 302 Found
Location: https://www.baidu.com/error.html
Server: bfe
Date: Sat, 13 Sep 2025 18:22:10 GMT
Content-Type: text/plain; charset=utf-8


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 40796, 3332, 40640, 40592



###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 02:22:20

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 40796

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 3332

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 40640, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sat, 13 Sep 2025 18:22:10 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sat, 13 Sep 2025 18:22:10 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 40592, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Location: https://www.baidu.com/error.html
< Server: bfe
< Date: Sat, 13 Sep 2025 18:22:10 GMT
< Content-Type: text/plain; charset=utf-8
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 302 Found
Location: https://www.baidu.com/error.html
Server: bfe
Date: Sat, 13 Sep 2025 18:22:10 GMT
Content-Type: text/plain; charset=utf-8


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 40796, 3332, 40640, 40592

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹...
âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹...
âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...
âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 02:22:22 main.go:71: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :38800
2025/09/14 02:22:22 server.go:71: [WEBSOCKET-SERVER] Server started successfully, listening on :38800
2025/09/14 02:22:22 server.go:72: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 02:22:22 server.go:74: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 02:22:22 server.go:75: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 02:22:22 main.go:129: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 02:22:24 server.go:90: url /
2025/09/14 02:22:24 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[dvVH1J+EDm2x9NZuizxB6w==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.180.213.95] X-Proxy-Target-Port:[61428]]
2025/09/14 02:22:24 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42412 at 2025-09-14 02:22:24
2025/09/14 02:22:24 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42412
2025/09/14 02:22:24 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.180.213.95', targetPort: 61428
2025/09/14 02:22:24 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 02:22:24 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42412
2025/09/14 02:22:24 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.180.213.95:61428 from [::1]:42412
2025/09/14 02:22:24 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.180.213.95:61428 (timeout: 30s)
2025/09/14 02:22:24 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.180.213.95:61428
2025/09/14 02:22:24 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 02:22:24 server.go:90: url /
2025/09/14 02:22:24 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[qU5Afj9C2ZHosZMrvIJymg==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 02:22:24 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42414 at 2025-09-14 02:22:24
2025/09/14 02:22:24 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42414
2025/09/14 02:22:24 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 02:22:24 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 02:22:24 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42414
2025/09/14 02:22:24 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:42414
2025/09/14 02:22:24 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 02:22:24 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 02:22:24 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 02:22:26 server.go:90: url /
2025/09/14 02:22:26 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[EA/qNCllGTaEyJwU65mr0w==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.180.213.95] X-Proxy-Target-Port:[61428]]
2025/09/14 02:22:26 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42418 at 2025-09-14 02:22:26
2025/09/14 02:22:26 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42418
2025/09/14 02:22:26 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.180.213.95', targetPort: 61428
2025/09/14 02:22:26 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 02:22:26 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42418
2025/09/14 02:22:26 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.180.213.95:61428 from [::1]:42418
2025/09/14 02:22:26 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.180.213.95:61428 (timeout: 30s)
2025/09/14 02:22:26 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.180.213.95:61428
2025/09/14 02:22:26 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 02:22:26 server.go:90: url /
2025/09/14 02:22:26 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[iPeEealhqp+IjQhCMrymMA==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 02:22:26 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:42421 at 2025-09-14 02:22:26
2025/09/14 02:22:26 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:42421
2025/09/14 02:22:26 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 02:22:26 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 02:22:26 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:42421
2025/09/14 02:22:26 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:42421
2025/09/14 02:22:26 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 02:22:26 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 02:22:26 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
```

### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 02:22:23 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 02:22:23 main.go:562: dohalpn: []
2025/09/14 02:22:23 main.go:564: hostname: 0.0.0.0
2025/09/14 02:22:23 main.go:566: port: 10810
2025/09/14 02:22:23 main.go:568: server_cert: 
2025/09/14 02:22:23 main.go:570: server_key: 
2025/09/14 02:22:23 main.go:572: username: 
2025/09/14 02:22:23 main.go:574: password: 
2025/09/14 02:22:23 main.go:576: dohurl: []
2025/09/14 02:22:23 main.go:578: dohip: []
2025/09/14 02:22:23 main.go:579: upstream-type: websocket
2025/09/14 02:22:23 main.go:580: upstream-address: ws://localhost:38800
2025/09/14 02:22:23 main.go:581: upstream-username: 
2025/09/14 02:22:23 main.go:582: upstream-password: 
2025/09/14 02:22:23 main.go:639: WebSocketä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 02:22:23 main.go:854: {
  "hostname": "",
  "port": 0,
  "server_cert": "",
  "server_key": "",
  "username": "",
  "password": "",
  "doh": null,
  "upstreams": {
    "websocket_upstream": {
      "type": "websocket",
      "http_proxy": "",
      "https_proxy": "",
      "bypass_list": [],
      "ws_proxy": "ws://localhost:38800",
      "ws_username": "",
      "ws_password": "",
      "http_username": "",
      "http_password": "",
      "socks5_proxy": "",
      "socks5_username": "",
      "socks5_password": ""
    }
  },
  "rules": [
    {
      "filter": "websocket_filter",
      "upstream": "websocket_upstream"
    }
  ],
  "filters": {
    "websocket_filter": {
      "patterns": [
        "*"
      ]
    }
  }
}
2025/09/14 02:22:23 simple.go:31: Proxy server started on port [::]:10810
2025/09/14 02:22:23 http.go:372: Random IP: 127.180.213.95
2025/09/14 02:22:23 http.go:390: Random integer: 61428
2025/09/14 02:22:23 http.go:342: Proxy server started on port 127.180.213.95:61428
2025/09/14 02:22:24 simple.go:57: remote addr: [::1]:42411
2025/09/14 02:22:24 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 02:22:24 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 02:22:24 simple.go:117: address:www.baidu.com:80
2025/09/14 02:22:24 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.180.213.95:61428
2025/09/14 02:22:24 main.go:791: ProxySelector 127.180.213.95:61428
2025/09/14 02:22:24 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 02:22:24 simple.go:179: WebSocket Config Details:
2025/09/14 02:22:24 simple.go:180: host, portNum 127.180.213.95 61428
2025/09/14 02:22:24 simple.go:181:   Username: 
2025/09/14 02:22:24 simple.go:182:   Password: 
2025/09/14 02:22:24 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 02:22:24 simple.go:184:   Protocol: websocket
2025/09/14 02:22:24 simple.go:185:   Timeout: 30s
2025/09/14 02:22:24 client.go:98: url: ws://localhost:38800
2025/09/14 02:22:24 client.go:99: headers: map[X-Proxy-Target-Host:[127.180.213.95] X-Proxy-Target-Port:[61428]]
2025/09/14 02:22:24 client.go:110: url: http://localhost:38800
2025/09/14 02:22:24 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[EoQcoAUvtV6oUC1M8LKVTlJHcL4=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 02:22:24 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.180.213.95:61428
2025/09/14 02:22:24 simple.go:248: clienthost: ::1
2025/09/14 02:22:24 simple.go:249: clientport: 42411
2025/09/14 02:22:24 simple.go:278: simple Handle header:
2025/09/14 02:22:24 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 02:22:24 simple.go:283: GET / HTTP/1.1
2025/09/14 02:22:24 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 02:22:24 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 02:22:24 http.go:90: method: GET
2025/09/14 02:22:24 http.go:91: url: /
2025/09/14 02:22:24 http.go:92: host: www.baidu.com
2025/09/14 02:22:24 http.go:93: proxyHandler header:
2025/09/14 02:22:24 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:22:24 http.go:121: clientport: 42413
2025/09/14 02:22:24 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.180.213.95:61428;host=www.baidu.com;proto=http
2025/09/14 02:22:24 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 02:22:24 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 02:22:24 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.180.213.95:61428;host=www.baidu.com;proto=http
2025/09/14 02:22:24 http.go:137: forwardedByList: [{[::1]:10810} {127.180.213.95:61428}]
2025/09/14 02:22:24 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 02:22:24 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 02:22:24 main.go:791: ProxySelector www.baidu.com
2025/09/14 02:22:24 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 02:22:24 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 02:22:24 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
2025/09/14 02:22:24 http.go:262: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 02:22:24 http.go:264: network,addr tcp www.baidu.com:80
2025/09/14 02:22:24 http.go:466: WebSocket Config Details:
2025/09/14 02:22:24 http.go:467: host, portNum www.baidu.com 80
2025/09/14 02:22:24 http.go:468:   Username: 
2025/09/14 02:22:24 http.go:469:   Password: 
2025/09/14 02:22:24 http.go:470:   ServerAddr: ws://localhost:38800
2025/09/14 02:22:24 http.go:471:   Protocol: websocket
2025/09/14 02:22:24 http.go:472:   Timeout: 30s
2025/09/14 02:22:24 http.go:476: host, portNum www.baidu.com 80
2025/09/14 02:22:24 client.go:98: url: ws://localhost:38800
2025/09/14 02:22:24 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 02:22:24 client.go:110: url: http://localhost:38800
2025/09/14 02:22:24 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[kNW8sEKHiu38MqgGvSY9ZkJdw28=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
[GIN] 2025/09/14 - 02:22:24 | 200 |     60.4167ms |       127.0.0.1 | GET      "/"
2025/09/14 02:22:26 simple.go:57: remote addr: [::1]:42417
2025/09/14 02:22:26 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 02:22:26 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 02:22:26 simple.go:117: address:www.baidu.com:80
2025/09/14 02:22:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.180.213.95:61428
2025/09/14 02:22:26 main.go:791: ProxySelector 127.180.213.95:61428
2025/09/14 02:22:26 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 02:22:26 simple.go:179: WebSocket Config Details:
2025/09/14 02:22:26 simple.go:180: host, portNum 127.180.213.95 61428
2025/09/14 02:22:26 simple.go:181:   Username: 
2025/09/14 02:22:26 simple.go:182:   Password: 
2025/09/14 02:22:26 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 02:22:26 simple.go:184:   Protocol: websocket
2025/09/14 02:22:26 simple.go:185:   Timeout: 30s
2025/09/14 02:22:26 client.go:98: url: ws://localhost:38800
2025/09/14 02:22:26 client.go:99: headers: map[X-Proxy-Target-Host:[127.180.213.95] X-Proxy-Target-Port:[61428]]
2025/09/14 02:22:26 client.go:110: url: http://localhost:38800
2025/09/14 02:22:26 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[BBjDVlUuQe1Rts+NFjqQl2Ui3ZQ=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 02:22:26 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.180.213.95:61428
2025/09/14 02:22:26 simple.go:248: clienthost: ::1
2025/09/14 02:22:26 simple.go:249: clientport: 42417
2025/09/14 02:22:26 simple.go:278: simple Handle header:
2025/09/14 02:22:26 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 02:22:26 simple.go:283: HEAD / HTTP/1.1
2025/09/14 02:22:26 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 02:22:26 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 02:22:26 http.go:90: method: HEAD
2025/09/14 02:22:26 http.go:91: url: /
2025/09/14 02:22:26 http.go:92: host: www.baidu.com
2025/09/14 02:22:26 http.go:93: proxyHandler header:
2025/09/14 02:22:26 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:22:26 http.go:121: clientport: 42419
2025/09/14 02:22:26 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.180.213.95:61428;host=www.baidu.com;proto=http
2025/09/14 02:22:26 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 02:22:26 http.go:132: proxyHandler Accept : */*
2025/09/14 02:22:26 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 02:22:26 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.180.213.95:61428;host=www.baidu.com;proto=http
2025/09/14 02:22:26 http.go:137: forwardedByList: [{[::1]:10810} {127.180.213.95:61428}]
2025/09/14 02:22:26 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 02:22:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 02:22:26 main.go:791: ProxySelector www.baidu.com
2025/09/14 02:22:26 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 02:22:26 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 02:22:26 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
[GIN] 2025/09/14 - 02:22:26 | 200 |     51.3127ms |       127.0.0.1 | HEAD     "/"
2025/09/14 02:22:26 simple.go:57: remote addr: [::1]:42420
2025/09/14 02:22:26 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 02:22:26 simple.go:117: address:www.baidu.com:443
2025/09/14 02:22:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 02:22:26 main.go:791: ProxySelector www.baidu.com:443
2025/09/14 02:22:26 main.go:797: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 02:22:26 simple.go:179: WebSocket Config Details:
2025/09/14 02:22:26 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 02:22:26 simple.go:181:   Username: 
2025/09/14 02:22:26 simple.go:182:   Password: 
2025/09/14 02:22:26 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 02:22:26 simple.go:184:   Protocol: websocket
2025/09/14 02:22:26 simple.go:185:   Timeout: 30s
2025/09/14 02:22:26 client.go:98: url: ws://localhost:38800
2025/09/14 02:22:26 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 02:22:26 client.go:110: url: http://localhost:38800
2025/09/14 02:22:26 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[FZSkRGQTXPUAmfVeUyzigtjACPA=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 02:22:26 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
2025/09/14 02:22:26 simple.go:204: WebSocket ForwardData error: read tcp [::1]:42412->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 02:22:26 http.go:493: WebSocket ForwardData error: read tcp [::1]:42414->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 02:22:26 simple.go:204: WebSocket ForwardData error: read tcp [::1]:42421->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 02:22:26 simple.go:204: WebSocket ForwardData error: read tcp [::1]:42418->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
```

âœ… ç«¯å£38800å·²æˆåŠŸé‡Šæ”¾
âœ… ç«¯å£10810å·²æˆåŠŸé‡Šæ”¾


###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 02:30:47 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 02:30:47 main.go:562: dohalpn: [h2, h3]
2025/09/14 02:30:47 main.go:564: hostname: 0.0.0.0
2025/09/14 02:30:47 main.go:566: port: 8080
2025/09/14 02:30:47 main.go:568: server_cert: 
2025/09/14 02:30:47 main.go:570: server_key: 
2025/09/14 02:30:47 main.go:572: username: 
2025/09/14 02:30:47 main.go:574: password: 
2025/09/14 02:30:47 main.go:576: dohurl: [https://dns.alidns.com/dns-query, https://dns.alidns.com/dns-query]
2025/09/14 02:30:47 main.go:578: dohip: [223.5.5.5, 223.6.6.6]
2025/09/14 02:30:47 main.go:579: upstream-type: 
2025/09/14 02:30:47 main.go:580: upstream-address: 
2025/09/14 02:30:47 main.go:581: upstream-username: 
2025/09/14 02:30:47 main.go:582: upstream-password: 
2025/09/14 02:30:47 main.go:854: null
2025/09/14 02:30:47 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 02:30:47 http.go:372: Random IP: 127.22.93.187
2025/09/14 02:30:47 http.go:390: Random integer: 47238
2025/09/14 02:30:47 http.go:342: Proxy server started on port 127.22.93.187:47238
2025/09/14 02:30:49 simple.go:57: remote addr: [::1]:47241
2025/09/14 02:30:49 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 02:30:49 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 02:30:49 simple.go:117: address:www.baidu.com:80
2025/09/14 02:30:49 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.22.93.187:47238
2025/09/14 02:30:49 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.22.93.187:47238
2025/09/14 02:30:49 simple.go:248: clienthost: ::1
2025/09/14 02:30:49 simple.go:249: clientport: 47241
2025/09/14 02:30:49 simple.go:278: simple Handle header:
2025/09/14 02:30:49 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:30:49 simple.go:283: GET / HTTP/1.1
2025/09/14 02:30:49 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:30:49 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 02:30:49 http.go:90: method: GET
2025/09/14 02:30:49 http.go:91: url: /
2025/09/14 02:30:49 http.go:92: host: www.baidu.com
2025/09/14 02:30:49 http.go:93: proxyHandler header:
2025/09/14 02:30:49 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:30:49 http.go:121: clientport: 47242
2025/09/14 02:30:49 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.22.93.187:47238;host=www.baidu.com;proto=http
2025/09/14 02:30:49 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 02:30:49 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 02:30:49 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.22.93.187:47238;host=www.baidu.com;proto=http
2025/09/14 02:30:49 http.go:137: forwardedByList: [{[::1]:8080} {127.22.93.187:47238}]
2025/09/14 02:30:49 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 02:30:49 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 02:30:49 options.go:186: hostname www.baidu.com no ip found
2025/09/14 02:30:49 doh3.go:15: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:49 doh3.go:27: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:49 doh3.go:27: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:55756 223.6.6.6:443
2025/09/14 02:30:50 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:55755 223.6.6.6:443
2025/09/14 02:30:50 doh3.go:80: dns resolved www.baidu.com ips:[240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69,180.101.51.73,180.101.49.44]
2025/09/14 02:30:50 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=240e:e9:6002:1ac:0:ff:b07e:36c5
[GIN] 2025/09/14 - 02:30:50 | 200 |    114.9237ms |       127.0.0.1 | GET      "/"
2025/09/14 02:30:50 simple.go:57: remote addr: [::1]:47252
2025/09/14 02:30:50 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 02:30:50 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 02:30:50 simple.go:117: address:www.baidu.com:80
2025/09/14 02:30:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.22.93.187:47238
2025/09/14 02:30:50 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.22.93.187:47238
2025/09/14 02:30:50 simple.go:248: clienthost: ::1
2025/09/14 02:30:50 simple.go:249: clientport: 47252
2025/09/14 02:30:50 simple.go:278: simple Handle header:
2025/09/14 02:30:50 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:30:50 simple.go:283: HEAD / HTTP/1.1
2025/09/14 02:30:50 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 02:30:50 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 02:30:50 http.go:90: method: HEAD
2025/09/14 02:30:50 http.go:91: url: /
2025/09/14 02:30:50 http.go:92: host: www.baidu.com
2025/09/14 02:30:50 http.go:93: proxyHandler header:
2025/09/14 02:30:50 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:30:50 http.go:121: clientport: 47253
2025/09/14 02:30:50 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 02:30:50 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.22.93.187:47238;host=www.baidu.com;proto=http
2025/09/14 02:30:50 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 02:30:50 http.go:132: proxyHandler Accept : */*
2025/09/14 02:30:50 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.22.93.187:47238;host=www.baidu.com;proto=http
2025/09/14 02:30:50 http.go:137: forwardedByList: [{[::1]:8080} {127.22.93.187:47238}]
2025/09/14 02:30:50 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 02:30:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 02:30:50 options.go:186: hostname www.baidu.com no ip found
2025/09/14 02:30:50 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 02:30:50 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 02:30:50 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 02:30:50 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 02:30:50 doh.go:91: dns resolved www.baidu.com ips:[240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69,180.101.51.73,180.101.49.44]
2025/09/14 02:30:50 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=240e:e9:6002:1ac:0:ff:b07e:36c5
[GIN] 2025/09/14 - 02:30:50 | 200 |     80.1164ms |       127.0.0.1 | HEAD     "/"
2025/09/14 02:30:50 simple.go:57: remote addr: [::1]:47257
2025/09/14 02:30:50 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 02:30:50 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 02:30:50 simple.go:117: address:www.so.com:80
2025/09/14 02:30:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.22.93.187:47238
2025/09/14 02:30:50 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.22.93.187:47238
2025/09/14 02:30:50 simple.go:248: clienthost: ::1
2025/09/14 02:30:50 simple.go:249: clientport: 47257
2025/09/14 02:30:50 simple.go:278: simple Handle header:
2025/09/14 02:30:50 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 02:30:50 simple.go:283: HEAD / HTTP/1.1
2025/09/14 02:30:50 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 02:30:50 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 02:30:50 http.go:90: method: HEAD
2025/09/14 02:30:50 http.go:91: url: /
2025/09/14 02:30:50 http.go:92: host: www.so.com
2025/09/14 02:30:50 http.go:93: proxyHandler header:
2025/09/14 02:30:50 http.go:120: clienthost: 127.0.0.1
2025/09/14 02:30:50 http.go:121: clientport: 47258
2025/09/14 02:30:50 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 02:30:50 http.go:132: proxyHandler Accept : */*
2025/09/14 02:30:50 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 02:30:50 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.22.93.187:47238;host=www.so.com;proto=http
2025/09/14 02:30:50 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.22.93.187:47238;host=www.so.com;proto=http
2025/09/14 02:30:50 http.go:137: forwardedByList: [{[::1]:8080} {127.22.93.187:47238}]
2025/09/14 02:30:50 http.go:155: targetUrl: http://www.so.com/
2025/09/14 02:30:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
2025/09/14 02:30:50 options.go:186: hostname www.so.com no ip found
2025/09/14 02:30:50 doh3.go:15: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh3.go:27: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh3.go:27: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:55758 223.6.6.6:443
2025/09/14 02:30:50 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:55757 223.6.6.6:443
2025/09/14 02:30:50 doh3.go:80: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 02:30:50 options.go:240: success connect to address=www.so.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.163.237.15
[GIN] 2025/09/14 - 02:30:50 | 302 |     67.9614ms |       127.0.0.1 | HEAD     "/"
2025/09/14 02:30:50 simple.go:57: remote addr: [::1]:47260
2025/09/14 02:30:50 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 02:30:50 simple.go:117: address:www.so.com:443
2025/09/14 02:30:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 02:30:50 options.go:98: hostname www.so.com no ip found
2025/09/14 02:30:50 options.go:186: hostname www.so.com no ip found
2025/09/14 02:30:50 doh.go:16: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh.go:28: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh.go:28: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 02:30:50 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 02:30:50 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 02:30:50 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 02:30:50 doh.go:91: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 02:30:50 options.go:240: success connect to address=www.so.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.163.237.15
2025/09/14 02:30:50 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 02:30:50 simple.go:57: remote addr: [::1]:47272
2025/09/14 02:30:50 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 02:30:50 simple.go:117: address:www.baidu.com:443
2025/09/14 02:30:50 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 02:30:50 options.go:98: hostname www.baidu.com no ip found
2025/09/14 02:30:50 options.go:186: hostname www.baidu.com no ip found
2025/09/14 02:30:50 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 02:30:50 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 02:30:50 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 02:30:50 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 02:30:50 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 02:30:50 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 02:30:50 doh.go:91: dns resolved www.baidu.com ips:[240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5,180.101.51.73,180.101.49.44]
2025/09/14 02:30:50 options.go:240: success connect to address=www.baidu.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.101.51.73
2025/09/14 02:30:50 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:18:33 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 13:18:33 main.go:562: dohalpn: [h2, h3]
2025/09/14 13:18:33 main.go:564: hostname: 0.0.0.0
2025/09/14 13:18:33 main.go:566: port: 8080
2025/09/14 13:18:33 main.go:568: server_cert: 
2025/09/14 13:18:33 main.go:570: server_key: 
2025/09/14 13:18:33 main.go:572: username: 
2025/09/14 13:18:33 main.go:574: password: 
2025/09/14 13:18:33 main.go:576: dohurl: [https://dns.alidns.com/dns-query, https://dns.alidns.com/dns-query]
2025/09/14 13:18:33 main.go:578: dohip: [223.5.5.5, 223.6.6.6]
2025/09/14 13:18:33 main.go:579: upstream-type: 
2025/09/14 13:18:33 main.go:580: upstream-address: 
2025/09/14 13:18:33 main.go:581: upstream-username: 
2025/09/14 13:18:33 main.go:582: upstream-password: 
2025/09/14 13:18:33 main.go:927: null
2025/09/14 13:18:33 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 13:18:33 http.go:372: Random IP: 127.85.175.242
2025/09/14 13:18:33 http.go:390: Random integer: 19589
2025/09/14 13:18:33 http.go:342: Proxy server started on port 127.85.175.242:19589
2025/09/14 13:18:35 simple.go:57: remote addr: [::1]:61452
2025/09/14 13:18:35 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 13:18:35 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:18:35 simple.go:117: address:www.baidu.com:80
2025/09/14 13:18:35 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.85.175.242:19589
2025/09/14 13:18:35 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.85.175.242:19589
2025/09/14 13:18:35 simple.go:248: clienthost: ::1
2025/09/14 13:18:35 simple.go:249: clientport: 61452
2025/09/14 13:18:35 simple.go:278: simple Handle header:
2025/09/14 13:18:35 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:18:35 simple.go:283: GET / HTTP/1.1
2025/09/14 13:18:35 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:18:35 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 13:18:35 http.go:90: method: GET
2025/09/14 13:18:35 http.go:91: url: /
2025/09/14 13:18:35 http.go:92: host: www.baidu.com
2025/09/14 13:18:35 http.go:93: proxyHandler header:
2025/09/14 13:18:35 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:18:35 http.go:121: clientport: 61453
2025/09/14 13:18:35 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 13:18:35 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 13:18:35 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.85.175.242:19589;host=www.baidu.com;proto=http
2025/09/14 13:18:35 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.85.175.242:19589;host=www.baidu.com;proto=http
2025/09/14 13:18:35 http.go:137: forwardedByList: [{[::1]:8080} {127.85.175.242:19589}]
2025/09/14 13:18:35 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:18:35 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:18:35 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:18:35 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:35 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:35 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:35 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:18:35 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:18:35 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:18:35 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:18:35 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:18:35 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:18:36 doh.go:91: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5]
2025/09/14 13:18:36 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.101.49.44
[GIN] 2025/09/14 - 13:18:36 | 200 |    123.7792ms |       127.0.0.1 | GET      "/"
2025/09/14 13:18:36 simple.go:57: remote addr: [::1]:61459
2025/09/14 13:18:36 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 13:18:36 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:18:36 simple.go:117: address:www.baidu.com:80
2025/09/14 13:18:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.85.175.242:19589
2025/09/14 13:18:36 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.85.175.242:19589
2025/09/14 13:18:36 simple.go:248: clienthost: ::1
2025/09/14 13:18:36 simple.go:249: clientport: 61459
2025/09/14 13:18:36 simple.go:278: simple Handle header:
2025/09/14 13:18:36 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:18:36 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:18:36 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:18:36 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:18:36 http.go:90: method: HEAD
2025/09/14 13:18:36 http.go:91: url: /
2025/09/14 13:18:36 http.go:92: host: www.baidu.com
2025/09/14 13:18:36 http.go:93: proxyHandler header:
2025/09/14 13:18:36 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:18:36 http.go:121: clientport: 61460
2025/09/14 13:18:36 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:18:36 http.go:132: proxyHandler Accept : */*
2025/09/14 13:18:36 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:18:36 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.85.175.242:19589;host=www.baidu.com;proto=http
2025/09/14 13:18:36 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.85.175.242:19589;host=www.baidu.com;proto=http
2025/09/14 13:18:36 http.go:137: forwardedByList: [{[::1]:8080} {127.85.175.242:19589}]
2025/09/14 13:18:36 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:18:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:18:36 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:18:36 doh3.go:15: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh3.go:27: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh3.go:27: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:63933 223.6.6.6:443
2025/09/14 13:18:36 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:63932 223.6.6.6:443
2025/09/14 13:18:36 doh3.go:80: dns resolved www.baidu.com ips:[240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5,180.101.51.73,180.101.49.44]
2025/09/14 13:18:36 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.101.49.44
[GIN] 2025/09/14 - 13:18:36 | 200 |     89.9035ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:18:36 simple.go:57: remote addr: [::1]:61462
2025/09/14 13:18:36 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 13:18:36 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 13:18:36 simple.go:117: address:www.so.com:80
2025/09/14 13:18:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.85.175.242:19589
2025/09/14 13:18:36 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.85.175.242:19589
2025/09/14 13:18:36 simple.go:248: clienthost: ::1
2025/09/14 13:18:36 simple.go:249: clientport: 61462
2025/09/14 13:18:36 simple.go:278: simple Handle header:
2025/09/14 13:18:36 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:18:36 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:18:36 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:18:36 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:18:36 http.go:90: method: HEAD
2025/09/14 13:18:36 http.go:91: url: /
2025/09/14 13:18:36 http.go:92: host: www.so.com
2025/09/14 13:18:36 http.go:93: proxyHandler header:
2025/09/14 13:18:36 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:18:36 http.go:121: clientport: 61463
2025/09/14 13:18:36 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:18:36 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.85.175.242:19589;host=www.so.com;proto=http
2025/09/14 13:18:36 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:18:36 http.go:132: proxyHandler Accept : */*
2025/09/14 13:18:36 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.85.175.242:19589;host=www.so.com;proto=http
2025/09/14 13:18:36 http.go:137: forwardedByList: [{[::1]:8080} {127.85.175.242:19589}]
2025/09/14 13:18:36 http.go:155: targetUrl: http://www.so.com/
2025/09/14 13:18:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
2025/09/14 13:18:36 options.go:186: hostname www.so.com no ip found
2025/09/14 13:18:36 doh3.go:15: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh3.go:27: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh3.go:27: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:63935 223.6.6.6:443
2025/09/14 13:18:36 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:63934 223.6.6.6:443
2025/09/14 13:18:36 doh3.go:80: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 13:18:36 options.go:240: success connect to address=www.so.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.163.237.15
[GIN] 2025/09/14 - 13:18:36 | 302 |    117.4852ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:18:36 simple.go:57: remote addr: [::1]:61465
2025/09/14 13:18:36 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 13:18:36 simple.go:117: address:www.so.com:443
2025/09/14 13:18:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 13:18:36 options.go:98: hostname www.so.com no ip found
2025/09/14 13:18:36 options.go:186: hostname www.so.com no ip found
2025/09/14 13:18:36 doh3.go:15: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh3.go:27: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh3.go:27: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:59184 223.6.6.6:443
2025/09/14 13:18:36 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:59183 223.6.6.6:443
2025/09/14 13:18:36 doh3.go:80: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 13:18:36 options.go:240: success connect to address=www.so.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.163.237.15
2025/09/14 13:18:36 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 13:18:36 simple.go:57: remote addr: [::1]:61467
2025/09/14 13:18:36 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 13:18:36 simple.go:117: address:www.baidu.com:443
2025/09/14 13:18:36 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 13:18:36 options.go:98: hostname www.baidu.com no ip found
2025/09/14 13:18:36 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:18:36 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:18:36 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:18:36 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:18:36 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:18:36 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:18:36 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:18:36 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:18:36 doh.go:91: dns resolved www.baidu.com ips:[240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69,180.101.49.44,180.101.51.73]
2025/09/14 13:18:36 options.go:240: success connect to address=www.baidu.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.101.51.73
2025/09/14 13:18:36 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:19:36 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 13:19:36 main.go:562: dohalpn: [h2, h3]
2025/09/14 13:19:36 main.go:564: hostname: 0.0.0.0
2025/09/14 13:19:36 main.go:566: port: 8080
2025/09/14 13:19:36 main.go:568: server_cert: 
2025/09/14 13:19:36 main.go:570: server_key: 
2025/09/14 13:19:36 main.go:572: username: 
2025/09/14 13:19:36 main.go:574: password: 
2025/09/14 13:19:36 main.go:576: dohurl: [https://dns.alidns.com/dns-query, https://dns.alidns.com/dns-query]
2025/09/14 13:19:36 main.go:578: dohip: [223.5.5.5, 223.6.6.6]
2025/09/14 13:19:36 main.go:579: upstream-type: 
2025/09/14 13:19:36 main.go:580: upstream-address: 
2025/09/14 13:19:36 main.go:581: upstream-username: 
2025/09/14 13:19:36 main.go:582: upstream-password: 
2025/09/14 13:19:36 main.go:927: null
2025/09/14 13:19:36 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 13:19:36 http.go:372: Random IP: 127.134.72.120
2025/09/14 13:19:36 http.go:390: Random integer: 26822
2025/09/14 13:19:36 http.go:342: Proxy server started on port 127.134.72.120:26822
2025/09/14 13:19:38 simple.go:57: remote addr: [::1]:61751
2025/09/14 13:19:38 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 13:19:38 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:19:38 simple.go:117: address:www.baidu.com:80
2025/09/14 13:19:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.134.72.120:26822
2025/09/14 13:19:38 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.134.72.120:26822
2025/09/14 13:19:38 simple.go:248: clienthost: ::1
2025/09/14 13:19:38 simple.go:249: clientport: 61751
2025/09/14 13:19:38 simple.go:278: simple Handle header:
2025/09/14 13:19:38 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:38 simple.go:283: GET / HTTP/1.1
2025/09/14 13:19:38 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:38 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 13:19:38 http.go:90: method: GET
2025/09/14 13:19:38 http.go:91: url: /
2025/09/14 13:19:38 http.go:92: host: www.baidu.com
2025/09/14 13:19:38 http.go:93: proxyHandler header:
2025/09/14 13:19:38 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:38 http.go:121: clientport: 61752
2025/09/14 13:19:38 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 13:19:38 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.134.72.120:26822;host=www.baidu.com;proto=http
2025/09/14 13:19:38 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 13:19:38 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.134.72.120:26822;host=www.baidu.com;proto=http
2025/09/14 13:19:38 http.go:137: forwardedByList: [{[::1]:8080} {127.134.72.120:26822}]
2025/09/14 13:19:38 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:19:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:19:38 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:19:38 doh3.go:15: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 doh3.go:27: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 doh3.go:27: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:51175 223.6.6.6:443
2025/09/14 13:19:38 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:51176 223.6.6.6:443
2025/09/14 13:19:38 doh3.go:80: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5]
2025/09/14 13:19:38 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.101.49.44
[GIN] 2025/09/14 - 13:19:38 | 200 |    150.3364ms |       127.0.0.1 | GET      "/"
2025/09/14 13:19:38 simple.go:57: remote addr: [::1]:61756
2025/09/14 13:19:38 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 13:19:38 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:19:38 simple.go:117: address:www.baidu.com:80
2025/09/14 13:19:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.134.72.120:26822
2025/09/14 13:19:38 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.134.72.120:26822
2025/09/14 13:19:38 simple.go:248: clienthost: ::1
2025/09/14 13:19:38 simple.go:249: clientport: 61756
2025/09/14 13:19:38 simple.go:278: simple Handle header:
2025/09/14 13:19:38 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:38 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:19:38 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:38 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:19:38 http.go:90: method: HEAD
2025/09/14 13:19:38 http.go:91: url: /
2025/09/14 13:19:38 http.go:92: host: www.baidu.com
2025/09/14 13:19:38 http.go:93: proxyHandler header:
2025/09/14 13:19:38 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:38 http.go:121: clientport: 61757
2025/09/14 13:19:38 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:19:38 http.go:132: proxyHandler Accept : */*
2025/09/14 13:19:38 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:19:38 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.134.72.120:26822;host=www.baidu.com;proto=http
2025/09/14 13:19:38 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.134.72.120:26822;host=www.baidu.com;proto=http
2025/09/14 13:19:38 http.go:137: forwardedByList: [{[::1]:8080} {127.134.72.120:26822}]
2025/09/14 13:19:38 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:19:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:19:38 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:19:38 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:19:38 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:19:38 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:19:38 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:19:38 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:19:38 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:19:38 doh.go:91: dns resolved www.baidu.com ips:[240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69,180.101.49.44,180.101.51.73]
2025/09/14 13:19:38 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=240e:e9:6002:1ac:0:ff:b07e:36c5
[GIN] 2025/09/14 - 13:19:38 | 200 |    105.7158ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:19:38 simple.go:57: remote addr: [::1]:61770
2025/09/14 13:19:38 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 13:19:38 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 13:19:38 simple.go:117: address:www.so.com:80
2025/09/14 13:19:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.134.72.120:26822
2025/09/14 13:19:38 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.134.72.120:26822
2025/09/14 13:19:38 simple.go:248: clienthost: ::1
2025/09/14 13:19:38 simple.go:249: clientport: 61770
2025/09/14 13:19:38 simple.go:278: simple Handle header:
2025/09/14 13:19:38 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:19:38 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:19:38 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:19:38 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:19:38 http.go:90: method: HEAD
2025/09/14 13:19:38 http.go:91: url: /
2025/09/14 13:19:38 http.go:92: host: www.so.com
2025/09/14 13:19:38 http.go:93: proxyHandler header:
2025/09/14 13:19:38 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:38 http.go:121: clientport: 61771
2025/09/14 13:19:38 http.go:132: proxyHandler Accept : */*
2025/09/14 13:19:38 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:19:38 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.134.72.120:26822;host=www.so.com;proto=http
2025/09/14 13:19:38 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:19:38 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.134.72.120:26822;host=www.so.com;proto=http
2025/09/14 13:19:38 http.go:137: forwardedByList: [{[::1]:8080} {127.134.72.120:26822}]
2025/09/14 13:19:38 http.go:155: targetUrl: http://www.so.com/
2025/09/14 13:19:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
2025/09/14 13:19:38 options.go:186: hostname www.so.com no ip found
2025/09/14 13:19:38 doh3.go:15: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 doh3.go:27: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 doh3.go:27: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:38 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:52946 223.6.6.6:443
2025/09/14 13:19:38 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:52947 223.6.6.6:443
2025/09/14 13:19:38 doh3.go:80: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 13:19:38 options.go:240: success connect to address=www.so.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.163.237.15
[GIN] 2025/09/14 - 13:19:38 | 302 |    103.5362ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:19:38 simple.go:57: remote addr: [::1]:61773
2025/09/14 13:19:39 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 13:19:39 simple.go:117: address:www.so.com:443
2025/09/14 13:19:39 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 13:19:39 options.go:98: hostname www.so.com no ip found
2025/09/14 13:19:39 options.go:186: hostname www.so.com no ip found
2025/09/14 13:19:39 doh.go:16: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:39 doh.go:28: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:39 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:19:39 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:19:39 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:19:39 doh.go:28: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:39 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:19:39 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:19:39 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:19:39 doh.go:91: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 13:19:39 options.go:240: success connect to address=www.so.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.163.237.15
2025/09/14 13:19:39 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 13:19:39 simple.go:57: remote addr: [::1]:61786
2025/09/14 13:19:39 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 13:19:39 simple.go:117: address:www.baidu.com:443
2025/09/14 13:19:39 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 13:19:39 options.go:98: hostname www.baidu.com no ip found
2025/09/14 13:19:39 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:19:39 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:39 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:39 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:19:39 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:19:39 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:19:39 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:19:39 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:19:39 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:19:39 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:19:39 doh.go:91: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69]
2025/09/14 13:19:39 options.go:240: success connect to address=www.baidu.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.101.49.44
2025/09/14 13:19:39 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:19:41

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 30452

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 2024

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Etag: "575e1f6f-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:23 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11368953956720787410
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:28 GMT
Etag: "575e1f6f-115"
Last-Modified: Mon, 13 Jun 2016 02:50:23 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11368953956720787410


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 26784

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=lrv2akrbvi4sdm65luojsrqpr4; expires=Sun, 14-Sep-2025 05:29:28 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=D86BCA2101ECCD196D24E1B2FFDA0B49.1757827168949; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:28 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 05:19:28 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=lrv2akrbvi4sdm65luojsrqpr4; expires=Sun, 14-Sep-2025 05:29:28 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=D86BCA2101ECCD196D24E1B2FFDA0B49.1757827168949; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 31532

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:29 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11363261849440015699
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:29 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11363261849440015699


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 30452, 2024, 26784, 31532



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:19:41

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 30452

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 2024

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Etag: "575e1f6f-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:23 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11368953956720787410
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:28 GMT
Etag: "575e1f6f-115"
Last-Modified: Mon, 13 Jun 2016 02:50:23 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11368953956720787410


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 26784

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=lrv2akrbvi4sdm65luojsrqpr4; expires=Sun, 14-Sep-2025 05:29:28 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=D86BCA2101ECCD196D24E1B2FFDA0B49.1757827168949; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:28 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 05:19:28 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=lrv2akrbvi4sdm65luojsrqpr4; expires=Sun, 14-Sep-2025 05:29:28 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=D86BCA2101ECCD196D24E1B2FFDA0B49.1757827168949; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 31532

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:29 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11363261849440015699
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:29 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11363261849440015699


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 30452, 2024, 26784, 31532

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:19:42 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 13:19:42 main.go:562: dohalpn: []
2025/09/14 13:19:42 main.go:564: hostname: 0.0.0.0
2025/09/14 13:19:42 main.go:566: port: 8080
2025/09/14 13:19:42 main.go:568: server_cert: 
2025/09/14 13:19:42 main.go:570: server_key: 
2025/09/14 13:19:42 main.go:572: username: 
2025/09/14 13:19:42 main.go:574: password: 
2025/09/14 13:19:42 main.go:576: dohurl: []
2025/09/14 13:19:42 main.go:578: dohip: []
2025/09/14 13:19:42 main.go:579: upstream-type: 
2025/09/14 13:19:42 main.go:580: upstream-address: 
2025/09/14 13:19:42 main.go:581: upstream-username: 
2025/09/14 13:19:42 main.go:582: upstream-password: 
2025/09/14 13:19:42 main.go:927: null
2025/09/14 13:19:42 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 13:19:42 http.go:372: Random IP: 127.138.99.109
2025/09/14 13:19:42 http.go:390: Random integer: 24810
2025/09/14 13:19:42 http.go:342: Proxy server started on port 127.138.99.109:24810
2025/09/14 13:19:43 simple.go:57: remote addr: [::1]:61849
2025/09/14 13:19:43 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 13:19:43 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:19:43 simple.go:117: address:www.baidu.com:80
2025/09/14 13:19:43 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.138.99.109:24810
2025/09/14 13:19:43 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.138.99.109:24810
2025/09/14 13:19:43 simple.go:248: clienthost: ::1
2025/09/14 13:19:43 simple.go:249: clientport: 61849
2025/09/14 13:19:43 simple.go:278: simple Handle header:
2025/09/14 13:19:43 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:43 simple.go:283: GET / HTTP/1.1
2025/09/14 13:19:43 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:43 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 13:19:43 http.go:90: method: GET
2025/09/14 13:19:43 http.go:91: url: /
2025/09/14 13:19:43 http.go:92: host: www.baidu.com
2025/09/14 13:19:43 http.go:93: proxyHandler header:
2025/09/14 13:19:43 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:43 http.go:121: clientport: 61850
2025/09/14 13:19:43 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 13:19:43 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.138.99.109:24810;host=www.baidu.com;proto=http
2025/09/14 13:19:43 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 13:19:43 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.138.99.109:24810;host=www.baidu.com;proto=http
2025/09/14 13:19:43 http.go:137: forwardedByList: [{[::1]:8080} {127.138.99.109:24810}]
2025/09/14 13:19:43 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:19:43 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 13:19:43 | 200 |     63.1741ms |       127.0.0.1 | GET      "/"
2025/09/14 13:19:45 simple.go:57: remote addr: [::1]:61885
2025/09/14 13:19:45 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 13:19:45 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:19:45 simple.go:117: address:www.baidu.com:80
2025/09/14 13:19:45 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.138.99.109:24810
2025/09/14 13:19:45 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.138.99.109:24810
2025/09/14 13:19:45 simple.go:248: clienthost: ::1
2025/09/14 13:19:45 simple.go:249: clientport: 61885
2025/09/14 13:19:45 simple.go:278: simple Handle header:
2025/09/14 13:19:45 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:45 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:19:45 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:19:45 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:19:45 http.go:90: method: HEAD
2025/09/14 13:19:45 http.go:91: url: /
2025/09/14 13:19:45 http.go:92: host: www.baidu.com
2025/09/14 13:19:45 http.go:93: proxyHandler header:
2025/09/14 13:19:45 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:45 http.go:121: clientport: 61886
2025/09/14 13:19:45 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.138.99.109:24810;host=www.baidu.com;proto=http
2025/09/14 13:19:45 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:19:45 http.go:132: proxyHandler Accept : */*
2025/09/14 13:19:45 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:19:45 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.138.99.109:24810;host=www.baidu.com;proto=http
2025/09/14 13:19:45 http.go:137: forwardedByList: [{[::1]:8080} {127.138.99.109:24810}]
2025/09/14 13:19:45 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:19:45 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 13:19:45 | 200 |     72.0431ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:19:45 simple.go:57: remote addr: [::1]:61887
2025/09/14 13:19:45 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 13:19:45 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 13:19:45 simple.go:117: address:www.so.com:80
2025/09/14 13:19:45 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.138.99.109:24810
2025/09/14 13:19:45 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.138.99.109:24810
2025/09/14 13:19:45 simple.go:248: clienthost: ::1
2025/09/14 13:19:45 simple.go:249: clientport: 61887
2025/09/14 13:19:45 simple.go:278: simple Handle header:
2025/09/14 13:19:45 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:19:45 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:19:45 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:19:45 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:19:45 http.go:90: method: HEAD
2025/09/14 13:19:45 http.go:91: url: /
2025/09/14 13:19:45 http.go:92: host: www.so.com
2025/09/14 13:19:45 http.go:93: proxyHandler header:
2025/09/14 13:19:45 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:45 http.go:121: clientport: 61888
2025/09/14 13:19:45 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.138.99.109:24810;host=www.so.com;proto=http
2025/09/14 13:19:45 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:19:45 http.go:132: proxyHandler Accept : */*
2025/09/14 13:19:45 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:19:45 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.138.99.109:24810;host=www.so.com;proto=http
2025/09/14 13:19:45 http.go:137: forwardedByList: [{[::1]:8080} {127.138.99.109:24810}]
2025/09/14 13:19:45 http.go:155: targetUrl: http://www.so.com/
2025/09/14 13:19:45 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 13:19:45 | 302 |     84.6689ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:19:45 simple.go:57: remote addr: [::1]:61896
2025/09/14 13:19:45 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 13:19:45 simple.go:117: address:www.so.com:443
2025/09/14 13:19:45 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 13:19:45 options.go:98: hostname www.so.com no ip found
2025/09/14 13:19:45 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 13:19:45 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 13:19:46 simple.go:57: remote addr: [::1]:61902
2025/09/14 13:19:46 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 13:19:46 simple.go:117: address:www.baidu.com:443
2025/09/14 13:19:46 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 13:19:46 options.go:98: hostname www.baidu.com no ip found
2025/09/14 13:19:46 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 13:19:46 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Etag: "575e1f6f-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:23 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11368953956720787410
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:28 GMT
Etag: "575e1f6f-115"
Last-Modified: Mon, 13 Jun 2016 02:50:23 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11368953956720787410
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 05:19:28 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=lrv2akrbvi4sdm65luojsrqpr4; expires=Sun, 14-Sep-2025 05:29:28 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=D86BCA2101ECCD196D24E1B2FFDA0B49.1757827168949; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:28 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 05:19:28 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=lrv2akrbvi4sdm65luojsrqpr4; expires=Sun, 14-Sep-2025 05:29:28 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=D86BCA2101ECCD196D24E1B2FFDA0B49.1757827168949; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:29 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11363261849440015699
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:29 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11363261849440015699
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:19:51

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 33472

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 33356

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 20708, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:39 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11563180422438728794
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:39 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11563180422438728794


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 2804, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8614859276286411894
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8614859276286411894


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 33472, 33356, 20708, 2804



###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:19:51

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 33472

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 33356

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 20708, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:39 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11563180422438728794
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:39 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11563180422438728794


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 2804, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:19:40 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8614859276286411894
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:19:40 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8614859276286411894


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 33472, 33356, 20708, 2804

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹...
âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹...
âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...
âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:19:52 main.go:71: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :38800
2025/09/14 13:19:52 server.go:71: [WEBSOCKET-SERVER] Server started successfully, listening on :38800
2025/09/14 13:19:52 server.go:72: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 13:19:52 server.go:74: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 13:19:52 server.go:75: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 13:19:52 main.go:129: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 13:19:54 server.go:90: url /
2025/09/14 13:19:54 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[+7pUcuGc2F5UA0c2Ur4exA==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.53.67.76] X-Proxy-Target-Port:[25749]]
2025/09/14 13:19:54 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:61964 at 2025-09-14 13:19:54
2025/09/14 13:19:54 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:61964
2025/09/14 13:19:54 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.53.67.76', targetPort: 25749
2025/09/14 13:19:54 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:19:54 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:61964
2025/09/14 13:19:54 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.53.67.76:25749 from [::1]:61964
2025/09/14 13:19:54 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.53.67.76:25749 (timeout: 30s)
2025/09/14 13:19:54 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.53.67.76:25749
2025/09/14 13:19:54 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 13:19:54 server.go:90: url /
2025/09/14 13:19:54 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[UCLoFSdau63fmbp1hY09sw==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 13:19:54 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:61966 at 2025-09-14 13:19:54
2025/09/14 13:19:54 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:61966
2025/09/14 13:19:54 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 13:19:54 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:19:54 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:61966
2025/09/14 13:19:54 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:61966
2025/09/14 13:19:54 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 13:19:54 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 13:19:54 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 13:19:56 server.go:90: url /
2025/09/14 13:19:56 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[UG6bzOEr+zyg545IejM2ag==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.53.67.76] X-Proxy-Target-Port:[25749]]
2025/09/14 13:19:56 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:61982 at 2025-09-14 13:19:56
2025/09/14 13:19:56 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:61982
2025/09/14 13:19:56 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.53.67.76', targetPort: 25749
2025/09/14 13:19:56 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:19:56 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:61982
2025/09/14 13:19:56 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.53.67.76:25749 from [::1]:61982
2025/09/14 13:19:56 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.53.67.76:25749 (timeout: 30s)
2025/09/14 13:19:56 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.53.67.76:25749
2025/09/14 13:19:56 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 13:19:57 server.go:90: url /
2025/09/14 13:19:57 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[cO9iP8225Fq3N5ceAPo3jg==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 13:19:57 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:61985 at 2025-09-14 13:19:57
2025/09/14 13:19:57 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:61985
2025/09/14 13:19:57 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 13:19:57 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:19:57 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:61985
2025/09/14 13:19:57 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:61985
2025/09/14 13:19:57 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 13:19:57 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 13:19:57 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
```

### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:19:53 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 13:19:53 main.go:562: dohalpn: []
2025/09/14 13:19:53 main.go:564: hostname: 0.0.0.0
2025/09/14 13:19:53 main.go:566: port: 10810
2025/09/14 13:19:53 main.go:568: server_cert: 
2025/09/14 13:19:53 main.go:570: server_key: 
2025/09/14 13:19:53 main.go:572: username: 
2025/09/14 13:19:53 main.go:574: password: 
2025/09/14 13:19:53 main.go:576: dohurl: []
2025/09/14 13:19:53 main.go:578: dohip: []
2025/09/14 13:19:53 main.go:579: upstream-type: websocket
2025/09/14 13:19:53 main.go:580: upstream-address: ws://localhost:38800
2025/09/14 13:19:53 main.go:581: upstream-username: 
2025/09/14 13:19:53 main.go:582: upstream-password: 
2025/09/14 13:19:53 main.go:639: WebSocketä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 13:19:53 main.go:927: {
  "hostname": "",
  "port": 0,
  "server_cert": "",
  "server_key": "",
  "username": "",
  "password": "",
  "doh": null,
  "upstreams": {
    "websocket_upstream": {
      "type": "websocket",
      "http_proxy": "ws://localhost:38800",
      "https_proxy": "ws://localhost:38800",
      "bypass_list": null,
      "ws_proxy": "ws://localhost:38800",
      "ws_username": "",
      "ws_password": "",
      "http_username": "",
      "http_password": "",
      "socks5_proxy": "ws://localhost:38800",
      "socks5_username": "",
      "socks5_password": ""
    }
  },
  "rules": [
    {
      "filter": "websocket_filter",
      "upstream": "websocket_upstream"
    }
  ],
  "filters": {
    "websocket_filter": {
      "patterns": [
        "*"
      ]
    }
  }
}
2025/09/14 13:19:53 simple.go:31: Proxy server started on port [::]:10810
2025/09/14 13:19:53 http.go:372: Random IP: 127.53.67.76
2025/09/14 13:19:53 http.go:390: Random integer: 25749
2025/09/14 13:19:53 http.go:342: Proxy server started on port 127.53.67.76:25749
2025/09/14 13:19:54 simple.go:57: remote addr: [::1]:61963
2025/09/14 13:19:54 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 13:19:54 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:19:54 simple.go:117: address:www.baidu.com:80
2025/09/14 13:19:54 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.67.76:25749
2025/09/14 13:19:54 main.go:828: ProxySelector 127.53.67.76:25749
2025/09/14 13:19:54 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:19:54 simple.go:179: WebSocket Config Details:
2025/09/14 13:19:54 simple.go:180: host, portNum 127.53.67.76 25749
2025/09/14 13:19:54 simple.go:181:   Username: 
2025/09/14 13:19:54 simple.go:182:   Password: 
2025/09/14 13:19:54 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 13:19:54 simple.go:184:   Protocol: websocket
2025/09/14 13:19:54 simple.go:185:   Timeout: 30s
2025/09/14 13:19:54 client.go:98: url: ws://localhost:38800
2025/09/14 13:19:54 client.go:99: headers: map[X-Proxy-Target-Host:[127.53.67.76] X-Proxy-Target-Port:[25749]]
2025/09/14 13:19:54 client.go:110: url: http://localhost:38800
2025/09/14 13:19:54 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[6inceFRqzpAj9TBuvVlLCN+8Rmw=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 13:19:54 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.53.67.76:25749
2025/09/14 13:19:54 simple.go:248: clienthost: ::1
2025/09/14 13:19:54 simple.go:249: clientport: 61963
2025/09/14 13:19:54 simple.go:278: simple Handle header:
2025/09/14 13:19:54 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:19:54 simple.go:283: GET / HTTP/1.1
2025/09/14 13:19:54 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:19:54 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 13:19:54 http.go:90: method: GET
2025/09/14 13:19:54 http.go:91: url: /
2025/09/14 13:19:54 http.go:92: host: www.baidu.com
2025/09/14 13:19:54 http.go:93: proxyHandler header:
2025/09/14 13:19:54 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:54 http.go:121: clientport: 61965
2025/09/14 13:19:54 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.53.67.76:25749;host=www.baidu.com;proto=http
2025/09/14 13:19:54 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 13:19:54 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 13:19:54 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.53.67.76:25749;host=www.baidu.com;proto=http
2025/09/14 13:19:54 http.go:137: forwardedByList: [{[::1]:10810} {127.53.67.76:25749}]
2025/09/14 13:19:54 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:19:54 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:19:54 main.go:828: ProxySelector www.baidu.com
2025/09/14 13:19:54 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:19:54 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 13:19:54 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
2025/09/14 13:19:54 http.go:262: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 13:19:54 http.go:264: network,addr tcp www.baidu.com:80
2025/09/14 13:19:54 http.go:466: WebSocket Config Details:
2025/09/14 13:19:54 http.go:467: host, portNum www.baidu.com 80
2025/09/14 13:19:54 http.go:468:   Username: 
2025/09/14 13:19:54 http.go:469:   Password: 
2025/09/14 13:19:54 http.go:470:   ServerAddr: ws://localhost:38800
2025/09/14 13:19:54 http.go:471:   Protocol: websocket
2025/09/14 13:19:54 http.go:472:   Timeout: 30s
2025/09/14 13:19:54 http.go:476: host, portNum www.baidu.com 80
2025/09/14 13:19:54 client.go:98: url: ws://localhost:38800
2025/09/14 13:19:54 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 13:19:54 client.go:110: url: http://localhost:38800
2025/09/14 13:19:54 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[yiTNY57nAg3x0Ck0McVwrmvRXkY=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
[GIN] 2025/09/14 - 13:19:54 | 200 |       71.34ms |       127.0.0.1 | GET      "/"
2025/09/14 13:19:56 simple.go:57: remote addr: [::1]:61981
2025/09/14 13:19:56 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 13:19:56 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:19:56 simple.go:117: address:www.baidu.com:80
2025/09/14 13:19:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.53.67.76:25749
2025/09/14 13:19:56 main.go:828: ProxySelector 127.53.67.76:25749
2025/09/14 13:19:56 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:19:56 simple.go:179: WebSocket Config Details:
2025/09/14 13:19:56 simple.go:180: host, portNum 127.53.67.76 25749
2025/09/14 13:19:56 simple.go:181:   Username: 
2025/09/14 13:19:56 simple.go:182:   Password: 
2025/09/14 13:19:56 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 13:19:56 simple.go:184:   Protocol: websocket
2025/09/14 13:19:56 simple.go:185:   Timeout: 30s
2025/09/14 13:19:56 client.go:98: url: ws://localhost:38800
2025/09/14 13:19:56 client.go:99: headers: map[X-Proxy-Target-Host:[127.53.67.76] X-Proxy-Target-Port:[25749]]
2025/09/14 13:19:56 client.go:110: url: http://localhost:38800
2025/09/14 13:19:56 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[9LE9ZcyWAEyXWeZsdPNodVq/c9U=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 13:19:56 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.53.67.76:25749
2025/09/14 13:19:56 simple.go:248: clienthost: ::1
2025/09/14 13:19:56 simple.go:249: clientport: 61981
2025/09/14 13:19:56 simple.go:278: simple Handle header:
2025/09/14 13:19:56 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:19:56 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:19:56 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:19:56 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:19:56 http.go:90: method: HEAD
2025/09/14 13:19:56 http.go:91: url: /
2025/09/14 13:19:56 http.go:92: host: www.baidu.com
2025/09/14 13:19:56 http.go:93: proxyHandler header:
2025/09/14 13:19:56 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:19:56 http.go:121: clientport: 61983
2025/09/14 13:19:56 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.53.67.76:25749;host=www.baidu.com;proto=http
2025/09/14 13:19:56 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:19:56 http.go:132: proxyHandler Accept : */*
2025/09/14 13:19:56 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:19:56 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.53.67.76:25749;host=www.baidu.com;proto=http
2025/09/14 13:19:56 http.go:137: forwardedByList: [{[::1]:10810} {127.53.67.76:25749}]
2025/09/14 13:19:56 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:19:56 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:19:56 main.go:828: ProxySelector www.baidu.com
2025/09/14 13:19:56 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:19:56 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 13:19:56 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
[GIN] 2025/09/14 - 13:19:57 | 200 |     51.0747ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:19:57 simple.go:57: remote addr: [::1]:61984
2025/09/14 13:19:57 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 13:19:57 simple.go:117: address:www.baidu.com:443
2025/09/14 13:19:57 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 13:19:57 main.go:828: ProxySelector www.baidu.com:443
2025/09/14 13:19:57 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:19:57 simple.go:179: WebSocket Config Details:
2025/09/14 13:19:57 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 13:19:57 simple.go:181:   Username: 
2025/09/14 13:19:57 simple.go:182:   Password: 
2025/09/14 13:19:57 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 13:19:57 simple.go:184:   Protocol: websocket
2025/09/14 13:19:57 simple.go:185:   Timeout: 30s
2025/09/14 13:19:57 client.go:98: url: ws://localhost:38800
2025/09/14 13:19:57 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 13:19:57 client.go:110: url: http://localhost:38800
2025/09/14 13:19:57 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[i/nbBxEbZW2kIMNbml+EsuxsePM=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 13:19:57 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
2025/09/14 13:19:57 simple.go:204: WebSocket ForwardData error: read tcp [::1]:61964->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 13:19:57 http.go:493: WebSocket ForwardData error: read tcp [::1]:61966->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 13:19:57 simple.go:204: WebSocket ForwardData error: read tcp [::1]:61982->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 13:19:57 simple.go:204: WebSocket ForwardData error: read tcp [::1]:61985->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
```

âœ… ç«¯å£38800å·²æˆåŠŸé‡Šæ”¾
âœ… ç«¯å£10810å·²æˆåŠŸé‡Šæ”¾


###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ



###

# DoH HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•

æ‰§è¡Œå‘½ä»¤: `go build -o main.exe ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

å¯åŠ¨ä»£ç†æœåŠ¡å™¨ï¼ˆDoHæ¨¡å¼ï¼‰...
æ‰§è¡Œå‘½ä»¤: `./main.exe -dohurl https://dns.alidns.com/dns-query -dohip 223.5.5.5 -dohip 223.6.6.6 -dohalpn h2 -dohalpn h3`

âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

å¼€å§‹æµ‹è¯•ä»£ç†åŠŸèƒ½...

âœ… 8080ç«¯å£è¢«å ç”¨ï¼Œä»£ç†æœåŠ¡å™¨è¿è¡Œæ­£å¸¸
æµ‹è¯•1: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•1æˆåŠŸ

æµ‹è¯•2: é€šè¿‡ä»£ç†è®¿é—®HTTPç½‘ç«™ (so.comï¼Œè·Ÿéšé‡å®šå‘)
âœ… æµ‹è¯•2æˆåŠŸ

æµ‹è¯•3: é€šè¿‡ä»£ç†è®¿é—®HTTPSç½‘ç«™ (baidu.com)
âœ… æµ‹è¯•3æˆåŠŸ

### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:23:19 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 13:23:19 main.go:562: dohalpn: [h2, h3]
2025/09/14 13:23:19 main.go:564: hostname: 0.0.0.0
2025/09/14 13:23:19 main.go:566: port: 8080
2025/09/14 13:23:19 main.go:568: server_cert: 
2025/09/14 13:23:19 main.go:570: server_key: 
2025/09/14 13:23:19 main.go:572: username: 
2025/09/14 13:23:19 main.go:574: password: 
2025/09/14 13:23:19 main.go:576: dohurl: [https://dns.alidns.com/dns-query, https://dns.alidns.com/dns-query]
2025/09/14 13:23:19 main.go:578: dohip: [223.5.5.5, 223.6.6.6]
2025/09/14 13:23:19 main.go:579: upstream-type: 
2025/09/14 13:23:19 main.go:580: upstream-address: 
2025/09/14 13:23:19 main.go:581: upstream-username: 
2025/09/14 13:23:19 main.go:582: upstream-password: 
2025/09/14 13:23:19 main.go:927: null
2025/09/14 13:23:19 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 13:23:19 http.go:372: Random IP: 127.113.74.140
2025/09/14 13:23:19 http.go:390: Random integer: 39073
2025/09/14 13:23:19 http.go:342: Proxy server started on port 127.113.74.140:39073
2025/09/14 13:23:21 simple.go:57: remote addr: [::1]:64586
2025/09/14 13:23:21 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 13:23:21 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:23:21 simple.go:117: address:www.baidu.com:80
2025/09/14 13:23:21 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.113.74.140:39073
2025/09/14 13:23:21 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.113.74.140:39073
2025/09/14 13:23:21 simple.go:248: clienthost: ::1
2025/09/14 13:23:21 simple.go:249: clientport: 64586
2025/09/14 13:23:21 simple.go:278: simple Handle header:
2025/09/14 13:23:21 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:21 simple.go:283: GET / HTTP/1.1
2025/09/14 13:23:21 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:21 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 13:23:21 http.go:90: method: GET
2025/09/14 13:23:21 http.go:91: url: /
2025/09/14 13:23:21 http.go:92: host: www.baidu.com
2025/09/14 13:23:21 http.go:93: proxyHandler header:
2025/09/14 13:23:21 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:21 http.go:121: clientport: 64587
2025/09/14 13:23:21 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 13:23:21 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.113.74.140:39073;host=www.baidu.com;proto=http
2025/09/14 13:23:21 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 13:23:21 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.113.74.140:39073;host=www.baidu.com;proto=http
2025/09/14 13:23:21 http.go:137: forwardedByList: [{[::1]:8080} {127.113.74.140:39073}]
2025/09/14 13:23:21 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:23:21 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:23:21 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:23:21 doh3.go:15: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 doh3.go:27: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 doh3.go:27: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:51093 223.6.6.6:443
2025/09/14 13:23:21 h3.go:60: http3è¿žæŽ¥æˆåŠŸ dns.alidns.com 443 [::]:51094 223.6.6.6:443
2025/09/14 13:23:21 doh3.go:80: dns resolved www.baidu.com ips:[180.101.51.73,180.101.49.44,240e:e9:6002:1ac:0:ff:b07e:36c5,240e:e9:6002:1fd:0:ff:b0e1:fe69]
2025/09/14 13:23:21 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.6.6.6 by serverIP=180.101.51.73
[GIN] 2025/09/14 - 13:23:21 | 200 |    181.2407ms |       127.0.0.1 | GET      "/"
2025/09/14 13:23:21 simple.go:57: remote addr: [::1]:64591
2025/09/14 13:23:21 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 13:23:21 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:23:21 simple.go:117: address:www.baidu.com:80
2025/09/14 13:23:21 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.113.74.140:39073
2025/09/14 13:23:21 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.113.74.140:39073
2025/09/14 13:23:21 simple.go:248: clienthost: ::1
2025/09/14 13:23:21 simple.go:249: clientport: 64591
2025/09/14 13:23:21 simple.go:278: simple Handle header:
2025/09/14 13:23:21 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:21 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:23:21 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:21 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:23:21 http.go:90: method: HEAD
2025/09/14 13:23:21 http.go:91: url: /
2025/09/14 13:23:21 http.go:92: host: www.baidu.com
2025/09/14 13:23:21 http.go:93: proxyHandler header:
2025/09/14 13:23:21 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:21 http.go:121: clientport: 64592
2025/09/14 13:23:21 http.go:132: proxyHandler Accept : */*
2025/09/14 13:23:21 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:23:21 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.113.74.140:39073;host=www.baidu.com;proto=http
2025/09/14 13:23:21 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:23:21 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.113.74.140:39073;host=www.baidu.com;proto=http
2025/09/14 13:23:21 http.go:137: forwardedByList: [{[::1]:8080} {127.113.74.140:39073}]
2025/09/14 13:23:21 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:23:21 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:23:21 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:23:21 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:21 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:21 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:21 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:21 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:21 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:21 doh.go:91: dns resolved www.baidu.com ips:[240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5,180.101.51.73,180.101.49.44]
2025/09/14 13:23:21 options.go:240: success connect to address=www.baidu.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.101.51.73
[GIN] 2025/09/14 - 13:23:21 | 200 |    111.4589ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:23:21 simple.go:57: remote addr: [::1]:64596
2025/09/14 13:23:21 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 13:23:21 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 13:23:21 simple.go:117: address:www.so.com:80
2025/09/14 13:23:21 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.113.74.140:39073
2025/09/14 13:23:21 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.113.74.140:39073
2025/09/14 13:23:21 simple.go:248: clienthost: ::1
2025/09/14 13:23:21 simple.go:249: clientport: 64596
2025/09/14 13:23:21 simple.go:278: simple Handle header:
2025/09/14 13:23:21 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:23:21 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:23:21 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:23:21 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:23:21 http.go:90: method: HEAD
2025/09/14 13:23:21 http.go:91: url: /
2025/09/14 13:23:21 http.go:92: host: www.so.com
2025/09/14 13:23:21 http.go:93: proxyHandler header:
2025/09/14 13:23:21 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:21 http.go:121: clientport: 64597
2025/09/14 13:23:21 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.113.74.140:39073;host=www.so.com;proto=http
2025/09/14 13:23:21 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:23:21 http.go:132: proxyHandler Accept : */*
2025/09/14 13:23:21 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:23:21 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.113.74.140:39073;host=www.so.com;proto=http
2025/09/14 13:23:21 http.go:137: forwardedByList: [{[::1]:8080} {127.113.74.140:39073}]
2025/09/14 13:23:21 http.go:155: targetUrl: http://www.so.com/
2025/09/14 13:23:21 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
2025/09/14 13:23:21 options.go:186: hostname www.so.com no ip found
2025/09/14 13:23:21 doh.go:16: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 doh.go:28: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 doh.go:28: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:21 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:21 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:21 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:21 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:21 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:21 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:21 doh.go:91: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 13:23:22 options.go:240: success connect to address=www.so.com:80 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.163.237.15
[GIN] 2025/09/14 - 13:23:22 | 302 |    127.0291ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:23:22 simple.go:57: remote addr: [::1]:64601
2025/09/14 13:23:22 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 13:23:22 simple.go:117: address:www.so.com:443
2025/09/14 13:23:22 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 13:23:22 options.go:98: hostname www.so.com no ip found
2025/09/14 13:23:22 options.go:186: hostname www.so.com no ip found
2025/09/14 13:23:22 doh.go:16: domain: www.so.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:22 doh.go:28: domain: www.so.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:22 doh.go:28: domain: www.so.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:22 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:22 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:22 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:22 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:22 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:22 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:22 doh.go:91: dns resolved www.so.com ips:[180.163.237.15]
2025/09/14 13:23:22 options.go:240: success connect to address=www.so.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.163.237.15
2025/09/14 13:23:22 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 13:23:22 simple.go:57: remote addr: [::1]:64605
2025/09/14 13:23:22 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 13:23:22 simple.go:117: address:www.baidu.com:443
2025/09/14 13:23:22 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 13:23:22 options.go:98: hostname www.baidu.com no ip found
2025/09/14 13:23:22 options.go:186: hostname www.baidu.com no ip found
2025/09/14 13:23:22 doh.go:16: domain: www.baidu.com dnstype: A,AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:22 doh.go:28: domain: www.baidu.com dnstype: AAAA dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:22 doh.go:28: domain: www.baidu.com dnstype: A dohurl: https://dns.alidns.com/dns-query
2025/09/14 13:23:22 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:22 dns.go:239: å¼€å§‹å‘èµ·dohè¯·æ±‚ https://dns.alidns.com/dns-query
2025/09/14 13:23:22 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:22 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:22 dns.go:134: DialTLSContext dialing tcp to dns.alidns.com:443
2025/09/14 13:23:22 dns.go:164: DialTLSContext dialing tcp to 223.5.5.5:443
2025/09/14 13:23:22 doh.go:91: dns resolved www.baidu.com ips:[240e:e9:6002:1fd:0:ff:b0e1:fe69,240e:e9:6002:1ac:0:ff:b07e:36c5,180.101.49.44,180.101.51.73]
2025/09/14 13:23:22 options.go:240: success connect to address=www.baidu.com:443 by network=tcp by Dohurl=https://dns.alidns.com/dns-query by dohip=223.5.5.5 by serverIP=180.101.49.44
2025/09/14 13:23:22 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:23:24

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 29764

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 33236

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11857946248499194976
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11857946248499194976


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 6428

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=2k3ve7kqbf6cf3n5qc1qv2tk52; expires=Sun, 14-Sep-2025 05:33:11 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=CFE82C5919B3DD1EE8BB81C6D79CFC2F.1757827391841; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:11 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 05:23:11 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=2k3ve7kqbf6cf3n5qc1qv2tk52; expires=Sun, 14-Sep-2025 05:33:11 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=CFE82C5919B3DD1EE8BB81C6D79CFC2F.1757827391841; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 29448

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:12 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8956369090804054251
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:12 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8956369090804054251


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 29764, 33236, 6428, 29448



###

# HTTPä»£ç†æœåŠ¡å™¨æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:23:24

## 1. å¯åŠ¨ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go run -v ../cmd/main.go`

ç¼–è¯‘ä»£ç†æœåŠ¡å™¨...
âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

ðŸ“‹ ä»£ç†æœåŠ¡å™¨è¿›ç¨‹PID: 29764

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨...
âœ… ä»£ç†æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 2. æµ‹è¯•HTTPä»£ç†åŠŸèƒ½

### æµ‹è¯•1: åŸºæœ¬HTTPä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 33236

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11857946248499194976
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11857946248499194976


```

### æµ‹è¯•2: HTTPä»£ç†www.so.com

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.so.com -x http://localhost:8080 -L`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 6428

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=2k3ve7kqbf6cf3n5qc1qv2tk52; expires=Sun, 14-Sep-2025 05:33:11 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=CFE82C5919B3DD1EE8BB81C6D79CFC2F.1757827391841; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:11 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/

HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 05:23:11 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=2k3ve7kqbf6cf3n5qc1qv2tk52; expires=Sun, 14-Sep-2025 05:33:11 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=CFE82C5919B3DD1EE8BB81C6D79CFC2F.1757827391841; Max-Age=63072000; Domain=so.com; Path=/


```

### æµ‹è¯•3: HTTPSä»£ç†

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:8080`

ðŸ“‹ Curlæµ‹è¯•3è¿›ç¨‹PID: 29448

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:12 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8956369090804054251
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:12 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8956369090804054251


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 29764, 33236, 6428, 29448

## 3. å…³é—­ä»£ç†æœåŠ¡å™¨

âœ… æ‰€æœ‰curlæµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢ä»£ç†æœåŠ¡å™¨è¿›ç¨‹...
âœ… ä»£ç†æœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...

âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### ä»£ç†æœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:23:25 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 13:23:25 main.go:562: dohalpn: []
2025/09/14 13:23:25 main.go:564: hostname: 0.0.0.0
2025/09/14 13:23:25 main.go:566: port: 8080
2025/09/14 13:23:25 main.go:568: server_cert: 
2025/09/14 13:23:25 main.go:570: server_key: 
2025/09/14 13:23:25 main.go:572: username: 
2025/09/14 13:23:25 main.go:574: password: 
2025/09/14 13:23:25 main.go:576: dohurl: []
2025/09/14 13:23:25 main.go:578: dohip: []
2025/09/14 13:23:25 main.go:579: upstream-type: 
2025/09/14 13:23:25 main.go:580: upstream-address: 
2025/09/14 13:23:25 main.go:581: upstream-username: 
2025/09/14 13:23:25 main.go:582: upstream-password: 
2025/09/14 13:23:25 main.go:927: null
2025/09/14 13:23:25 simple.go:31: Proxy server started on port [::]:8080
2025/09/14 13:23:25 http.go:372: Random IP: 127.178.201.163
2025/09/14 13:23:25 http.go:390: Random integer: 20450
2025/09/14 13:23:25 http.go:342: Proxy server started on port 127.178.201.163:20450
2025/09/14 13:23:26 simple.go:57: remote addr: [::1]:64618
2025/09/14 13:23:26 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 13:23:26 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:23:26 simple.go:117: address:www.baidu.com:80
2025/09/14 13:23:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.178.201.163:20450
2025/09/14 13:23:26 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.178.201.163:20450
2025/09/14 13:23:26 simple.go:248: clienthost: ::1
2025/09/14 13:23:26 simple.go:249: clientport: 64618
2025/09/14 13:23:26 simple.go:278: simple Handle header:
2025/09/14 13:23:26 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:26 simple.go:283: GET / HTTP/1.1
2025/09/14 13:23:26 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:26 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 13:23:26 http.go:90: method: GET
2025/09/14 13:23:26 http.go:91: url: /
2025/09/14 13:23:26 http.go:92: host: www.baidu.com
2025/09/14 13:23:26 http.go:93: proxyHandler header:
2025/09/14 13:23:26 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:26 http.go:121: clientport: 64619
2025/09/14 13:23:26 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.178.201.163:20450;host=www.baidu.com;proto=http
2025/09/14 13:23:26 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 13:23:26 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 13:23:26 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.178.201.163:20450;host=www.baidu.com;proto=http
2025/09/14 13:23:26 http.go:137: forwardedByList: [{[::1]:8080} {127.178.201.163:20450}]
2025/09/14 13:23:26 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:23:26 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 13:23:26 | 200 |     76.1349ms |       127.0.0.1 | GET      "/"
2025/09/14 13:23:28 simple.go:57: remote addr: [::1]:64660
2025/09/14 13:23:28 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 13:23:28 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:23:28 simple.go:117: address:www.baidu.com:80
2025/09/14 13:23:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.178.201.163:20450
2025/09/14 13:23:28 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.178.201.163:20450
2025/09/14 13:23:28 simple.go:248: clienthost: ::1
2025/09/14 13:23:28 simple.go:249: clientport: 64660
2025/09/14 13:23:28 simple.go:278: simple Handle header:
2025/09/14 13:23:28 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:28 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:23:28 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http
2025/09/14 13:23:28 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:23:28 http.go:90: method: HEAD
2025/09/14 13:23:28 http.go:91: url: /
2025/09/14 13:23:28 http.go:92: host: www.baidu.com
2025/09/14 13:23:28 http.go:93: proxyHandler header:
2025/09/14 13:23:28 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:28 http.go:121: clientport: 64661
2025/09/14 13:23:28 http.go:132: proxyHandler Accept : */*
2025/09/14 13:23:28 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:23:28 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.178.201.163:20450;host=www.baidu.com;proto=http
2025/09/14 13:23:28 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:23:28 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.178.201.163:20450;host=www.baidu.com;proto=http
2025/09/14 13:23:28 http.go:137: forwardedByList: [{[::1]:8080} {127.178.201.163:20450}]
2025/09/14 13:23:28 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:23:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
[GIN] 2025/09/14 - 13:23:28 | 200 |     45.1797ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:23:28 simple.go:57: remote addr: [::1]:64662
2025/09/14 13:23:28 simple.go:79: HEAD http://www.so.com/ HTTP/1.1
2025/09/14 13:23:28 simple.go:305: Domain: www.so.com, Port: 80
2025/09/14 13:23:28 simple.go:117: address:www.so.com:80
2025/09/14 13:23:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.178.201.163:20450
2025/09/14 13:23:28 simple.go:234: è¿žæŽ¥æˆåŠŸï¼š127.178.201.163:20450
2025/09/14 13:23:28 simple.go:248: clienthost: ::1
2025/09/14 13:23:28 simple.go:249: clientport: 64662
2025/09/14 13:23:28 simple.go:278: simple Handle header:
2025/09/14 13:23:28 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:23:28 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:23:28 simple.go:288: Forwarded: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http
2025/09/14 13:23:28 simple.go:294: Host: www.so.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:23:28 http.go:90: method: HEAD
2025/09/14 13:23:28 http.go:91: url: /
2025/09/14 13:23:28 http.go:92: host: www.so.com
2025/09/14 13:23:28 http.go:93: proxyHandler header:
2025/09/14 13:23:28 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:28 http.go:121: clientport: 64663
2025/09/14 13:23:28 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:8080;host=www.so.com:80;proto=http,for=127.0.0.1;by=127.178.201.163:20450;host=www.so.com;proto=http
2025/09/14 13:23:28 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:23:28 http.go:132: proxyHandler Accept : */*
2025/09/14 13:23:28 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:23:28 http.go:135: forwardedHeader: for=::1;by=[::1]:8080;host=www.so.com:80;proto=http, for=127.0.0.1;by=127.178.201.163:20450;host=www.so.com;proto=http
2025/09/14 13:23:28 http.go:137: forwardedByList: [{[::1]:8080} {127.178.201.163:20450}]
2025/09/14 13:23:28 http.go:155: targetUrl: http://www.so.com/
2025/09/14 13:23:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com
[GIN] 2025/09/14 - 13:23:28 | 302 |     47.4582ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:23:28 simple.go:57: remote addr: [::1]:64671
2025/09/14 13:23:28 simple.go:79: CONNECT www.so.com:443 HTTP/1.1
2025/09/14 13:23:28 simple.go:117: address:www.so.com:443
2025/09/14 13:23:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.so.com:443
2025/09/14 13:23:28 options.go:98: hostname www.so.com no ip found
2025/09/14 13:23:28 options.go:123: success connect to www.so.com:443 by tcp
2025/09/14 13:23:28 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.so.com:443
2025/09/14 13:23:28 simple.go:57: remote addr: [::1]:64676
2025/09/14 13:23:28 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 13:23:28 simple.go:117: address:www.baidu.com:443
2025/09/14 13:23:28 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 13:23:28 options.go:98: hostname www.baidu.com no ip found
2025/09/14 13:23:28 options.go:123: success connect to www.baidu.com:443 by tcp
2025/09/14 13:23:28 simple.go:234: è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
```

### æ‰€æœ‰å­è¿›ç¨‹æ—¥å¿—è¾“å‡º

```
### Curlæµ‹è¯•1è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11857946248499194976
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:11 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11857946248499194976
### Curlæµ‹è¯•2è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD http://www.so.com/ HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 302 Found
< Connection: keep-alive
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Location: https://www.so.com/
< Server: openresty
< Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
* Ignoring the response-body
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
* Clear auth, redirects to port from 80 to 443
* Issue another request to this URL: 'https://www.so.com/'
* Hostname localhost was found in DNS cache
*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.so.com:443
> CONNECT www.so.com:443 HTTP/1.1
> Host: www.so.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [305 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [93 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [5077 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server did not agree on a protocol. Uses default.
* Server certificate:
*  subject: CN=*.so.com
*  start date: Aug 28 00:00:00 2025 GMT
*  expire date: Sep 28 23:59:59 2026 GMT
*  subjectAltName: host "www.so.com" matched cert's "*.so.com"
*  issuer: C=CN; O=WoTrus CA Limited; CN=WoTrus DV Server CA  [Run by the Issuer]
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha384WithRSAEncryption
*   Certificate level 2: Public key type ? (4096/128 Bits/secBits), signed using sha384WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.so.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Server: openresty
< Date: Sun, 14 Sep 2025 05:23:11 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: keep-alive
< Vary: Accept-Encoding
< Set-Cookie: _S=2k3ve7kqbf6cf3n5qc1qv2tk52; expires=Sun, 14-Sep-2025 05:33:11 GMT; Max-Age=600; path=/
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate
< Pragma: no-cache
< php-waf-rep: -
< Set-Cookie: QiHooGUID=CFE82C5919B3DD1EE8BB81C6D79CFC2F.1757827391841; Max-Age=63072000; Domain=so.com; Path=/
< 
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #1 to host localhost left intact
HTTP/1.1 302 Found
Connection: keep-alive
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:11 GMT
Location: https://www.so.com/
Server: openresty
Set-Cookie: QiHooGUID=; Max-Age=63072000; Domain=so.com; Path=/
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Server: openresty
Date: Sun, 14 Sep 2025 05:23:11 GMT
Content-Type: text/html; charset=UTF-8
Connection: keep-alive
Vary: Accept-Encoding
Set-Cookie: _S=2k3ve7kqbf6cf3n5qc1qv2tk52; expires=Sun, 14-Sep-2025 05:33:11 GMT; Max-Age=600; path=/
Expires: Thu, 19 Nov 1981 08:52:00 GMT
Cache-Control: no-store, no-cache, must-revalidate
Pragma: no-cache
php-waf-rep: -
Set-Cookie: QiHooGUID=CFE82C5919B3DD1EE8BB81C6D79CFC2F.1757827391841; Max-Age=63072000; Domain=so.com; Path=/
### Curlæµ‹è¯•3è¾“å‡º ###
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:8080 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:8080...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 8080
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:12 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_8956369090804054251
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:12 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_8956369090804054251
```

âœ… ç«¯å£8080å·²æˆåŠŸé‡Šæ”¾


###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:23:34

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 29276

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 20824

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 32308, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:23 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11312453395660935113
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:23 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11312453395660935113


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 29760, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:23 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11528341636127742104
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:23 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11528341636127742104


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 29276, 20824, 32308, 29760



###

# WebSocketå’Œhttpçº§è”ä»£ç†æµ‹è¯•è®°å½•

## æµ‹è¯•æ—¶é—´
2025-09-14 13:23:34

## 1. ç¼–è¯‘ä»£ç†æœåŠ¡å™¨

æ‰§è¡Œå‘½ä»¤: `go build -o socks5-websocket-proxy-golang.exe github.com/masx200/socks5-websocket-proxy-golang/cmd`

âœ… ä»£ç†æœåŠ¡å™¨ç¼–è¯‘æˆåŠŸ

## 2. å¯åŠ¨WebSocketæœåŠ¡å™¨ï¼ˆä¸Šæ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./socks5-websocket-proxy-golang.exe -mode server -protocol websocket -addr :38800`

ðŸ“‹ WebSocketæœåŠ¡å™¨è¿›ç¨‹PID: 29276

ç­‰å¾…WebSocketæœåŠ¡å™¨å¯åŠ¨...
âœ… WebSocketæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 3. å¯åŠ¨httpæœåŠ¡å™¨ï¼ˆä¸‹æ¸¸ï¼‰

æ‰§è¡Œå‘½ä»¤: `./main.exe  -port 10810 -upstream-type websocket -upstream-address ws://localhost:38800`

ðŸ“‹ httpæœåŠ¡å™¨è¿›ç¨‹PID: 20824

ç­‰å¾…httpæœåŠ¡å™¨å¯åŠ¨...
âœ… httpæœåŠ¡å™¨å¯åŠ¨æˆåŠŸ

## 4. æµ‹è¯•çº§è”ä»£ç†åŠŸèƒ½

### æµ‹è¯•1: HTTPä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I http://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•1è¿›ç¨‹PID: 32308, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD http://www.baidu.com/ HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> Proxy-Connection: Keep-Alive
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:23 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11312453395660935113
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:23 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11312453395660935113


```

### æµ‹è¯•2: HTTPSä»£ç†é€šè¿‡çº§è”

æ‰§è¡Œå‘½ä»¤: `curl -v -I https://www.baidu.com -x http://localhost:10810`

ðŸ“‹ Curlæµ‹è¯•2è¿›ç¨‹PID: 29760, é€€å‡ºçŠ¶æ€ç : 0

âœ… æµ‹è¯•æˆåŠŸ

è¾“å‡ºç»“æžœ:
```
Note: Using embedded CA bundle, for proxies (233263 bytes)
* Host localhost:10810 was resolved.
* IPv6: ::1
* IPv4: 127.0.0.1
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying [::1]:10810...
* CONNECT tunnel: HTTP/1.1 negotiated
* allocate connect buffer
* Establish HTTP proxy tunnel to www.baidu.com:443
> CONNECT www.baidu.com:443 HTTP/1.1
> Host: www.baidu.com:443
> User-Agent: curl/8.12.1
> Proxy-Connection: Keep-Alive
> 
< HTTP/1.1 200 Connection established
< 
* CONNECT phase completed
* CONNECT tunnel established, response 200
* ALPN: curl offers h2,http/1.1
* TLSv1.3 (OUT), TLS handshake, Client hello (1):
} [308 bytes data]
*  CAfile: D:\è¿…é›·ä¸‹è½½\curl-8.12.1_4-win64-mingw\bin\curl-ca-bundle.crt
*  CApath: none
* TLSv1.3 (IN), TLS handshake, Server hello (2):
{ [102 bytes data]
* TLSv1.2 (IN), TLS handshake, Certificate (11):
{ [4771 bytes data]
* TLSv1.2 (IN), TLS handshake, Server key exchange (12):
{ [333 bytes data]
* TLSv1.2 (IN), TLS handshake, Server finished (14):
{ [4 bytes data]
* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):
} [70 bytes data]
* TLSv1.2 (OUT), TLS change cipher, Change cipher spec (1):
} [1 bytes data]
* TLSv1.2 (OUT), TLS handshake, Finished (20):
} [16 bytes data]
* TLSv1.2 (IN), TLS change cipher, Change cipher spec (1):
{ [1 bytes data]
* TLSv1.2 (IN), TLS handshake, Finished (20):
{ [16 bytes data]
* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256 / [blank] / UNDEF
* ALPN: server accepted http/1.1
* Server certificate:
*  subject: C=CN; ST=beijing; L=beijing; O=Beijing Baidu Netcom Science Technology Co., Ltd; CN=baidu.com
*  start date: Jul  9 07:01:02 2025 GMT
*  expire date: Aug 10 07:01:01 2026 GMT
*  subjectAltName: host "www.baidu.com" matched cert's "*.baidu.com"
*  issuer: C=BE; O=GlobalSign nv-sa; CN=GlobalSign RSA OV SSL CA 2018
*  SSL certificate verify ok.
*   Certificate level 0: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 1: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
*   Certificate level 2: Public key type ? (2048/112 Bits/secBits), signed using sha256WithRSAEncryption
* Connected to localhost (::1) port 10810
* using HTTP/1.x
> HEAD / HTTP/1.1
> Host: www.baidu.com
> User-Agent: curl/8.12.1
> Accept: */*
> 
* Request completely sent off
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
< Connection: keep-alive
< Content-Length: 277
< Content-Type: text/html
< Date: Sun, 14 Sep 2025 05:23:23 GMT
< Etag: "575e1f60-115"
< Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
< Pragma: no-cache
< Server: bfe/1.0.8.18
< Tr_id: bfe_11528341636127742104
< 
  0   277    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* Connection #0 to host localhost left intact
HTTP/1.1 200 Connection established

HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: private, no-cache, no-store, proxy-revalidate, no-transform
Connection: keep-alive
Content-Length: 277
Content-Type: text/html
Date: Sun, 14 Sep 2025 05:23:23 GMT
Etag: "575e1f60-115"
Last-Modified: Mon, 13 Jun 2016 02:50:08 GMT
Pragma: no-cache
Server: bfe/1.0.8.18
Tr_id: bfe_11528341636127742104


```

### ðŸ“‹ æ‰€æœ‰è¿›ç¨‹PIDè®°å½•

æ‰€æœ‰è¿›ç¨‹PID: 29276, 20824, 32308, 29760

## 5. å…³é—­æœåŠ¡å™¨

âœ… æ‰€æœ‰æµ‹è¯•æˆåŠŸï¼Œæ­£åœ¨å…³é—­æœåŠ¡å™¨è¿›ç¨‹...

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢WebSocketæœåŠ¡å™¨è¿›ç¨‹...
âœ… WebSocketæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ›‘ æ­£åœ¨ç»ˆæ­¢httpæœåŠ¡å™¨è¿›ç¨‹...
âœ… httpæœåŠ¡å™¨è¿›ç¨‹å·²ç»ˆæ­¢

ðŸ§¹ æ­£åœ¨æ¸…ç†æ‰€æœ‰å­è¿›ç¨‹...
âœ… æ‰€æœ‰å­è¿›ç¨‹å·²æ¸…ç†å®Œæˆ

ðŸ§¹ å·²æ¸…ç†ç¼–è¯‘çš„å¯æ‰§è¡Œæ–‡ä»¶
### WebSocketæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:23:36 main.go:71: å¯åŠ¨websocketæœåŠ¡ç«¯ï¼Œç›‘å¬åœ°å€: :38800
2025/09/14 13:23:36 server.go:71: [WEBSOCKET-SERVER] Server started successfully, listening on :38800
2025/09/14 13:23:36 server.go:72: [WEBSOCKET-SERVER] Authentication enabled: false (0 users configured)
2025/09/14 13:23:36 server.go:74: [WEBSOCKET-SERVER] Upstream selector enabled: false
2025/09/14 13:23:36 server.go:75: [WEBSOCKET-SERVER] Read timeout: 30s, Write timeout: 30s
2025/09/14 13:23:36 main.go:129: websocketæœåŠ¡ç«¯å·²å¯åŠ¨ï¼ŒæŒ‰Ctrl+Cåœæ­¢
2025/09/14 13:23:38 server.go:90: url /
2025/09/14 13:23:38 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[gVECIN4lxGuu+TEWouVSHw==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.192.215.10] X-Proxy-Target-Port:[62032]]
2025/09/14 13:23:38 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:64776 at 2025-09-14 13:23:38
2025/09/14 13:23:38 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:64776
2025/09/14 13:23:38 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.192.215.10', targetPort: 62032
2025/09/14 13:23:38 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:23:38 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:64776
2025/09/14 13:23:38 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.192.215.10:62032 from [::1]:64776
2025/09/14 13:23:38 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.192.215.10:62032 (timeout: 30s)
2025/09/14 13:23:38 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.192.215.10:62032
2025/09/14 13:23:38 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 13:23:38 server.go:90: url /
2025/09/14 13:23:38 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[rXe3Aso9Q4XGltHypYr8kw==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 13:23:38 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:64778 at 2025-09-14 13:23:38
2025/09/14 13:23:38 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:64778
2025/09/14 13:23:38 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 80
2025/09/14 13:23:38 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:23:38 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:64778
2025/09/14 13:23:38 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:80 from [::1]:64778
2025/09/14 13:23:38 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:80 (timeout: 30s)
2025/09/14 13:23:38 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:80
2025/09/14 13:23:38 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 13:23:40 server.go:90: url /
2025/09/14 13:23:40 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[ClplPlRB01YVQlV3bV2xdA==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[127.192.215.10] X-Proxy-Target-Port:[62032]]
2025/09/14 13:23:40 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:64838 at 2025-09-14 13:23:40
2025/09/14 13:23:40 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:64838
2025/09/14 13:23:40 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: '127.192.215.10', targetPort: 62032
2025/09/14 13:23:40 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:23:40 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:64838
2025/09/14 13:23:40 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target 127.192.215.10:62032 from [::1]:64838
2025/09/14 13:23:40 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target 127.192.215.10:62032 (timeout: 30s)
2025/09/14 13:23:40 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target 127.192.215.10:62032
2025/09/14 13:23:40 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
2025/09/14 13:23:40 server.go:90: url /
2025/09/14 13:23:40 server.go:92: headers map[Connection:[Upgrade] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Sec-Websocket-Key:[DvPU5/jkLgzmgcCcsr/1Lw==] Sec-Websocket-Version:[13] Upgrade:[websocket] User-Agent:[Go-http-client/1.1] X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 13:23:40 server.go:95: [WEBSOCKET-CONN] New connection attempt from [::1]:64848 at 2025-09-14 13:23:40
2025/09/14 13:23:40 server.go:101: [WEBSOCKET-CONN] No authentication required for client [::1]:64848
2025/09/14 13:23:40 server.go:306: [WEBSOCKET-AUTH] Parsed auth info - username: '', password: '', targetHost: 'www.baidu.com', targetPort: 443
2025/09/14 13:23:40 server.go:173: [WEBSOCKET-AUTH] No authentication configured, allowing access for user ''
2025/09/14 13:23:40 server.go:119: [WEBSOCKET-AUTH] Authentication successful for user '' from [::1]:64848
2025/09/14 13:23:40 server.go:129: [WEBSOCKET-CONN] WebSocket connection established successfully for target www.baidu.com:443 from [::1]:64848
2025/09/14 13:23:40 server.go:227: [WEBSOCKET-UPSTREAM] Using direct connection for target www.baidu.com:443 (timeout: 30s)
2025/09/14 13:23:40 server.go:232: [WEBSOCKET-UPSTREAM] Direct connection established for target www.baidu.com:443
2025/09/14 13:23:40 server.go:316: [WEBSOCKET-FORWARD] Starting data forwarding between connections
```

### httpæœåŠ¡å™¨æ—¥å¿—è¾“å‡º

```
2025/09/14 13:23:37 main.go:518: ä»£ç†æœåŠ¡å™¨å¯åŠ¨ä¸­...
2025/09/14 13:23:37 main.go:562: dohalpn: []
2025/09/14 13:23:37 main.go:564: hostname: 0.0.0.0
2025/09/14 13:23:37 main.go:566: port: 10810
2025/09/14 13:23:37 main.go:568: server_cert: 
2025/09/14 13:23:37 main.go:570: server_key: 
2025/09/14 13:23:37 main.go:572: username: 
2025/09/14 13:23:37 main.go:574: password: 
2025/09/14 13:23:37 main.go:576: dohurl: []
2025/09/14 13:23:37 main.go:578: dohip: []
2025/09/14 13:23:37 main.go:579: upstream-type: websocket
2025/09/14 13:23:37 main.go:580: upstream-address: ws://localhost:38800
2025/09/14 13:23:37 main.go:581: upstream-username: 
2025/09/14 13:23:37 main.go:582: upstream-password: 
2025/09/14 13:23:37 main.go:639: WebSocketä»£ç†é…ç½®å·²æ·»åŠ 
2025/09/14 13:23:37 main.go:927: {
  "hostname": "",
  "port": 0,
  "server_cert": "",
  "server_key": "",
  "username": "",
  "password": "",
  "doh": null,
  "upstreams": {
    "websocket_upstream": {
      "type": "websocket",
      "http_proxy": "ws://localhost:38800",
      "https_proxy": "ws://localhost:38800",
      "bypass_list": null,
      "ws_proxy": "ws://localhost:38800",
      "ws_username": "",
      "ws_password": "",
      "http_username": "",
      "http_password": "",
      "socks5_proxy": "ws://localhost:38800",
      "socks5_username": "",
      "socks5_password": ""
    }
  },
  "rules": [
    {
      "filter": "websocket_filter",
      "upstream": "websocket_upstream"
    }
  ],
  "filters": {
    "websocket_filter": {
      "patterns": [
        "*"
      ]
    }
  }
}
2025/09/14 13:23:37 simple.go:31: Proxy server started on port [::]:10810
2025/09/14 13:23:37 http.go:372: Random IP: 127.192.215.10
2025/09/14 13:23:37 http.go:390: Random integer: 62032
2025/09/14 13:23:37 http.go:342: Proxy server started on port 127.192.215.10:62032
2025/09/14 13:23:38 simple.go:57: remote addr: [::1]:64775
2025/09/14 13:23:38 simple.go:79: GET http://www.baidu.com/ HTTP/1.1
2025/09/14 13:23:38 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:23:38 simple.go:117: address:www.baidu.com:80
2025/09/14 13:23:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.192.215.10:62032
2025/09/14 13:23:38 main.go:828: ProxySelector 127.192.215.10:62032
2025/09/14 13:23:38 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:23:38 simple.go:179: WebSocket Config Details:
2025/09/14 13:23:38 simple.go:180: host, portNum 127.192.215.10 62032
2025/09/14 13:23:38 simple.go:181:   Username: 
2025/09/14 13:23:38 simple.go:182:   Password: 
2025/09/14 13:23:38 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 13:23:38 simple.go:184:   Protocol: websocket
2025/09/14 13:23:38 simple.go:185:   Timeout: 30s
2025/09/14 13:23:38 client.go:98: url: ws://localhost:38800
2025/09/14 13:23:38 client.go:99: headers: map[X-Proxy-Target-Host:[127.192.215.10] X-Proxy-Target-Port:[62032]]
2025/09/14 13:23:38 client.go:110: url: http://localhost:38800
2025/09/14 13:23:38 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[i/5j7yeF2uYA9DZX83Czk7/mDYE=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 13:23:38 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.192.215.10:62032
2025/09/14 13:23:38 simple.go:248: clienthost: ::1
2025/09/14 13:23:38 simple.go:249: clientport: 64775
2025/09/14 13:23:38 simple.go:278: simple Handle header:
2025/09/14 13:23:38 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:23:38 simple.go:283: GET / HTTP/1.1
2025/09/14 13:23:38 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:23:38 simple.go:294: Host: www.baidu.com
User-Agent: Go-http-client/1.1
Accept-Encoding: gzip
2025/09/14 13:23:38 http.go:90: method: GET
2025/09/14 13:23:38 http.go:91: url: /
2025/09/14 13:23:38 http.go:92: host: www.baidu.com
2025/09/14 13:23:38 http.go:93: proxyHandler header:
2025/09/14 13:23:38 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:38 http.go:121: clientport: 64777
2025/09/14 13:23:38 http.go:132: proxyHandler User-Agent : Go-http-client/1.1
2025/09/14 13:23:38 http.go:132: proxyHandler Accept-Encoding : gzip
2025/09/14 13:23:38 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.192.215.10:62032;host=www.baidu.com;proto=http
2025/09/14 13:23:38 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.192.215.10:62032;host=www.baidu.com;proto=http
2025/09/14 13:23:38 http.go:137: forwardedByList: [{[::1]:10810} {127.192.215.10:62032}]
2025/09/14 13:23:38 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:23:38 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:23:38 main.go:828: ProxySelector www.baidu.com
2025/09/14 13:23:38 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:23:38 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 13:23:38 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
2025/09/14 13:23:38 http.go:262: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 13:23:38 http.go:264: network,addr tcp www.baidu.com:80
2025/09/14 13:23:38 http.go:466: WebSocket Config Details:
2025/09/14 13:23:38 http.go:467: host, portNum www.baidu.com 80
2025/09/14 13:23:38 http.go:468:   Username: 
2025/09/14 13:23:38 http.go:469:   Password: 
2025/09/14 13:23:38 http.go:470:   ServerAddr: ws://localhost:38800
2025/09/14 13:23:38 http.go:471:   Protocol: websocket
2025/09/14 13:23:38 http.go:472:   Timeout: 30s
2025/09/14 13:23:38 http.go:476: host, portNum www.baidu.com 80
2025/09/14 13:23:38 client.go:98: url: ws://localhost:38800
2025/09/14 13:23:38 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[80]]
2025/09/14 13:23:38 client.go:110: url: http://localhost:38800
2025/09/14 13:23:38 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[tPv1FzPi1cNL/HND38ECXZqHvIc=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
[GIN] 2025/09/14 - 13:23:38 | 200 |     62.1928ms |       127.0.0.1 | GET      "/"
2025/09/14 13:23:40 simple.go:57: remote addr: [::1]:64837
2025/09/14 13:23:40 simple.go:79: HEAD http://www.baidu.com/ HTTP/1.1
2025/09/14 13:23:40 simple.go:305: Domain: www.baidu.com, Port: 80
2025/09/14 13:23:40 simple.go:117: address:www.baidu.com:80
2025/09/14 13:23:40 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy 127.192.215.10:62032
2025/09/14 13:23:40 main.go:828: ProxySelector 127.192.215.10:62032
2025/09/14 13:23:40 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:23:40 simple.go:179: WebSocket Config Details:
2025/09/14 13:23:40 simple.go:180: host, portNum 127.192.215.10 62032
2025/09/14 13:23:40 simple.go:181:   Username: 
2025/09/14 13:23:40 simple.go:182:   Password: 
2025/09/14 13:23:40 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 13:23:40 simple.go:184:   Protocol: websocket
2025/09/14 13:23:40 simple.go:185:   Timeout: 30s
2025/09/14 13:23:40 client.go:98: url: ws://localhost:38800
2025/09/14 13:23:40 client.go:99: headers: map[X-Proxy-Target-Host:[127.192.215.10] X-Proxy-Target-Port:[62032]]
2025/09/14 13:23:40 client.go:110: url: http://localhost:38800
2025/09/14 13:23:40 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[+dO8iVdgot7xLa/GyOKwc8pMofc=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 13:23:40 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼š127.192.215.10:62032
2025/09/14 13:23:40 simple.go:248: clienthost: ::1
2025/09/14 13:23:40 simple.go:249: clientport: 64837
2025/09/14 13:23:40 simple.go:278: simple Handle header:
2025/09/14 13:23:40 simple.go:281: simple Handle Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:23:40 simple.go:283: HEAD / HTTP/1.1
2025/09/14 13:23:40 simple.go:288: Forwarded: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http
2025/09/14 13:23:40 simple.go:294: Host: www.baidu.com
User-Agent: curl/8.12.1
Accept: */*
Proxy-Connection: Keep-Alive
2025/09/14 13:23:40 http.go:90: method: HEAD
2025/09/14 13:23:40 http.go:91: url: /
2025/09/14 13:23:40 http.go:92: host: www.baidu.com
2025/09/14 13:23:40 http.go:93: proxyHandler header:
2025/09/14 13:23:40 http.go:120: clienthost: 127.0.0.1
2025/09/14 13:23:40 http.go:121: clientport: 64839
2025/09/14 13:23:40 http.go:132: proxyHandler Accept : */*
2025/09/14 13:23:40 http.go:132: proxyHandler Proxy-Connection : Keep-Alive
2025/09/14 13:23:40 http.go:132: proxyHandler Forwarded : for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http,for=127.0.0.1;by=127.192.215.10:62032;host=www.baidu.com;proto=http
2025/09/14 13:23:40 http.go:132: proxyHandler User-Agent : curl/8.12.1
2025/09/14 13:23:40 http.go:135: forwardedHeader: for=::1;by=[::1]:10810;host=www.baidu.com:80;proto=http, for=127.0.0.1;by=127.192.215.10:62032;host=www.baidu.com;proto=http
2025/09/14 13:23:40 http.go:137: forwardedByList: [{[::1]:10810} {127.192.215.10:62032}]
2025/09/14 13:23:40 http.go:155: targetUrl: http://www.baidu.com/
2025/09/14 13:23:40 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com
2025/09/14 13:23:40 main.go:828: ProxySelector www.baidu.com
2025/09/14 13:23:40 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:23:40 http.go:250: ä½¿ç”¨ä»£ç†ï¼šws://localhost:38800
2025/09/14 13:23:40 http.go:259: å·²ç»ä¿®æ”¹äº†ä»£ç†ä¸ºwebsocket ws://localhost:38800
[GIN] 2025/09/14 - 13:23:40 | 200 |     33.2788ms |       127.0.0.1 | HEAD     "/"
2025/09/14 13:23:40 simple.go:57: remote addr: [::1]:64846
2025/09/14 13:23:40 simple.go:79: CONNECT www.baidu.com:443 HTTP/1.1
2025/09/14 13:23:40 simple.go:117: address:www.baidu.com:443
2025/09/14 13:23:40 CheckShouldUseProxy.go:10: å¼€å§‹æ£€æŸ¥CheckShouldUseProxy www.baidu.com:443
2025/09/14 13:23:40 main.go:828: ProxySelector www.baidu.com:443
2025/09/14 13:23:40 main.go:834: é€‰æ‹©çš„ä»£ç† URL: ws://localhost:38800
2025/09/14 13:23:40 simple.go:179: WebSocket Config Details:
2025/09/14 13:23:40 simple.go:180: host, portNum www.baidu.com 443
2025/09/14 13:23:40 simple.go:181:   Username: 
2025/09/14 13:23:40 simple.go:182:   Password: 
2025/09/14 13:23:40 simple.go:183:   ServerAddr: ws://localhost:38800
2025/09/14 13:23:40 simple.go:184:   Protocol: websocket
2025/09/14 13:23:40 simple.go:185:   Timeout: 30s
2025/09/14 13:23:40 client.go:98: url: ws://localhost:38800
2025/09/14 13:23:40 client.go:99: headers: map[X-Proxy-Target-Host:[www.baidu.com] X-Proxy-Target-Port:[443]]
2025/09/14 13:23:40 client.go:110: url: http://localhost:38800
2025/09/14 13:23:40 client.go:111: headers: map[Connection:[Upgrade] Sec-Websocket-Accept:[0VfcbA21YM0Khy30BhjW7TJh8/8=] Sec-Websocket-Extensions:[permessage-deflate; server_no_context_takeover; client_no_context_takeover] Upgrade:[websocket]]
2025/09/14 13:23:40 simple.go:209: WebSocketä»£ç†è¿žæŽ¥æˆåŠŸï¼šwww.baidu.com:443
2025/09/14 13:23:40 simple.go:204: WebSocket ForwardData error: read tcp [::1]:64776->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 13:23:40 http.go:493: WebSocket ForwardData error: read tcp [::1]:64778->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 13:23:40 simple.go:204: WebSocket ForwardData error: read tcp [::1]:64838->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
2025/09/14 13:23:40 simple.go:204: WebSocket ForwardData error: read tcp [::1]:64848->[::1]:38800: wsarecv: An existing connection was forcibly closed by the remote host.
```

âœ… ç«¯å£38800å·²æˆåŠŸé‡Šæ”¾
âœ… ç«¯å£10810å·²æˆåŠŸé‡Šæ”¾
